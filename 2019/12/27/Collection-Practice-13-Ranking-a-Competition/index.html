<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[Collection] Practice 13: Ranking a Competition - Hello, I am Minh</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hello, I am Minh"><meta name="msapplication-TileImage" content="/img/my_favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hello, I am Minh"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Đây là 1 project tôi viết 1 vài tháng trước. Ứng dụng quản lý cuộc thi và tôi cần viết code để làm sao để tính rank các team sau khi cuộc thi kết thúc."><meta property="og:type" content="blog"><meta property="og:title" content="[Collection] Practice 13: Ranking a Competition"><meta property="og:url" content="http://yoursite.com/2019/12/27/Collection-Practice-13-Ranking-a-Competition/"><meta property="og:site_name" content="Hello, I am Minh"><meta property="og:description" content="Đây là 1 project tôi viết 1 vài tháng trước. Ứng dụng quản lý cuộc thi và tôi cần viết code để làm sao để tính rank các team sau khi cuộc thi kết thúc."><meta property="og:locale" content="en_US"><meta property="og:image" content="http://yoursite.com/img/og_image.png"><meta property="article:published_time" content="2019-12-27T16:44:32.000Z"><meta property="article:modified_time" content="2024-08-08T04:06:27.730Z"><meta property="article:author" content="Ming"><meta property="article:tag" content="collection"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2019/12/27/Collection-Practice-13-Ranking-a-Competition/"},"headline":"[Collection] Practice 13: Ranking a Competition","image":["http://yoursite.com/img/og_image.png"],"datePublished":"2019-12-27T16:44:32.000Z","dateModified":"2024-08-08T04:06:27.730Z","author":{"@type":"Person","name":"Ming"},"description":"Đây là 1 project tôi viết 1 vài tháng trước. Ứng dụng quản lý cuộc thi và tôi cần viết code để làm sao để tính rank các team sau khi cuộc thi kết thúc."}</script><link rel="canonical" href="http://yoursite.com/2019/12/27/Collection-Practice-13-Ranking-a-Competition/"><link rel="icon" href="/img/my_favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-112002191-2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-112002191-2');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://octodex.github.com/images/privateinvestocat.jpg" alt="Hello, I am Minh" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-12-27T16:44:32.000Z" title="12/27/2019, 11:44:32 PM">2019-12-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-08T04:06:27.730Z" title="8/8/2024, 11:06:27 AM">2024-08-08</time></span><span class="level-item"><a class="link-muted" href="/categories/Clean-code/">Clean code</a><span> / </span><a class="link-muted" href="/categories/Clean-code/Refactoring-to-Collections/">Refactoring to Collections</a></span><span class="level-item">24 minutes read (About 3649 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">[Collection] Practice 13: Ranking a Competition</h1><div class="content"><p>Đây là 1 project tôi viết 1 vài tháng trước. Ứng dụng quản lý cuộc thi và tôi cần viết code để làm sao để tính rank các team sau khi cuộc thi kết thúc.<br><span id="more"></span><br>Tôi bắt đầu nhận với collection là điểm các đội như sau<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$scores</span> = collect([</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">76</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">62</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">86</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;D&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">91</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;E&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;F&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;G&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;H&#x27;</span>],</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><br>Nó có vẻ đơn giản bằng cách sử dụng method <code>sortByDesc</code>, cái mà sẽ nhận vào tên trường và sắp xếp nó như 1 tham số<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rankedScores</span> = <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>);</span><br><span class="line"><span class="comment">// =&gt; [</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 91, &#x27;team&#x27; =&gt; &#x27;E&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 86, &#x27;team&#x27; =&gt; &#x27;D&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;C&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;H&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 76, &#x27;team&#x27; =&gt; &#x27;A&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;F&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;G&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;score&#x27; =&gt; 62, &#x27;team&#x27; =&gt; &#x27;B&#x27;],</span></span><br><span class="line"><span class="comment">// ];</span></span><br></pre></td></tr></table></figure><br>Bây giờ chúng đã được sắp xếp, chúng ta chỉ có thể sử dụng chỉ số của mảng cộng thêm 1 như là rank, đúng ko? Không hẳn, bởi vì <code>sortByDesc</code> thực sự vẫn giữ lại <code>key</code> cũ, do vậy mặc dù <code>$rankedScores</code> đã được sắp xếp đúng thứ tự nhưng chúng thực sự , chúng vẫn có key rõ ràng không phải là ranking mong đợi<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rankedScores</span> = <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>);</span><br><span class="line"><span class="comment">// =&gt; [</span></span><br><span class="line"><span class="comment">// 4 =&gt; [&#x27;score&#x27; =&gt; 91, &#x27;team&#x27; =&gt; &#x27;E&#x27;],</span></span><br><span class="line"><span class="comment">// 3 =&gt; [&#x27;score&#x27; =&gt; 86, &#x27;team&#x27; =&gt; &#x27;D&#x27;],</span></span><br><span class="line"><span class="comment">// 2 =&gt; [&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;C&#x27;],</span></span><br><span class="line"><span class="comment">// 7 =&gt; [&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;H&#x27;],</span></span><br><span class="line"><span class="comment">// 0 =&gt; [&#x27;score&#x27; =&gt; 76, &#x27;team&#x27; =&gt; &#x27;A&#x27;],</span></span><br><span class="line"><span class="comment">// 5 =&gt; [&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;F&#x27;],</span></span><br><span class="line"><span class="comment">// 6 =&gt; [&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;G&#x27;],</span></span><br><span class="line"><span class="comment">// 1 =&gt; [&#x27;score&#x27; =&gt; 62, &#x27;team&#x27; =&gt; &#x27;B&#x27;],</span></span><br><span class="line"><span class="comment">// ];</span></span><br></pre></td></tr></table></figure><br>Một cách đơn giản để fix chỗ này là gọi phương thức <code>values</code>, nó sẽ xóa các key đã tồn tại đi và reset chúng về dạng bình thường<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rankedScores</span> = <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)-&gt;values();</span><br><span class="line"><span class="comment">// =&gt; [</span></span><br><span class="line"><span class="comment">// 0 =&gt; [&#x27;score&#x27; =&gt; 91, &#x27;team&#x27; =&gt; &#x27;E&#x27;],</span></span><br><span class="line"><span class="comment">// 1 =&gt; [&#x27;score&#x27; =&gt; 86, &#x27;team&#x27; =&gt; &#x27;D&#x27;],</span></span><br><span class="line"><span class="comment">// 2 =&gt; [&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;C&#x27;],</span></span><br><span class="line"><span class="comment">// 3 =&gt; [&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;H&#x27;],</span></span><br><span class="line"><span class="comment">// 4 =&gt; [&#x27;score&#x27; =&gt; 76, &#x27;team&#x27; =&gt; &#x27;A&#x27;],</span></span><br><span class="line"><span class="comment">// 5 =&gt; [&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;F&#x27;],</span></span><br><span class="line"><span class="comment">// 6 =&gt; [&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;G&#x27;],</span></span><br><span class="line"><span class="comment">// 7 =&gt; [&#x27;score&#x27; =&gt; 62, &#x27;team&#x27; =&gt; &#x27;B&#x27;],</span></span><br><span class="line"><span class="comment">// ];</span></span><br></pre></td></tr></table></figure><br>Có vẻ tốt hơn 1 chút rồi nhưng ranking thực tế vẫn bị giảm đi 1 đúng không? Tôi nghĩ nó sẽ tốt hơn nếu bạn có thể thêm trường rank cho mỗi điểm để lấy rank thực sự, bắt đầu từ 1 thay vì 0.</p>
<h1 id="1-Zipping-in-the-Ranks"><a href="#1-Zipping-in-the-Ranks" class="headerlink" title="1. Zipping-in the Ranks"></a>1. Zipping-in the Ranks</h1><p>Một cách để làm việc này là dùng <code>zip</code> điểm số với danh sách <code>ranks</code>.</p>
<p>Chúng ta có thể sinh danh sách các ranks bằng cách sử dụng <code>range($start, $end)</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rankedScores</span> = <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">    -&gt;zip(range(<span class="number">1</span>, <span class="variable">$scores</span>-&gt;count()));</span><br><span class="line"><span class="comment">// =&gt; [</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 91, &#x27;team&#x27; =&gt; &#x27;E&#x27;], 1],</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 86, &#x27;team&#x27; =&gt; &#x27;D&#x27;], 2],</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;C&#x27;], 3],</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;H&#x27;], 4],</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 76, &#x27;team&#x27; =&gt; &#x27;A&#x27;], 5],</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;F&#x27;], 6],</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;G&#x27;], 7],</span></span><br><span class="line"><span class="comment">// [[&#x27;score&#x27; =&gt; 62, &#x27;team&#x27; =&gt; &#x27;B&#x27;], 8],</span></span><br><span class="line"><span class="comment">// ];</span></span><br></pre></td></tr></table></figure><br>Một cách tốt khi sử dụng theo hướng này là chúng ta có thể bỏ lời gọi <code>values</code>, chúng ta không phải thực sự lo về vấn đề <code>keys</code> thêm 1 lần nào nữa.</p>
<p>Sau khi <code>zip</code> điểm số với rank của họ, chúng ta có thể sử dụng <code>map</code> để thêm rank vào như 1 trường thực sự:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rankedScores</span> = <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">    -&gt;zip(range(<span class="number">1</span>, <span class="variable">$scores</span>-&gt;count()))</span><br><span class="line">    -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$scoreAndRank</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$score</span>, <span class="variable">$rank</span>) = <span class="variable">$scoreAndRank</span>;</span><br><span class="line">        <span class="keyword">return</span> array_merge(<span class="variable">$score</span>, [</span><br><span class="line">            <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$rank</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">// =&gt; [</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 1, &#x27;score&#x27; =&gt; 91, &#x27;team&#x27; =&gt; &#x27;E&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 2, &#x27;score&#x27; =&gt; 86, &#x27;team&#x27; =&gt; &#x27;D&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 3, &#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;C&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 4, &#x27;score&#x27; =&gt; 82, &#x27;team&#x27; =&gt; &#x27;H&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 5, &#x27;score&#x27; =&gt; 76, &#x27;team&#x27; =&gt; &#x27;A&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 6, &#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;F&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 7, &#x27;score&#x27; =&gt; 67, &#x27;team&#x27; =&gt; &#x27;G&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;rank&#x27; =&gt; 8, &#x27;score&#x27; =&gt; 62, &#x27;team&#x27; =&gt; &#x27;B&#x27;],</span></span><br><span class="line"><span class="comment">// ];</span></span><br></pre></td></tr></table></figure></p>
<h1 id="2-Dealing-with-Ties-Giao-dich-voi-diem-bang-nhau"><a href="#2-Dealing-with-Ties-Giao-dich-voi-diem-bang-nhau" class="headerlink" title="2. Dealing with Ties (Giao dịch với điểm bằng nhau)"></a>2. Dealing with Ties (Giao dịch với điểm bằng nhau)</h1><p>Nếu bạn nhìn kỹ điểm đã được sắp xếp, bạn sẽ nhận thấy có 2 tập có điểm bằng nhau<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">[<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">4</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;H&#x27;</span>],</span><br></pre></td></tr></table></figure><br>Liệu có thực sự chơi đẹp không khi team C nhận vị trí thứ 3 còn team H nhận ví trí thứ 4 mặc dù 2 đội bằng điểm? Tại sao không có cách xử ý nào khác?</p>
<p>Cách xử lý có thể áp dụng luật xếp rank <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Ranking#Standard_competition_ranking_.28.221224.22_ranking.29">https://en.wikipedia.org/wiki/Ranking#Standard_competition_ranking_.28.221224.22_ranking.29</a> khi 2 đội bằng điểm, bỏ qua thứ hạng và những điểm số khác. </p>
<p>Và đây là cái theo như chuẩn ranking sẽ cần điều chỉnh:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">91</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;E&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">2</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">86</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;D&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;H&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">5</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">76</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">6</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;F&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">6</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;G&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">8</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">62</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><br>OK, ý tưởng là vậy, nhưng làm sao chúng ta có thể thực thi chúng?</p>
<h1 id="3-One-Step-at-a-Time"><a href="#3-One-Step-at-a-Time" class="headerlink" title="3. One Step at a Time"></a>3. One Step at a Time</h1><p>Tôi có chút thú nhận khi làm: Mất rất nhiều thời gian khi tôi giải quyết vấn đề này với <code>collection pipelines</code>, tôi không có ý tưởng gì để giải quyết vấn đề này.</p>
<p>Một trong những thứ tốt đẹp nhất mà <code>collection pipeline</code> mang lại là mỗi bước nhỏ  và rời rạc. Chúng ta đã nói 1 chút về nó, về cách mà nó làm cho code trở nên dễ theo dõi hơn nhưng không dễ để viết.</p>
<p>Thay vì tìm ra tất cả các thuật toán, tôi chỉ chưa bao giờ phải lo lắng về việc nhận 1 bước nào đó gần hơn cho vấn đề tôi đang gặp phải. Nếu có đủ thời gian, tôi đã có thể kết thúc vấn đề.</p>
<p>Nhưng tôi đang cố cần thực hiện bước nào để thực thi được việc sắp xếp rank theo chuẩn?</p>
<h1 id="4-Grouping-by-Score"><a href="#4-Grouping-by-Score" class="headerlink" title="4. Grouping by Score"></a>4. Grouping by Score</h1><p>Nếu team bạn đang có các điểm giống nhau và hỗ trợ nhận các rank giống nhau, sẽ sắp xếp kết quả theo score có giải là đủ để giải quyết vấn đề:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rankedScores</span> = <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">    -&gt;zip(range(<span class="number">1</span>, <span class="variable">$scores</span>-&gt;count()))</span><br><span class="line">    -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$scoreAndRank</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$score</span>, <span class="variable">$rank</span>) = <span class="variable">$scoreAndRank</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> array_merge(<span class="variable">$score</span>, [</span><br><span class="line">            <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$rank</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;)</span><br><span class="line">    -&gt;groupBy(<span class="string">&#x27;score&#x27;</span>);</span><br></pre></td></tr></table></figure><br>Kết quả chúng ta nhận được sẽ như sau:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="number">91</span> =&gt; [</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">91</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;E&#x27;</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="number">86</span> =&gt; [</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">2</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">86</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;D&#x27;</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="number">82</span> =&gt; [</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">4</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;H&#x27;</span>],</span><br><span class="line">    ],</span><br><span class="line">    <span class="number">76</span> =&gt; [</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">5</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">76</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;A&#x27;</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="number">67</span> =&gt; [</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">6</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;F&#x27;</span>],</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">7</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;G&#x27;</span>],</span><br><span class="line">    ],</span><br><span class="line">    <span class="number">62</span> =&gt; [</span><br><span class="line">        [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">8</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">62</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">    ],</span><br><span class="line">];</span><br></pre></td></tr></table></figure></p>
<h1 id="5-Adjusting-the-Ranks"><a href="#5-Adjusting-the-Ranks" class="headerlink" title="5. Adjusting the Ranks"></a>5. Adjusting the Ranks</h1><p>Như vậy chúng ta có tất cả kết quả đã được nhóm theo điểm và chúng ta muốn chắc chắn rằng 1 vài team có điểm giống nhau sẽ có rank tốt nhất có thể. Hãy nhìn xem 1 phần của các cặp điểm giống nhau và chúng ta có thể nghỉ cách nào để làm việc với nó:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tiedScores</span> = collect([</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">4</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;H&#x27;</span>],</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><br>Với nhóm kết quả này, làm sao chúng ta chắc chắn rằng cả 2 đều ở vị trí thứ 3.</p>
<p>Đầu tiên chúng ta cần tìm ra rank tốt nhất trong nhóm. Chúng ta có thể làm điều này bằng cách sử dụng <code>pluck</code> để lấy tập collection của mỗi rank và sử dụng <code>min</code> để lấy rank nhỏ nhất của collection:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br></pre></td></tr></table></figure><br>Đủ dễ rồi! Bây giờ chúng ta cần gán rank giống nhau với mỗi team. Chúng ta có thể sử dụng <code>map</code> cho mỗi team để chuyển đổi mỗi kết quả:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br><span class="line"></span><br><span class="line"><span class="variable">$adjustedScores</span> = <span class="variable">$tiedScores</span>-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScore</span></span>) <span class="title">use</span> (<span class="params"><span class="variable">$lowestRank</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$rankedScore</span>[<span class="string">&#x27;rank&#x27;</span>] = <span class="variable">$lowestRank</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$rankedScore</span>;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Chúng ta có 1 chút cẩn thận vì chúng ta không được phép biến đổi trong hàm <code>map</code>, bạn nhớ chứ?</p>
</blockquote>
<p>Trong trường hợp này, sự thay đổi rank <code>key</code> không biến đổi gì về mặt kỹ thuật ngoài hàm <code>closure</code> vì hàm trong PHP được pass by value nhưng nếu chúng ta làm việc với objects, nó sẽ là vấn đề lớn.<br>Với sự lợi ích nhất quán, chúng tôi khuyên bạn nên trả về hàm mới, sử dụng <code>array_merge</code> để thay thế rank cũ bằng 1 hàm mới:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br><span class="line"><span class="variable">$adjustedScores</span> = <span class="variable">$tiedScores</span>-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScore</span></span>) <span class="title">use</span> (<span class="params"><span class="variable">$lowestRank</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> array_merge(<span class="variable">$rankedScore</span>, [</span><br><span class="line">        <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$lowestRank</span></span><br><span class="line">    ]);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>Sau khi áp dụng việc chuyển đổi, chúng ra nhận được tập các điểm mới nhìn như sau:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;H&#x27;</span>],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><br>Bây giờ, cả 2 team có điểm giống nhau với vị trí thứ 3, đúng như chúng ta muốn, perfect!<br>Để áp dụng việc chuyển đổi cho mỗi nhóm điểm, chúng ta chỉ cần map mỗi nhóm là được.</p>
<h1 id="6-Collapse-and-Sort-Thu-gon-va-sap-xep"><a href="#6-Collapse-and-Sort-Thu-gon-va-sap-xep" class="headerlink" title="6. Collapse and Sort: Thu gọn và sắp xếp"></a>6. Collapse and Sort: Thu gọn và sắp xếp</h1><p>Bây giờ kết quả của chúng ta đã được sắp xếp theo điểm. Chúng ta có thể làm phẳng chúng xuống bằng cách sử dụng collapse. Kết quả thu được sẽ như sau:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">91</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;E&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">2</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">86</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;D&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">82</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;H&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">5</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">76</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">6</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;F&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">6</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">67</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;G&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;rank&#x27;</span> =&gt; <span class="number">8</span>, <span class="string">&#x27;score&#x27;</span> =&gt; <span class="number">62</span>, <span class="string">&#x27;team&#x27;</span> =&gt; <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">];</span><br></pre></td></tr></table></figure><br>Tuyệt vời, chúng ta đã có kết quả như chúng ta mong đợi.</p>
<p>Sau đó chúng ta có thể sắp xếp rank theo ý.</p>
<h1 id="7-Cleaning-Up"><a href="#7-Cleaning-Up" class="headerlink" title="7. Cleaning Up"></a>7. Cleaning Up</h1><p>Đây là những thứ chặt chẽ tôi sẽ đẩy vào trong hàm<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rank_scores</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> collect(<span class="variable">$scores</span>)</span><br><span class="line">        -&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">        -&gt;zip(range(<span class="number">1</span>, <span class="variable">$scores</span>-&gt;count()))</span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$scoreAndRank</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">list</span>(<span class="variable">$score</span>, <span class="variable">$rank</span>) = <span class="variable">$scoreAndRank</span>;</span><br><span class="line">            <span class="keyword">return</span> array_merge(<span class="variable">$score</span>, [</span><br><span class="line">                <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$rank</span></span><br><span class="line">            ]);</span><br><span class="line">        &#125;)</span><br><span class="line">        -&gt;groupBy(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$tiedScores</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$tiedScores</span>-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScore</span></span>) <span class="title">use</span> (<span class="params"><span class="variable">$lowestRank</span></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> array_merge(<span class="variable">$rankedScore</span>, [</span><br><span class="line">                    <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$lowestRank</span></span><br><span class="line">                ]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        -&gt;collapse()</span><br><span class="line">        -&gt;sortBy(<span class="string">&#x27;rank&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Hãy nhìn chỗ code này, phần hàm map thứ 2 hoàn toàn có thể thay thế bởi 1 hàm với tên gọi <code>apply_min_rank</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">function rank_scores($scores)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    return collect($scores)</span></span><br><span class="line"><span class="comment">        -&gt;sortByDesc(&#x27;score&#x27;)</span></span><br><span class="line"><span class="comment">        -&gt;zip(range(1, $scores-&gt;count()))</span></span><br><span class="line"><span class="comment">        -&gt;map(function ($scoreAndRank) &#123;</span></span><br><span class="line"><span class="comment">            list($score, $rank) = $scoreAndRank;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            return array_merge($score, [</span></span><br><span class="line"><span class="comment">                &#x27;rank&#x27; =&gt; $rank</span></span><br><span class="line"><span class="comment">            ]);</span></span><br><span class="line"><span class="comment">        &#125;)</span></span><br><span class="line"><span class="comment">        -&gt;groupBy(&#x27;score&#x27;)</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$tiedScores</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$tiedScores</span>-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScore</span></span>) <span class="title">use</span> (<span class="params"><span class="variable">$lowestRank</span></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> array_merge(<span class="variable">$rankedScore</span>, [</span><br><span class="line">                        <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$lowestRank</span></span><br><span class="line">                    ]);</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">        -&gt;collapse()</span></span><br><span class="line"><span class="comment">        -&gt;sortBy(&#x27;rank&#x27;);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure><br>Thay thế bằng:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">function rank_scores($scores)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    return collect($scores)</span></span><br><span class="line"><span class="comment">        -&gt;sortByDesc(&#x27;score&#x27;)</span></span><br><span class="line"><span class="comment">        -&gt;zip(range(1, $scores-&gt;count()))</span></span><br><span class="line"><span class="comment">        -&gt;map(function ($scoreAndRank) &#123;</span></span><br><span class="line"><span class="comment">            list($score, $rank) = $scoreAndRank;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            return array_merge($score, [</span></span><br><span class="line"><span class="comment">                &#x27;rank&#x27; =&gt; $rank</span></span><br><span class="line"><span class="comment">            ]);</span></span><br><span class="line"><span class="comment">        &#125;)</span></span><br><span class="line"><span class="comment">        -&gt;groupBy(&#x27;score&#x27;)</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$tiedScores</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> apply_min_rank(<span class="variable">$tiedScores</span>);</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">        -&gt;collapse()</span></span><br><span class="line"><span class="comment">        -&gt;sortBy(&#x27;rank&#x27;);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">apply_min_rank</span>(<span class="params"><span class="variable">$tiedScores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$tiedScores</span>-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScore</span></span>) <span class="title">use</span> (<span class="params"><span class="variable">$lowestRank</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> array_merge(<span class="variable">$rankedScore</span>, [</span><br><span class="line">            <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$lowestRank</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Nhìn có vẻ đẹp hơn 1 chút xíu, Nhưng chúng chưa thực sự giàu tính biểu đạt.</p>
<h1 id="8-Grouping-Operations"><a href="#8-Grouping-Operations" class="headerlink" title="8. Grouping Operations"></a>8. Grouping Operations</h1><p>Phần map ở trên được sử dụng để <strong>gán và khởi tạo rank</strong> cho mỗi điểm.<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rank_scores</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> collect(<span class="variable">$scores</span>)</span><br><span class="line">        -&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">        -&gt;zip(range(<span class="number">1</span>, <span class="variable">$scores</span>-&gt;count()))</span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$scoreAndRank</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">list</span>(<span class="variable">$score</span>, <span class="variable">$rank</span>) = <span class="variable">$scoreAndRank</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> array_merge(<span class="variable">$score</span>, [</span><br><span class="line">                <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$rank</span></span><br><span class="line">            ]);</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">        -&gt;groupBy(&#x27;score&#x27;)</span></span><br><span class="line"><span class="comment">        -&gt;map(function ($tiedScores) &#123;</span></span><br><span class="line"><span class="comment">            $lowestRank = $tiedScores-&gt;pluck(&#x27;rank&#x27;)-&gt;min();</span></span><br><span class="line"><span class="comment">                return $tiedScores-&gt;map(function ($rankedScore) use ($lowestRank) &#123;</span></span><br><span class="line"><span class="comment">                    return array_merge($rankedScore, [</span></span><br><span class="line"><span class="comment">                        &#x27;rank&#x27; =&gt; $lowestRank</span></span><br><span class="line"><span class="comment">                    ]);</span></span><br><span class="line"><span class="comment">                &#125;);</span></span><br><span class="line"><span class="comment">        &#125;)</span></span><br><span class="line"><span class="comment">        -&gt;collapse()</span></span><br><span class="line"><span class="comment">        -&gt;sortBy(&#x27;rank&#x27;);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure><br>Tương tự 3 bước ở dưới đang <strong>chỉnh sửa rank có cùng điểm số.</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">function rank_scores($scores)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    return collect($scores)</span></span><br><span class="line"><span class="comment">        -&gt;sortByDesc(&#x27;score&#x27;)</span></span><br><span class="line"><span class="comment">        -&gt;zip(range(1, $scores-&gt;count()))</span></span><br><span class="line"><span class="comment">        -&gt;map(function ($scoreAndRank) &#123;</span></span><br><span class="line"><span class="comment">            list($score, $rank) = $scoreAndRank;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            return array_merge($score, [</span></span><br><span class="line"><span class="comment">                &#x27;rank&#x27; =&gt; $rank</span></span><br><span class="line"><span class="comment">            ]);</span></span><br><span class="line"><span class="comment">        &#125;)</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line">        -&gt;groupBy(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$tiedScores</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$tiedScores</span>-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScore</span></span>) <span class="title">use</span> (<span class="params"><span class="variable">$lowestRank</span></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> array_merge(<span class="variable">$rankedScore</span>, [</span><br><span class="line">                        <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$lowestRank</span></span><br><span class="line">                    ]);</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        -&gt;collapse()</span><br><span class="line">        -&gt;sortBy(<span class="string">&#x27;rank&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Chúng ta có thể xử chúng không nhỉ?</p>
<h1 id="9-Breaking-the-Chain"><a href="#9-Breaking-the-Chain" class="headerlink" title="9. Breaking the Chain"></a>9. Breaking the Chain</h1><p>Như đã nói ở trên, hàm <code>assign_initial_rankings</code> sẽ có dạng như sau:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assign_initial_rankings</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">        -&gt;zip(range(<span class="number">1</span>, <span class="variable">$scores</span>-&gt;count()))</span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$scoreAndRank</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">list</span>(<span class="variable">$score</span>, <span class="variable">$rank</span>) = <span class="variable">$scoreAndRank</span>;</span><br><span class="line">            <span class="keyword">return</span> array_merge(<span class="variable">$score</span>, [</span><br><span class="line">                <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$rank</span></span><br><span class="line">            ]);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Và hàm <code>adjust_rankings_for_ties</code>:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">adjust_rankings_for_ties</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$scores</span>-&gt;groupBy(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$tiedScores</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> apply_min_rank(<span class="variable">$tiedScores</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        -&gt;collapse();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Cả 2 đều đơn giản và dễ dàng để hiểu khi chúng ta tách ta nhưng chúng ta sẽ kết hợp chúng vào pipeline như thế nào? Hóa ra chúng là không thể, chúng ta phải ngắt <code>pipeline</code> và sử dụng biến tạm thời<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rank_scores</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$rankedScores</span> = assign_initial_rankings(collect(<span class="variable">$scores</span>));</span><br><span class="line">    <span class="variable">$adjustedScores</span> = adjust_rankings_for_ties(<span class="variable">$rankedScores</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$adjustedScores</span>-&gt;sortBy(<span class="string">&#x27;rank&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Nhìn hơi tù nhỉ. Chúng ta có thể thêm những phần này như là các <code>method</code> vào <code>collection</code> của chúng ta bằng cách sử dụng <code>macros</code> nhưng chúng không thực sự có ý nghĩa như csac phương thức của collection. Cả 2 đều thực hiện các mục đích khác nhau và chúng không thực sự thuộc về mục đích chung của các toán tử collection</p>
<p>Mất một khoảng thời gian dài, tôi chỉ chấp nhận những hạn chế này và thoát nó ra khỏi <code>pipeline</code> khi tôi cần, nhưng gần đây tôi đã vấp ngã trong 1 tiêu chuẩn cái mà làm cho tôi làm tốt cả 2 vấn đề này.</p>
<h1 id="10-The-Pipe-Macro"><a href="#10-The-Pipe-Macro" class="headerlink" title="10. The Pipe Macro"></a>10. The Pipe Macro</h1><p>Chúng ta sẽ có <code>macro</code> đơn giản như sau:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Collection::macro(<span class="string">&#x27;pipe&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$callback</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$callback</span>(<span class="keyword">$this</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>Tất cả nó làm là gọi phương thức <code>pipe</code> cái mà nhận vào 1 callback, truyền collection vào callack và trả lại kết quả.</p>
<p>Khi đó code sẽ đơn giản như sau:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rank_scores</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> collect(<span class="variable">$scores</span>)</span><br><span class="line">        -&gt;pipe(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$scores</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> assign_initial_rankings(<span class="variable">$scores</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        -&gt;pipe(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScores</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> adjust_rankings_for_ties(<span class="variable">$rankedScores</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        -&gt;sortBy(<span class="string">&#x27;rank&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Như vậy chúng ta lại nhận được 1 pipeline! </p>
<blockquote>
<p>PHP cho phép ta đối xử với string như là 1 callback nếu nó trùng với tên function</p>
</blockquote>
<p>Do vậy chúng ta thậm chí cho thể viết:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rank_scores</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> collect(<span class="variable">$scores</span>)</span><br><span class="line">        -&gt;pipe(<span class="string">&#x27;assign_initial_rankings&#x27;</span>)</span><br><span class="line">        -&gt;pipe(<span class="string">&#x27;adjust_rankings_for_ties&#x27;</span>)</span><br><span class="line">        -&gt;sortBy(<span class="string">&#x27;rank&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Không thể có nhiều biểu cảm hơn nữa.</p>
<p>Và đây là luồng chung của cả công việc phân rank:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rank_scores</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> collect(<span class="variable">$scores</span>)</span><br><span class="line">        -&gt;pipe(<span class="string">&#x27;assign_initial_rankings&#x27;</span>)</span><br><span class="line">        -&gt;pipe(<span class="string">&#x27;adjust_rankings_for_ties&#x27;</span>)</span><br><span class="line">        -&gt;sortBy(<span class="string">&#x27;rank&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assign_initial_rankings</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$scores</span>-&gt;sortByDesc(<span class="string">&#x27;score&#x27;</span>)</span><br><span class="line">        -&gt;zip(range(<span class="number">1</span>, <span class="variable">$scores</span>-&gt;count()))</span><br><span class="line">        -&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$scoreAndRank</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">list</span>(<span class="variable">$score</span>, <span class="variable">$rank</span>) = <span class="variable">$scoreAndRank</span>;</span><br><span class="line">            <span class="keyword">return</span> array_merge(<span class="variable">$score</span>, [</span><br><span class="line">                <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$rank</span></span><br><span class="line">            ]);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">adjust_rankings_for_ties</span>(<span class="params"><span class="variable">$scores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$scores</span>-&gt;groupBy(<span class="string">&#x27;score&#x27;</span>)-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$tiedScores</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> apply_min_rank(<span class="variable">$tiedScores</span>);</span><br><span class="line">    &#125;)-&gt;collapse();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">apply_min_rank</span>(<span class="params"><span class="variable">$tiedScores</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$lowestRank</span> = <span class="variable">$tiedScores</span>-&gt;pluck(<span class="string">&#x27;rank&#x27;</span>)-&gt;min();</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$tiedScores</span>-&gt;map(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$rankedScore</span></span>) <span class="title">use</span> (<span class="params"><span class="variable">$lowestRank</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> array_merge(<span class="variable">$rankedScore</span>, [</span><br><span class="line">            <span class="string">&#x27;rank&#x27;</span> =&gt; <span class="variable">$lowestRank</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Thật không tệ với một vấn đề phức tạp phải không nào!!!</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>[Collection] Practice 13: Ranking a Competition</p><p><a href="http://yoursite.com/2019/12/27/Collection-Practice-13-Ranking-a-Competition/">http://yoursite.com/2019/12/27/Collection-Practice-13-Ranking-a-Competition/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Ming</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-12-27</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-08-08</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/collection/">collection</a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/mingnv" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/12/28/Collection-Practice-5-Building-a-Lookup-Table/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[Collection] Practice 5: Building a Lookup Table</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/12/27/Collection-Practice-4-What-s-Your-GitHub-Score/"><span class="level-item">[Collection] Practice 4: What&#039;s Your GitHub Score?</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yoursite.com/2019/12/27/Collection-Practice-13-Ranking-a-Competition/';
            this.page.identifier = '2019/12/27/Collection-Practice-13-Ranking-a-Competition/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'minh' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/spidertocat.png" alt="Minh NV"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Minh NV</p><p class="is-size-6 is-block">_N.V.M_</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hanoi city, Vietnam</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">160</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">36</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">50</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/minhnv2306" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/minhnv2306"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/profile.php?id=100003860456359"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="http://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="http://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AWS-Developer-Associate/"><span class="level-start"><span class="level-item">AWS Developer Associate</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/AWS-Practitioner/"><span class="level-start"><span class="level-item">AWS Practitioner</span></span><span class="level-end"><span class="level-item tag">26</span></span></a></li><li><a class="level is-mobile" href="/categories/AWS-Training/"><span class="level-start"><span class="level-item">AWS Training</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Authentication/"><span class="level-start"><span class="level-item">Authentication</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-code/"><span class="level-start"><span class="level-item">Clean code</span></span><span class="level-end"><span class="level-item tag">16</span></span></a><ul><li><a class="level is-mobile" href="/categories/Clean-code/Clean-code-Robert-C-Martin/"><span class="level-start"><span class="level-item">Clean code - Robert C. Martin</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-code/Refactoring-to-Collections/"><span class="level-start"><span class="level-item">Refactoring to Collections</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/MongoDB/"><span class="level-start"><span class="level-item">MongoDB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/"><span class="level-start"><span class="level-item">Development and Operation</span></span><span class="level-end"><span class="level-item tag">33</span></span></a><ul><li><a class="level is-mobile" href="/categories/Development-and-Operation/CircleCI-2-0/"><span class="level-start"><span class="level-item">CircleCI 2.0</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Google-Cloud-Platform/"><span class="level-start"><span class="level-item">Google Cloud Platform</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Laravel/"><span class="level-start"><span class="level-item">Laravel</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Linux-OS/"><span class="level-start"><span class="level-item">Linux OS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Web-Server/"><span class="level-start"><span class="level-item">Web Server</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/JP/"><span class="level-start"><span class="level-item">JP</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/"><span class="level-start"><span class="level-item">JavaScript</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/JavaScript/Asynchronous/"><span class="level-start"><span class="level-item">Asynchronous</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/Event/"><span class="level-start"><span class="level-item">Event</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/React/"><span class="level-start"><span class="level-item">React</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">15</span></span></a><ul><li><a class="level is-mobile" href="/categories/Others/Cong-cu-lap-trinh/"><span class="level-start"><span class="level-item">Công cụ lập trình</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/PHPCS/"><span class="level-start"><span class="level-item">PHPCS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Suu-tam/"><span class="level-start"><span class="level-item">Sưu tầm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Website-Optimization/"><span class="level-start"><span class="level-item">Website Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Snippets-code/"><span class="level-start"><span class="level-item">Snippets code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Special-day/"><span class="level-start"><span class="level-item">Special day</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/"><span class="level-start"><span class="level-item">The Art of Readable Code</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Chapter-1-Code-Should-Be-Easy-to-Understand/"><span class="level-start"><span class="level-item">Chapter 1 - Code Should Be Easy to Understand</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-I-Surface-Level-Improvements/"><span class="level-start"><span class="level-item">Part I - Surface-Level Improvements</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-II-Simplifying-Loops-and-Logic/"><span class="level-start"><span class="level-item">Part II - Simplifying Loops and Logic</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-III-Reorganizing-Your-Code/"><span class="level-start"><span class="level-item">Part III - Reorganizing Your Code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-IV-Selected-Topics/"><span class="level-start"><span class="level-item">Part IV - Selected Topics</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Unit-Test/"><span class="level-start"><span class="level-item">Unit Test</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/API/"><span class="tag">API</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CI-CD/"><span class="tag">CI/CD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kanji/"><span class="tag">Kanji</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-command-line/"><span class="tag">Linux command line</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache2/"><span class="tag">apache2</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/async-programing/"><span class="tag">async programing</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/authentication/"><span class="tag">authentication</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-exam-preparation/"><span class="tag">aws exam preparation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-labs/"><span class="tag">aws labs</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-certificate/"><span class="tag">aws-certificate</span><span class="tag">44</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-comment/"><span class="tag">clean comment</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-error/"><span class="tag">clean error</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-function/"><span class="tag">clean function</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/collection/"><span class="tag">collection</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/configuration/"><span class="tag">configuration</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-command/"><span class="tag">docker command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-file-format/"><span class="tag">docker compose file format</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-best-practice/"><span class="tag">docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-yml/"><span class="tag">docker-compose.yml</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-instructions-docker-best-practice/"><span class="tag">docker-instructions docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-network/"><span class="tag">docker-network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-volume/"><span class="tag">docker-volume</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event/"><span class="tag">event</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event-notification/"><span class="tag">event notification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/excelfile/"><span class="tag">excelfile</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gcp/"><span class="tag">gcp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jquery-validation/"><span class="tag">jquery-validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubernetes/"><span class="tag">kubernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel/"><span class="tag">laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongoDB/"><span class="tag">mongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/naming/"><span class="tag">naming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/note-choi-choi/"><span class="tag">note choi choi</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs/"><span class="tag">phpcs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs-phpcsfixer/"><span class="tag">phpcs phpcsfixer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/process-management/"><span class="tag">process management</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-boilerplate/"><span class="tag">react boilerplate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/requests/"><span class="tag">requests</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/snippets-code/"><span class="tag">snippets-code</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stripe/"><span class="tag">stripe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sudo-command/"><span class="tag">sudo command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tips-laravel/"><span class="tag">tips laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tracking-php-script/"><span class="tag">tracking php script</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unit-test/"><span class="tag">unit test</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/validation/"><span class="tag">validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vba/"><span class="tag">vba</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vim/"><span class="tag">vim</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1-Zipping-in-the-Ranks"><span class="level-left"><span class="level-item">1</span><span class="level-item">1. Zipping-in the Ranks</span></span></a></li><li><a class="level is-mobile" href="#2-Dealing-with-Ties-Giao-dich-voi-diem-bang-nhau"><span class="level-left"><span class="level-item">2</span><span class="level-item">2. Dealing with Ties (Giao dịch với điểm bằng nhau)</span></span></a></li><li><a class="level is-mobile" href="#3-One-Step-at-a-Time"><span class="level-left"><span class="level-item">3</span><span class="level-item">3. One Step at a Time</span></span></a></li><li><a class="level is-mobile" href="#4-Grouping-by-Score"><span class="level-left"><span class="level-item">4</span><span class="level-item">4. Grouping by Score</span></span></a></li><li><a class="level is-mobile" href="#5-Adjusting-the-Ranks"><span class="level-left"><span class="level-item">5</span><span class="level-item">5. Adjusting the Ranks</span></span></a></li><li><a class="level is-mobile" href="#6-Collapse-and-Sort-Thu-gon-va-sap-xep"><span class="level-left"><span class="level-item">6</span><span class="level-item">6. Collapse and Sort: Thu gọn và sắp xếp</span></span></a></li><li><a class="level is-mobile" href="#7-Cleaning-Up"><span class="level-left"><span class="level-item">7</span><span class="level-item">7. Cleaning Up</span></span></a></li><li><a class="level is-mobile" href="#8-Grouping-Operations"><span class="level-left"><span class="level-item">8</span><span class="level-item">8. Grouping Operations</span></span></a></li><li><a class="level is-mobile" href="#9-Breaking-the-Chain"><span class="level-left"><span class="level-item">9</span><span class="level-item">9. Breaking the Chain</span></span></a></li><li><a class="level is-mobile" href="#10-The-Pipe-Macro"><span class="level-left"><span class="level-item">10</span><span class="level-item">10. The Pipe Macro</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T14:55:03.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Clean-code-Chapter-11-System/">[Clean code] Chapter 11: System</a></p><p class="categories"><a href="/categories/Clean-code/">Clean code</a> / <a href="/categories/Clean-code/Clean-code-Robert-C-Martin/">Clean code - Robert C. Martin</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T14:01:21.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Blog-for-me/">Blog for me</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T13:46:55.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Tips-2-PHP-Snippets-code/">Tips 2: PHP Snippets code</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-23T15:42:35.000Z">2024-08-23</time></p><p class="title"><a href="/2024/08/23/Tips-Laravel-Snippets-code/">Tips 1: Laravel Snippets code</a></p><p class="categories"><a href="/categories/Snippets-code/">Snippets code</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-17T15:41:26.000Z">2024-08-17</time></p><p class="title"><a href="/2024/08/17/Clean-code-Chapter-10-Class/">[Clean code] Chapter 10: Class</a></p><p class="categories"><a href="/categories/Clean-code/">Clean code</a> / <a href="/categories/Clean-code/Clean-code-Robert-C-Martin/">Clean code - Robert C. Martin</a></p></div></article></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://blog.zhangruipeng.me/hexo-theme-icarus/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus blog</span></span><span class="level-right"><span class="level-item tag">blog.zhangruipeng.me</span></span></a></li><li><a class="level is-mobile" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus github</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://octodex.github.com/images/privateinvestocat.jpg" alt="Hello, I am Minh" height="28"></a><p class="is-size-7"><span>&copy; 2024 Ming</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>