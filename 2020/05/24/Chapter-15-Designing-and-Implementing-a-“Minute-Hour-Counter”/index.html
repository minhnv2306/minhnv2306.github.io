<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Chapter 15: Designing and Implementing a “Minute/Hour Counter” - Hello, I am Minh</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hello, I am Minh"><meta name="msapplication-TileImage" content="/img/my_favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hello, I am Minh"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Hãy xem 1 cấu trúc dữ liệu được sử dụng trong code production thực tế: một “minute&amp;#x2F;hour counter”. Chúng tôi sẽ đưa ra cho bạn quá trình tự suy nghĩ tự nhiên của 1 kĩ sư có thể trải qua, đầu tiên thử g"><meta property="og:type" content="blog"><meta property="og:title" content="Chapter 15: Designing and Implementing a “Minute/Hour Counter”"><meta property="og:url" content="http://yoursite.com/2020/05/24/Chapter-15-Designing-and-Implementing-a-%E2%80%9CMinute-Hour-Counter%E2%80%9D/"><meta property="og:site_name" content="Hello, I am Minh"><meta property="og:description" content="Hãy xem 1 cấu trúc dữ liệu được sử dụng trong code production thực tế: một “minute&amp;#x2F;hour counter”. Chúng tôi sẽ đưa ra cho bạn quá trình tự suy nghĩ tự nhiên của 1 kĩ sư có thể trải qua, đầu tiên thử g"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/introduction.png?raw=true"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/the_problem.png?raw=true"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/attempt2-1.png?raw=true"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/attempt2-2.png?raw=true"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/attempt3.png?raw=true"><meta property="article:published_time" content="2020-05-24T15:32:06.000Z"><meta property="article:modified_time" content="2024-08-08T03:51:32.235Z"><meta property="article:author" content="Ming"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/introduction.png?raw=true"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/05/24/Chapter-15-Designing-and-Implementing-a-%E2%80%9CMinute-Hour-Counter%E2%80%9D/"},"headline":"Chapter 15: Designing and Implementing a “Minute/Hour Counter”","image":[],"datePublished":"2020-05-24T15:32:06.000Z","dateModified":"2024-08-08T03:51:32.235Z","author":{"@type":"Person","name":"Ming"},"description":"Hãy xem 1 cấu trúc dữ liệu được sử dụng trong code production thực tế: một “minute&#x2F;hour counter”. Chúng tôi sẽ đưa ra cho bạn quá trình tự suy nghĩ tự nhiên của 1 kĩ sư có thể trải qua, đầu tiên thử g"}</script><link rel="canonical" href="http://yoursite.com/2020/05/24/Chapter-15-Designing-and-Implementing-a-%E2%80%9CMinute-Hour-Counter%E2%80%9D/"><link rel="icon" href="/img/my_favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-112002191-2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-112002191-2');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://octodex.github.com/images/privateinvestocat.jpg" alt="Hello, I am Minh" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-05-24T15:32:06.000Z" title="5/24/2020, 10:32:06 PM">2020-05-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-08T03:51:32.235Z" title="8/8/2024, 10:51:32 AM">2024-08-08</time></span><span class="level-item"><a class="link-muted" href="/categories/The-Art-of-Readable-Code/">The Art of Readable Code</a></span><span class="level-item">an hour read (About 7743 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">Chapter 15: Designing and Implementing a “Minute/Hour Counter”</h1><div class="content"><p>Hãy xem 1 cấu trúc dữ liệu được sử dụng trong code production thực tế: một “minute/hour counter”. Chúng tôi sẽ đưa ra cho bạn quá trình tự suy nghĩ tự nhiên của 1 kĩ sư có thể trải qua, đầu tiên thử giải quyết vấn đề và sao đó cải thiện hiệu năng của nó và thêm các chức năng. Quan trọng nhất, chúng ta sẽ cố gắng để code dễ đọc , sử dụng các nguyên tắc trong cuốn sách này. Chúng tôi có thể có một số lượt sai trên đường đi hoặc phạm sai lầm khác. Hãy xem nếu bạn có thể làm theo và bắt được chúng.</p>
<span id="more"></span>
<img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/introduction.png?raw=true" class="[]">
<h1 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a>The Problem</h1><p>Chúng ta cần theo dõi số lượng bytes của 1 web server được truyền trong 1 phút và trong 1 giờ.</p>
<img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/the_problem.png?raw=true" class="[]">
<p>Đây là 1 vấn đề khác đơn giản, nhưng như bạn sẽ thấy, giải quyết nó hiệu quả là 1 thử thách thú vị. Hãy bắt đầu bằng việc định nghĩa class interface.</p>
<h1 id="Defining-the-Class-Interface"><a href="#Defining-the-Class-Interface" class="headerlink" title="Defining the Class Interface"></a>Defining the Class Interface</h1><p>Đây là phiên bản đầu tiên của chúng ta với class interface trong C++:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// Add a count</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Count</span><span class="params">(<span class="keyword">int</span> num_bytes)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the count over this minute</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the count over this hour</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">HourCount</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>Trước khi chúng ta thực thi lớp này, hãy xem về tên và comment nếu có 1 vài thứ gì đó chúng ta muốn thay đổi.</p>
<h2 id="Improving-the-Names"><a href="#Improving-the-Names" class="headerlink" title="Improving the Names"></a>Improving the Names</h2><p>Tên <code>MinuteHourCounter</code> khá tốt. Nó rõ ràng, cụ thể và dễ đọc.</p>
<p>Trong lớp này, phương thức <code>MinuteCount()</code> và <code>HourCount()</code> cũng hợp lý. Bạn cũng có thể gọi nó là <code>GetMinuteCount()</code> và <code>GetHourCount()</code> nhưng không giúp ích được nhiều. Như chúng tôi đã nói ở chương 3 Names That Can’t Be Misconstrued, “get” ngụ ý “lightweight accessor” (kiểu theo tác nhẹ nhàng thôi) với nhiều người. Và như bạn thấy, sự thực thi này không nhẹ nhàng, do đó tốt nhất là bỏ “get” đi.</p>
<p>Phương thức tên <code>Count()</code> thì có vấn đề. Chúng tôi đã hỏi đồng nghiệp là họ nghĩ <code>Count()</code> sẽ làm gì và 1 số người đã nghĩ nó là “trả về tổng số đếm trong mọi lúc”. Tên này có 1 chút phản trực giác (không có ý định chơi chữ). Vấn đề là <code>Count</code> vừa là danh từ vừa là động từ và có thể nghĩa là cả “Tôi muốn đếm số mẫu bạn đã thấy” hoặc “Tôi muốn bạn đếm mẫu này”.</p>
<p>Đây là 1 vài tên thay thế có thể cân nhắc với <code>Count()</code>:</p>
<ul>
<li>Increment()</li>
<li>Observe()</li>
<li>Record()</li>
<li>Add()</li>
</ul>
<p><code>Increment()</code> có thể gây hiểu nhầm vì nó có ý là giá trị này chỉ tăng (trong trường hợp của chúng ta, số giờ giao động theo thời gian).<br><code>Observe()</code> okay, nhưng hơi mơ hồ.<br><code>Record()</code> cũng vừa là danh từ, vừa là động từ, không tốt lắm.<br><code>Add()</code> thú vị vì nó vừa có nghĩa “thêm số này” hoặc “thêm 1 danh sách của dữ liệu” - trong trường hợp của chúng ta, nó là 1 chút của cả 2 do đó vẫn hoạt động. Do đó chúng ta sẽ đổi tên phương thức thành <code>void Add(int num_bytes)</code>.</p>
<p>Nhưng đối số với tên <code>num_bytes</code> quá cụ thể. Đúng, trường hợp sử dụng chính của chúng ta là đếm cố bytes nhưng <code>MinuteHourCounter</code> không cần biết điều đó. Chúng ta có thể sử dụng nhiều tên chung hơn như <code>delta</code> nhưng khái niệm <code>delta</code> thường được sử dụng cho cả số âm, và đó là điều chúng ta không muốn. Tên <code>count</code> nên được sử dụng - nó đơn giản, chung hơn và ngụ ý là “không âm”. Ngoài ra, nó còn cho phép chúng ta lén lút sử dụng từ “count” trong một bối cảnh ít mơ hồ hơn.</p>
<h2 id="Improving-the-Comments"><a href="#Improving-the-Comments" class="headerlink" title="Improving the Comments"></a>Improving the Comments</h2><p>Đây là class interface chúng ta có cho đến thời điểm hiện tại:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// Add a count</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the count over this minute</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the count over this hour</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">HourCount</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>Hãy xem mỗi comment và cải thiện chúng. Xem xét comment đầu tiên:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Add a count</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span></span>;</span><br></pre></td></tr></table></figure><br>Comment này hoàn toàn dư thừa - nó nên được xóa hoặc cải thiện. Đây là phiên bản cải thiện của nó:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Add a new data point (count &gt;= 0).</span></span><br><span class="line"><span class="comment">// For the next minute, MinuteCount() will be larger by +count.</span></span><br><span class="line"><span class="comment">// For the next hour, HourCount() will be larger by +count.</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span></span>;</span><br></pre></td></tr></table></figure><br>Bây giờ xem xét comment cho <code>MinuteCount()</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return the count over this minute</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><br>Khi chúng tôi hỏi đồng nghiệp rằng comment này có nghĩa là gì, có 2 sự giải thích mâu thuẫn:</p>
<ol>
<li>Trả về số đếm trong đồng hồ, như là 12:13pm.</li>
<li>Trả về số đếm trong 60 giây, bất kể ranh giới phút đồng hồ.</li>
</ol>
<p>Cách hiểu thử 2 là đúng cái mà nó đang hoạt động. Do đó để không bị hiểu nhầm, chúng ta sẽ thêm mô tả comment:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Return the accumulated count over the past 60 seconds.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><br>(Tương tự, bạn hoàn toàn có thể cải thiện comment cho <code>HourCount()</code>)</p>
<p>Đây là định nghĩa lớp sau tất cả thay đổi cho đến thời điểm hiện tại, với các comment class-level:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Track the cumulative counts over the past minute and over the past hour.</span></span><br><span class="line"><span class="comment">// Useful, for example, to track recent bandwidth usage.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line">    <span class="comment">// Add a new data point (count &gt;= 0).</span></span><br><span class="line">    <span class="comment">// For the next minute, MinuteCount() will be larger by +count.</span></span><br><span class="line">    <span class="comment">// For the next hour, HourCount() will be larger by +count.</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the accumulated count over the past 60 seconds.</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the accumulated count over the past 3600 seconds.</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">HourCount</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>(Để ngắn gọn, chúng tôi sẽ bỏ lại comment này từ bây giờ)</p>
<blockquote class="colorquote success"><p><strong>GETTING AN OUTSIDE PERSPECTIVE</strong></p>
<p>Bạn đã nhận thấy rằng đã có 1 vài trường hợp chúng ta chạy các thứ bởi đồng nghiệp. Hỏi họ để có 1 vài quan điểm bên ngoài là cách tốt để kiểm tra xem code của bạn có “user-friendly” chưa. Cố gắng cởi mở với những ấn tượng đầu tiên của họ, vì những người khác có thể có thể đi đến kết luận tương tự. Và “người khác” ở đây có thể là chính bạn 6 tháng tới :D.</p>
</blockquote>
<h1 id="Attempt-1-A-Naive-Solution"><a href="#Attempt-1-A-Naive-Solution" class="headerlink" title="Attempt 1: A Naive Solution"></a>Attempt 1: A Naive Solution</h1><p>Tiếp tục giải quyết vấn đề. Chúng ta sẽ bắt đầu với 1 giải pháp đơn giản: chỉ giữ danh sách sự kiện thời gian:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Event</span> &#123;</span></span><br><span class="line">        Event(<span class="keyword">int</span> count, <span class="keyword">time_t</span> time) : count(count), time(time) &#123;&#125;</span><br><span class="line">        <span class="keyword">int</span> count;</span><br><span class="line">        <span class="keyword">time_t</span> time;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">list</span>&lt;Event&gt; events;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">            events.push_back(Event(count, time()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>Chúng tôi có thể đếm qua sự kiện gần đây nhất nếu cần:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">time_t</span> now_secs = time();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">list</span>&lt;Event&gt;::reverse_iterator i = events.rbegin();</span><br><span class="line">            i != events.rend() &amp;&amp; i-&gt;time &gt; now_secs - <span class="number">60</span>; ++i) &#123;</span><br><span class="line">            count += i-&gt;count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">HourCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">time_t</span> now_secs = time();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">list</span>&lt;Event&gt;::reverse_iterator i = events.rbegin();</span><br><span class="line">            i != events.rend() &amp;&amp; i-&gt;time &gt; now_secs - <span class="number">3600</span>; ++i) &#123;</span><br><span class="line">            count += i-&gt;count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h2 id="Is-the-Code-Easy-to-Understand"><a href="#Is-the-Code-Easy-to-Understand" class="headerlink" title="Is the Code Easy to Understand?"></a>Is the Code Easy to Understand?</h2><p>Mặc dù giải pháp là “đúng” nhưng có 1 vài vấn đề quanh việc đọc code:</p>
<ul>
<li>Vòng lặp for có 1 chút lắm mồm =)). Nhiều người đọc sẽ phải chậm lại đáng kể trong khi họ đang đọc phần này của code (ít nhất họ nên vậy, nếu họ chắc chắc rằng chỗ này không có 1 vài lỗi).</li>
<li><code>MinuteCount()</code> và <code>HourCount()</code>  gần như giống hệt. Bạn nên làm code nhỏ hơn nếu chúng bị lặp code. Chi tiết này cực kì quan trọng vì việc giảm thiểu code là tương đối phức tạp (Tốt hơn là có tất cả các code khó có giới hạn trong 1 chỗ).</li>
</ul>
<h2 id="An-Easier-to-Read-Version"><a href="#An-Easier-to-Read-Version" class="headerlink" title="An Easier-to-Read Version"></a>An Easier-to-Read Version</h2><p>Code của <code>MinuteCount()</code> và <code>HourCount()</code> giờ chỉ khác nhau hằng số (60 vs 3600). Tái cấu trúc mã rõ ràng, thêm helper để xử lý cả 2 trường hợp:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line">    <span class="built_in">list</span>&lt;Event&gt; events;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">CountSince</span><span class="params">(<span class="keyword">time_t</span> cutoff)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">list</span>&lt;Event&gt;::reverse_iterator rit = events.rbegin();</span><br><span class="line">            rit != events.rend(); ++rit) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rit-&gt;time &lt;= cutoff) &#123;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            count += rit-&gt;count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">            events.push_back(Event(count, time()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> CountSince(time() - <span class="number">60</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">HourCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> CountSince(time() - <span class="number">3600</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>Có 1 vài điểm đáng kể trong đoạn mã mới này.</p>
<p>Đầu tiên là <code>CountSince()</code> nhận vào 1 đối số <code>cutoff</code> tuyệt đối hơn là nhận vào 1 <code>secs_ago</code> tương đối với giá trị (60 hoặc 3600). Mặc dù cách này vẫn làm việc, nhưng cách này làm <code>CountSince()</code> có 1 công việc dễ dàng hơn 1 chút.</p>
<p>Thứ 2 là việc đặt tên vòng lặp từ <code>i</code> thành <code>rit</code>. Tên <code>i</code> thường được sử dụng cho chỉ số số nguyên. Chúng tôi suy ngẫm sử dụng tên <code>it</code>, là chung cho vòng lặp. Nhưng trường hợp này chúng tôi đang có 1 vòng lặp ngược lại và thực tế này quan trọng cho sự đúng đắn của code. Bằng cách có phần tiền tố tên biến với r, nó thêm 1 đối xứng thoải mái cho các câu lệnh kiểu <code>rit != events.rend()</code>.</p>
<p>Cuối cùng, chúng tôi trích xuất điều kiện <code>rit-&gt;time &lt;= cutoff</code> khỏi vòng lặp và làm nó tách biệt <code>if</code>. Tại sao? Bởi vì các vòng lặp “truyền thống” có dạng <code>for(begin; end; advance)</code> dễ đọc. Người đọc có thể hiểu ngay lập tức nó đang “đi qua tất cả các phần tử” và không nghĩ nhiều về nó.</p>
<h2 id="Performance-Problems"><a href="#Performance-Problems" class="headerlink" title="Performance Problems"></a>Performance Problems</h2><p>Mặc dù chúng ta đã cải thiện được thẩm mỹ của code, nhưng cách thiết kế này vẫn có 2 vấn đề về hiệu năng:</p>
<ol>
<li>Nó chỉ tiếp tục phát triển.</li>
</ol>
<p>Class này giữ toàn bộ sự kiện nó từng thấy - nó sử dụng 1 bộ nhớ không giới hạn. Lý tưởng, <code>MinuteHourCounter</code> nên tự động được xóa các sự kiện cái mà cũ hơn 1 giờ sau vì chúng không cần thiết nữa.</p>
<ol start="2">
<li><code>MinuteCount()</code> và <code>HourCount()</code> quá chậm.</li>
</ol>
<p>Phương thức CountSince() cần O(n) lần, với n là số điểm dữ liệu trong cửa sổ thời gian liên quan. Tưởng tượng rằng server hiệu năng cao gọi <code>Add()</code> hàng trăm lần mỗi giây. Mỗi lần gọi <code>HourCount()</code> sẽ phải đếm qua 1 triệu điểm. Về lý tưởng, <code>MinuteHourCounter</code> nên giữ biến <code>separate minute_count</code> và <code>hour_count</code>, định kì với mỗi lần gọi <code>Add()</code>.</p>
<h1 id="Attempt-2-Conveyor-Belt-Design"><a href="#Attempt-2-Conveyor-Belt-Design" class="headerlink" title="Attempt 2: Conveyor Belt Design"></a>Attempt 2: Conveyor Belt Design</h1><p>Chúng tôi cần thiết kế để giải quyết cả 2 vấn đề trên:</p>
<ol>
<li>Xóa dữ liệu không cần thiết</li>
<li>Luôn cập nhật <code>minute_count</code> và <code>hour_count</code></li>
</ol>
<p>Đây là cách mà chúng tôi sẽ làm: Chúng tôi sẽ sử dụng list như 1 băng chuyền. Khi data mới đến và 1 cái kết thúc, chúng tôi sẽ thêm vào tổng. Và khi dữ liệu quá cũ, nó đã “rơi ra” khỏi đầu kia và chúng tôi trừ đi tổng số của chúng tôi.</p>
<p>Có 1 vài cách chúng tôi có thể thực thi thiết kế dây chuyền này. Một cách là duy trì 2 danh sách độc lập, 1 cho past minute, 1 cho past hour. Khi 1 sự kiện mới đến, nó thêm 1 bản copy vào cả 2 danh sách.</p>
<img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/attempt2-1.png?raw=true" class="[]">
<p>Cách này khá đơn giản, nhưng nó không hiệu quả vì nó tạo ra 2 bản copy cho mỗi sự kiện.</p>
<p>Một cách khác để duy trì 2 lists nơi mà sự kiện được khởi tạo vào list đầu tiên (the “last minute events”) và sau đó sẽ cho ăn vào danh sách thứ 2 (the “last hour [nhưng không phải minute cuối cùng nhé] events”).</p>
<img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/attempt2-2.png?raw=true" class="[]">
<p>Thiết kế theo dây chuyển “2 giai đoạn” dường như hiệu quả hơn, do đó sẽ thực thi cái này.</p>
<h2 id="Implementing-the-Two-Stage-Conveyor-Belt-Design"><a href="#Implementing-the-Two-Stage-Conveyor-Belt-Design" class="headerlink" title="Implementing the Two-Stage Conveyor Belt Design"></a>Implementing the Two-Stage Conveyor Belt Design</h2><p>Hãy bắt đầu bằng cách liệt kê các thành phần của class:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line">    <span class="built_in">list</span>&lt;Event&gt; minute_events;</span><br><span class="line">    <span class="built_in">list</span>&lt;Event&gt; hour_events; <span class="comment">// only contains elements NOT in minute_events</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> minute_count;</span><br><span class="line">    <span class="keyword">int</span> hour_count; <span class="comment">// counts ALL events over past hour, including past minute</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>Điểm mấu chốt của thiết kế băng chuyền này là có thể  “dịch chuyển” các sự kiện khi thời gian trôi qua, do đó các sự kiện di chuyển từ <code>minute_events</code> tới <code>hour_events</code> và <code>minute_count</code> và <code>hour_count</code> nhận các cập nhật phù hợp. Để làm điều này, chúng ta sẽ tạo 1 phương thức helper tên là <code>ShiftOldEvents()</code>. Một khi chúng ta có phương thức này, phần còn lại của lớp này khá dễ thực thi:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">time_t</span> now_secs = time();</span><br><span class="line">    ShiftOldEvents(now_secs);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feed into the minute list (not into the hour list--that will happen later)</span></span><br><span class="line">    minute_events.push_back(Event(count, now_secs));</span><br><span class="line">    minute_count += count;</span><br><span class="line">    hour_count += count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ShiftOldEvents(time());</span><br><span class="line">    <span class="keyword">return</span> minute_count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">HourCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ShiftOldEvents(time());</span><br><span class="line">    <span class="keyword">return</span> hour_count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Rõ ràng, chúng ta đã trì hoãn được tất cả các công việc bẩn thỉu vào <code>ShiftOldEvents()</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Find and delete old events, and decrease hour_count and minute_count accordingly.</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShiftOldEvents</span><span class="params">(<span class="keyword">time_t</span> now_secs)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> minute_ago = now_secs - <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> hour_ago = now_secs - <span class="number">3600</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Move events more than one minute old from &#x27;minute_events&#x27; into &#x27;hour_events&#x27;</span></span><br><span class="line">    <span class="comment">// (Events older than one hour will be removed in the second loop.)</span></span><br><span class="line">    <span class="keyword">while</span> (!minute_events.empty() &amp;&amp; minute_events.front().time &lt;= minute_ago) &#123;</span><br><span class="line">        hour_events.push_back(minute_events.front());</span><br><span class="line"></span><br><span class="line">        minute_count -= minute_events.front().count;</span><br><span class="line">        minute_events.pop_front();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove events more than one hour old from &#x27;hour_events&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> (!hour_events.empty() &amp;&amp; hour_events.front().time &lt;= hour_ago) &#123;</span><br><span class="line">        hour_count -= hour_events.front().count;</span><br><span class="line">        hour_events.pop_front();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Are-We-Done"><a href="#Are-We-Done" class="headerlink" title="Are We Done?"></a>Are We Done?</h2><p>Chúng ta đã giải quyết 2 vấn đề liên quan đến hiệu năng, và giải pháp này đã hoạt động. Với nhiều ứng dụng, giải pháp này là đủ tốt. Nhưng vẫn có 1 số thiếu sót.</p>
<p>Đầu tiên, thiếu kế thì rất không linh hoạt. Giả sử bạn muốn tiếp tục đếm trong 24h qua. Điều này yêu cầu thay đổi nhiều trong code. Và như bạn có thể thấy <code>ShiftOldEvents()</code> là 1 hàm khá nặng, với sự tương tác tinh tế giữa dữ liệu phút và giờ.</p>
<p>Thứ 2, lớp này có 1 bộ nhớ khá lớn. Giả sử bạn có 1 server high-traffic gọi <code>Add()</code> 100 lần mỗi giây. Vì chúng ta giữ tất cả các dữ liệu trong 1h qua, đoạn code này sẽ kết thúc và yêu cầu tầm 5M bộ nhớ.</p>
<p>Nói chung, khi <code>Add()</code> thường xuyên được gọi, chúng ta sẽ cần nhiều bộ nhớ hơn. Trên môi trường sản phẩm, thư việc sử dụng bộ nhớ lớn, không thể đoán trước là không tốt. Lý tưởng, <code>MinuteHourCounter</code> sẽ sử dụng 1 lượng bộ nhớ nhất định mà không quan tâm hàm này được gọi bao nhiêu lần.</p>
<h1 id="Attempt-3-A-Time-Bucketed-Design"><a href="#Attempt-3-A-Time-Bucketed-Design" class="headerlink" title="Attempt 3: A Time-Bucketed Design"></a>Attempt 3: A Time-Bucketed Design</h1><p>Bạn có thể nhận thấy, cả 2 cách thực thi trên có 1 bug nhỏ. Chúng ta sử dụng <code>time_t</code> để lưu timestamp, cái mà lữu trữ số giây dưới dạng 1 số nguyên. Vì điều làm tròn này <code>MinuteCount()</code> thực sự trả về gì đó giữa 59 và 60 giây, dựa vào khi nào bạn gọi nó.</p>
<p>Ví dụ nếu 1 sự kiện diễn ra tạo <code>time = 0.99</code> giây, thời gian trả về được làm tròn là 0s. Và nếu bạn gọi <code>MinuteCount()</code> tại <code>time = 60.1</code> giây, nó sẽ trả về tổng các sự kiện có <code>t=1,2,3,...60</code>. Do đó sự kiện đầu tiên sẽ bị mất, mặc dù về mặt kĩ thuật đang chậm hơn 1 phút.</p>
<p>Trung bình, <code>MinuteCount()</code> sẽ trả về 59.5s giá trị của dữ liệu. Và <code>HourCount()</code> sẽ trả về 3599.5s giá trị dữ liệu (một lỗi không đáng kể).</p>
<p>Chúng ta có thể sửa lỗi này bằng cách sử dụng 1 thời gian với subsecond granularity. Nhưng một cách thú vị, đa số ứng dụng sử dụng 1 <code>MinuteHourCounter</code> không cần mức độ chính xác ở lần nhìn đầu tiên. Chúng ta sẽ khai thác sự thật này với 1 <code>MinuteHourCounter</code> mới, cái mà nhanh hơn nhiều mà sử dụng ít không gian hơn. Đó là sự đánh đổi độ chính xác cho hiệu năng sẽ rất xứng đáng.</p>
<p>Ỷ tưởng chính là <em>kết hợp</em> tất cả các sự kiện trong 1 cửa sổ nhỏ lại với nhau, và tóm tắt các sự kiện này với 1 tổng số duy nhất. Ví dụ các Sự kiện trong 1 phút qua có thể được thêm vào trong 60 xô rời rạc, độ rộng là 1 giây. Các sự kiện trong 1 giờ qua có thể được thêm vào 60 các xô rời rạc, độ rộng là 1 phút.</p>
<img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter15/attempt3.png?raw=true" class="[]">
<p>Sử dụng các xô như hình trên, phương thức <code>MinuteCount()</code> và <code>HourCount()</code> sẽ chính xác cho 1 phần trên 60, điều này là hợp lý.</p>
<p>Nếu cần nhiều độ chính xác hơn, nhiều buckets có thể được sử dụng để đổi lấy dung lượng bộ nhớ lớn hơn. Nhưng thứ quan trọng nhất các thiết kế này đã sửa được, sử dụng bộ nhớ đoán trước được.</p>
<h2 id="Implementing-the-Time-Bucketed-Design"><a href="#Implementing-the-Time-Bucketed-Design" class="headerlink" title="Implementing the Time-Bucketed Design"></a>Implementing the Time-Bucketed Design</h2><p>Thực thi theo các thiết kế này chỉ có 1 lớp sẽ tạo nhiều code phức tạp cái mà khó để nhớ. Thay vào đó, chúng tôi sẽ theo lời khuyên trong Chapter 11, One Task at a Time và tạo ra các lớp riêng biệt để xử lý các phần khác nhau của vấn đề.</p>
<p>Để bắt đầu, tạo 1 lớp tách biệt để đếm khoảng thời gian duy nhất (như giờ trước). Chúng tôi sẽ gọi nó là <code>TrailingBucketCounter</code>. Đây thực chất là 1 phiên bản chung của <code>MinuteHourCounter</code> xử lý chỉ 1 khoảng thời gian:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A class that keeps counts for the past N buckets of time.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrailingBucketCounter</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// Example: TrailingBucketCounter(30, 60) tracks the last 30 minute-buckets of time.</span></span><br><span class="line">        TrailingBucketCounter(<span class="keyword">int</span> num_buckets, <span class="keyword">int</span> secs_per_bucket);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count, <span class="keyword">time_t</span> now)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Return the total count over the last num_buckets worth of time</span></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">TrailingCount</span><span class="params">(<span class="keyword">time_t</span> now)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>Bạn có thể tự hỏi tại sao <code>Add()</code> và <code>TrailingCount()</code> yêu cầu thời gian hiện tại (time_t_now) như 1 đối số - Tại sao nó không chỉ đơn giản là tự gọi <code>current time()</code>.</p>
<p>Mặc dù có vẻ lạ, nhưng việc truyền thời gian hiện tại có một vài lợi ích. Đầu tiên, nó biến <code>TrailingBucketCounter</code> thành một lớp “không có đồng hồ”, nói chung là dễ kiểm tra hơn và ít có khả năng xảy ra lỗi hơn. Thứ hai, nó giữ tất cả các lệnh gọi đến <code>time()</code> bên trong <code>MinuteHourCounter</code>. Với các hệ thống nhạy cảm với thời gian, sẽ hữu ích nếu bạn có thể đặt tất cả các lệnh gọi để lấy thời gian ở một nơi.</p>
<p>Giả sử <code>TrailingBucketCounter</code> đã được triển khai, <code>MinuteHourCounter</code> rất dễ triển khai:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinuteHourCounter</span> &#123;</span></span><br><span class="line">    TrailingBucketCounter minute_counts;</span><br><span class="line">    TrailingBucketCounter hour_counts;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        MinuteHourCounter():</span><br><span class="line">        minute_counts( <span class="comment">/* num_buckets = */</span> <span class="number">60</span>, <span class="comment">/* secs_per_bucket = */</span> <span class="number">1</span>),</span><br><span class="line">        hour_counts( <span class="comment">/* num_buckets = */</span> <span class="number">60</span>, <span class="comment">/* secs_per_bucket = */</span> <span class="number">60</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">time_t</span> now = time();</span><br><span class="line">        minute_counts.Add(count, now);</span><br><span class="line">        hour_counts.Add(count, now);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">MinuteCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">time_t</span> now = time();</span><br><span class="line">        <span class="keyword">return</span> minute_counts.TrailingCount(now);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">HourCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">time_t</span> now = time();</span><br><span class="line">        <span class="keyword">return</span> hour_counts.TrailingCount(now);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>Mã này dễ đọc hơn nhiều và cũng linh hoạt hơn — nếu chúng ta muốn tăng số lượng buckets (để cải thiện độ chính xác nhưng tăng mức sử dụng bộ nhớ), điều đó sẽ dễ thực hiện.</p>
<h2 id="Implementing-TrailingBucketCounter"><a href="#Implementing-TrailingBucketCounter" class="headerlink" title="Implementing TrailingBucketCounter"></a>Implementing TrailingBucketCounter</h2><p>Bây giờ tất cả những gì còn lại là triển khai lớp <code>TrailingBucketCounter</code>. Một lần nữa, chúng ta sẽ tạo một lớp trợ giúp để phân tích vấn đề này sâu hơn nữa.</p>
<p>Chúng ta sẽ tạo một cấu trúc dữ liệu có tên là <code>ConveyorQueue</code> có nhiệm vụ xử lý các số đếm cơ bản và tổng số của chúng. Lớp <code>TrailingBucketCounter</code> có thể tập trung vào nhiệm vụ di chuyển <code>ConveyorQueue</code> theo thời gian đã trôi qua.</p>
<p>Sau đây là giao diện <code>ConveyorQueue</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A queue with a maximum number of slots, where old data &quot;falls off&quot; the end.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConveyorQueue</span> &#123;</span></span><br><span class="line">    ConveyorQueue(<span class="keyword">int</span> max_items);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Increment the value at the back of the queue. </span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddToBack</span><span class="params">(<span class="keyword">int</span> count)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Each value in the queue is shifted forward by &#x27;num_shifted&#x27;.</span></span><br><span class="line">    <span class="comment">// New items are initialized to 0.</span></span><br><span class="line">    <span class="comment">// Oldest items will be removed so there are &lt;= max_items.</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Shift</span><span class="params">(<span class="keyword">int</span> num_shifted)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return the total value of all items currently in the queue.</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">TotalSum</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>Giả sử lớp này đã được triển khai, hãy xem <code>TrailingBucketCounter</code> dễ triển khai như thế nào:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrailingBucketCounter</span> &#123;</span></span><br><span class="line">    ConveyorQueue buckets;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> secs_per_bucket;</span><br><span class="line">    <span class="keyword">time_t</span> last_update_time; <span class="comment">// the last time Update() was called</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate how many buckets of time have passed and Shift() accordingly.</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">time_t</span> now)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> current_bucket = now / secs_per_bucket;</span><br><span class="line">        <span class="keyword">int</span> last_update_bucket = last_update_time / secs_per_bucket;</span><br><span class="line"></span><br><span class="line">        buckets.Shift(current_bucket - last_update_bucket);</span><br><span class="line">        last_update_time = now;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        TrailingBucketCounter(<span class="keyword">int</span> num_buckets, <span class="keyword">int</span> secs_per_bucket):</span><br><span class="line">        buckets(num_buckets),</span><br><span class="line">        secs_per_bucket(secs_per_bucket) &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> count, <span class="keyword">time_t</span> now)</span> </span>&#123;</span><br><span class="line">            Update(now);</span><br><span class="line">            buckets.AddToBack(count);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">TrailingCount</span><span class="params">(<span class="keyword">time_t</span> now)</span> </span>&#123;</span><br><span class="line">            Update(now);</span><br><span class="line">            <span class="keyword">return</span> buckets.TotalSum();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>Sự phân chia này thành hai lớp (<code>TrailingBucketCounter</code> và <code>ConveyorQueue</code>) là một ví dụ khác về những gì chúng ta đã thảo luận trong Chương 11, Một tác vụ tại một thời điểm. Chúng ta cũng có thể thực hiện mà không cần <code>ConveyorQueue</code> và triển khai mọi thứ trực tiếp bên trong <code>TrailingBucketCounter</code>. Nhưng theo cách này, mã dễ hiểu hơn.</p>
<h2 id="Implementing-ConveyorQueue"><a href="#Implementing-ConveyorQueue" class="headerlink" title="Implementing ConveyorQueue"></a>Implementing ConveyorQueue</h2><p>Bây giờ tất cả những gì còn lại là triển khai lớp <code>ConveyorQueue</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A queue with a maximum number of slots, where old data gets shifted off the end.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConveyorQueue</span> &#123;</span></span><br><span class="line">    <span class="built_in">queue</span> &lt; <span class="keyword">int</span> &gt; q;</span><br><span class="line">    <span class="keyword">int</span> max_items;</span><br><span class="line">    <span class="keyword">int</span> total_sum; <span class="comment">// sum of all items in q</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        ConveyorQueue(<span class="keyword">int</span> max_items): max_items(max_items), total_sum(<span class="number">0</span>) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">TotalSum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> total_sum;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Shift</span><span class="params">(<span class="keyword">int</span> num_shifted)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// In case too many items shifted, just clear the queue. </span></span><br><span class="line">            <span class="keyword">if</span> (num_shifted &gt;= max_items) &#123;</span><br><span class="line">                q = <span class="built_in">queue</span> &lt; <span class="keyword">int</span> &gt; (); <span class="comment">// clear the queue</span></span><br><span class="line">                total_sum = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Push all the needed zeros.</span></span><br><span class="line">            <span class="keyword">while</span> (num_shifted &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                q.push(<span class="number">0</span>);</span><br><span class="line">                num_shifted--;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Let all the excess items fall off.</span></span><br><span class="line">            <span class="keyword">while</span> (q.size() &gt; max_items) &#123;</span><br><span class="line">                total_sum -= q.front();</span><br><span class="line">                q.pop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddToBack</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (q.empty()) Shift(<span class="number">1</span>); <span class="comment">// Make sure q has at least 1 item. q.back() += count;</span></span><br><span class="line">        total_sum += count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>Bây giờ chúng ta đã hoàn tất! Chúng ta có <code>MinuteHourCounter</code> nhanh và tiết kiệm bộ nhớ, cộng với <code>TrailingBucketCounter</code> linh hoạt hơn, dễ dàng tái sử dụng. Ví dụ, sẽ khá dễ dàng để tạo ra một <code>RecentCounter</code> linh hoạt hơn, có thể đếm nhiều khoảng thời gian, chẳng hạn như ngày cuối cùng hoặc mười phút cuối cùng.</p>
<h1 id="Comparing-the-Three-Solutions"><a href="#Comparing-the-Three-Solutions" class="headerlink" title="Comparing the Three Solutions"></a>Comparing the Three Solutions</h1><p>Hãy so sánh các giải pháp mà chúng ta đã xem xét trong chương này. Bảng sau đây hiển thị kích thước mã và số liệu thống kê hiệu suất (giả sử trường hợp sử dụng lưu lượng truy cập cao là 100 Add()/giây):</p>
<table>
<thead>
<tr>
<th>Solution</th>
<th>Lines of code</th>
<th>Cost per HourCount()</th>
<th>Memory use</th>
<th>Error in HourCount()</th>
</tr>
</thead>
<tbody>
<tr>
<td>Naive solution</td>
<td>33</td>
<td>O(#events-per-hour) (~3.6 million)</td>
<td>unbounded</td>
<td>1 part per 3600</td>
</tr>
<tr>
<td>Conveyor belt design</td>
<td>55</td>
<td>O(1)</td>
<td>O(#events-per-hour) (~5MB)</td>
<td>1 part per 3600</td>
</tr>
<tr>
<td>Time-bucketed design (60 buckets)</td>
<td>98</td>
<td>O(1)</td>
<td>O(#buckets) (~500 bytes)</td>
<td>1 part per 60</td>
</tr>
</tbody>
</table>
<p>Lưu ý rằng tổng lượng mã cho giải pháp ba lớp cuối cùng của chúng tôi nhiều hơn bất kỳ nỗ lực nào khác. Tuy nhiên, hiệu suất vượt trội hơn nhiều và thiết kế linh hoạt hơn. Ngoài ra, mỗi lớp riêng lẻ dễ đọc hơn nhiều. Đây luôn là một thay đổi tích cực: có 100 dòng dễ đọc sẽ tốt hơn 50 dòng không dễ đọc.</p>
<p>Đôi khi, việc chia một vấn đề thành nhiều lớp có thể tạo ra sự phức tạp giữa các lớp (điều mà giải pháp một lớp sẽ không có). Tuy nhiên, trong trường hợp này, có một chuỗi sử dụng “tuyến tính” đơn giản từ lớp này sang lớp khác và chỉ một trong các lớp được hiển thị cho người dùng cuối. Nhìn chung, những lợi ích của việc chia nhỏ vấn đề này khiến đây trở thành một chiến thắng.</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>Hãy cùng xem lại các bước chúng ta đã trải qua để có được thiết kế MinuteHourCounter cuối cùng. Quá trình này là điển hình cho cách các đoạn mã khác phát triển.</p>
<p>Đầu tiên, chúng tôi bắt đầu bằng cách mã hóa một giải pháp ngây thơ. Điều này giúp chúng tôi nhận ra hai thách thức về thiết kế: tốc độ và sử dụng bộ nhớ.</p>
<p>Tiếp theo, chúng tôi đã thử thiết kế “băng chuyền”. Thiết kế này đã cải thiện tốc độ và sử dụng bộ nhớ nhưng vẫn chưa đủ tốt cho các ứng dụng hiệu suất cao. Ngoài ra, thiết kế này rất không linh hoạt: việc điều chỉnh mã để xử lý các khoảng thời gian khác sẽ tốn rất nhiều công sức.</p>
<p>Thiết kế cuối cùng của chúng tôi đã giải quyết các vấn đề trước đó bằng cách chia nhỏ mọi thứ thành các bài toán con. Sau đây là ba lớp chúng tôi đã tạo, theo thứ tự từ dưới lên, và bài toán con mà mỗi lớp giải quyết:</p>
<p><code>ConveyorQueue</code></p>
<p>Một hàng đợi có độ dài tối đa có thể được “chuyển” và duy trì tổng số của nó.</p>
<p><code>TrailingBucketCounter</code></p>
<p>Di chuyển ConveyorQueue theo thời gian đã trôi qua và duy trì số lượng của một khoảng thời gian duy nhất (mới nhất), với độ chính xác nhất định.</p>
<p><code>MinuteHourCounter</code></p>
<p>Chỉ chứa hai <code>TrailingBucketCounter</code>, một cho số phút và một cho số giờ.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Chapter 15: Designing and Implementing a “Minute/Hour Counter”</p><p><a href="http://yoursite.com/2020/05/24/Chapter-15-Designing-and-Implementing-a-“Minute-Hour-Counter”/">http://yoursite.com/2020/05/24/Chapter-15-Designing-and-Implementing-a-“Minute-Hour-Counter”/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Ming</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-05-24</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-08-08</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/mingnv" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/05/29/Cau-hinh-virtual-host-apache2/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Cấu hình virtual host apache2</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/05/24/Chapter-14-Testing-and-Readability/"><span class="level-item">Chapter 14: Testing and Readability</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yoursite.com/2020/05/24/Chapter-15-Designing-and-Implementing-a-%E2%80%9CMinute-Hour-Counter%E2%80%9D/';
            this.page.identifier = '2020/05/24/Chapter-15-Designing-and-Implementing-a-“Minute-Hour-Counter”/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'minh' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/spidertocat.png" alt="Minh NV"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Minh NV</p><p class="is-size-6 is-block">_N.V.M_</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hanoi city, Vietnam</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">160</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">36</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">50</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/minhnv2306" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/minhnv2306"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/profile.php?id=100003860456359"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="http://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="http://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AWS-Developer-Associate/"><span class="level-start"><span class="level-item">AWS Developer Associate</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/AWS-Practitioner/"><span class="level-start"><span class="level-item">AWS Practitioner</span></span><span class="level-end"><span class="level-item tag">26</span></span></a></li><li><a class="level is-mobile" href="/categories/AWS-Training/"><span class="level-start"><span class="level-item">AWS Training</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Authentication/"><span class="level-start"><span class="level-item">Authentication</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-code/"><span class="level-start"><span class="level-item">Clean code</span></span><span class="level-end"><span class="level-item tag">16</span></span></a><ul><li><a class="level is-mobile" href="/categories/Clean-code/Clean-code-Robert-C-Martin/"><span class="level-start"><span class="level-item">Clean code - Robert C. Martin</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-code/Refactoring-to-Collections/"><span class="level-start"><span class="level-item">Refactoring to Collections</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/MongoDB/"><span class="level-start"><span class="level-item">MongoDB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/"><span class="level-start"><span class="level-item">Development and Operation</span></span><span class="level-end"><span class="level-item tag">33</span></span></a><ul><li><a class="level is-mobile" href="/categories/Development-and-Operation/CircleCI-2-0/"><span class="level-start"><span class="level-item">CircleCI 2.0</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Google-Cloud-Platform/"><span class="level-start"><span class="level-item">Google Cloud Platform</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Laravel/"><span class="level-start"><span class="level-item">Laravel</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Linux-OS/"><span class="level-start"><span class="level-item">Linux OS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Web-Server/"><span class="level-start"><span class="level-item">Web Server</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/JP/"><span class="level-start"><span class="level-item">JP</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/"><span class="level-start"><span class="level-item">JavaScript</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/JavaScript/Asynchronous/"><span class="level-start"><span class="level-item">Asynchronous</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/Event/"><span class="level-start"><span class="level-item">Event</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/React/"><span class="level-start"><span class="level-item">React</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">15</span></span></a><ul><li><a class="level is-mobile" href="/categories/Others/Cong-cu-lap-trinh/"><span class="level-start"><span class="level-item">Công cụ lập trình</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/PHPCS/"><span class="level-start"><span class="level-item">PHPCS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Suu-tam/"><span class="level-start"><span class="level-item">Sưu tầm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Website-Optimization/"><span class="level-start"><span class="level-item">Website Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Snippets-code/"><span class="level-start"><span class="level-item">Snippets code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Special-day/"><span class="level-start"><span class="level-item">Special day</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/"><span class="level-start"><span class="level-item">The Art of Readable Code</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Chapter-1-Code-Should-Be-Easy-to-Understand/"><span class="level-start"><span class="level-item">Chapter 1 - Code Should Be Easy to Understand</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-I-Surface-Level-Improvements/"><span class="level-start"><span class="level-item">Part I - Surface-Level Improvements</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-II-Simplifying-Loops-and-Logic/"><span class="level-start"><span class="level-item">Part II - Simplifying Loops and Logic</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-III-Reorganizing-Your-Code/"><span class="level-start"><span class="level-item">Part III - Reorganizing Your Code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-IV-Selected-Topics/"><span class="level-start"><span class="level-item">Part IV - Selected Topics</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Unit-Test/"><span class="level-start"><span class="level-item">Unit Test</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/API/"><span class="tag">API</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CI-CD/"><span class="tag">CI/CD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kanji/"><span class="tag">Kanji</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-command-line/"><span class="tag">Linux command line</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache2/"><span class="tag">apache2</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/async-programing/"><span class="tag">async programing</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/authentication/"><span class="tag">authentication</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-exam-preparation/"><span class="tag">aws exam preparation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-labs/"><span class="tag">aws labs</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-certificate/"><span class="tag">aws-certificate</span><span class="tag">44</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-comment/"><span class="tag">clean comment</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-error/"><span class="tag">clean error</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-function/"><span class="tag">clean function</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/collection/"><span class="tag">collection</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/configuration/"><span class="tag">configuration</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-command/"><span class="tag">docker command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-file-format/"><span class="tag">docker compose file format</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-best-practice/"><span class="tag">docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-yml/"><span class="tag">docker-compose.yml</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-instructions-docker-best-practice/"><span class="tag">docker-instructions docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-network/"><span class="tag">docker-network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-volume/"><span class="tag">docker-volume</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event/"><span class="tag">event</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event-notification/"><span class="tag">event notification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/excelfile/"><span class="tag">excelfile</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gcp/"><span class="tag">gcp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jquery-validation/"><span class="tag">jquery-validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubernetes/"><span class="tag">kubernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel/"><span class="tag">laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongoDB/"><span class="tag">mongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/naming/"><span class="tag">naming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/note-choi-choi/"><span class="tag">note choi choi</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs/"><span class="tag">phpcs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs-phpcsfixer/"><span class="tag">phpcs phpcsfixer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/process-management/"><span class="tag">process management</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-boilerplate/"><span class="tag">react boilerplate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/requests/"><span class="tag">requests</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/snippets-code/"><span class="tag">snippets-code</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stripe/"><span class="tag">stripe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sudo-command/"><span class="tag">sudo command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tips-laravel/"><span class="tag">tips laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tracking-php-script/"><span class="tag">tracking php script</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unit-test/"><span class="tag">unit test</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/validation/"><span class="tag">validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vba/"><span class="tag">vba</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vim/"><span class="tag">vim</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#The-Problem"><span class="level-left"><span class="level-item">1</span><span class="level-item">The Problem</span></span></a></li><li><a class="level is-mobile" href="#Defining-the-Class-Interface"><span class="level-left"><span class="level-item">2</span><span class="level-item">Defining the Class Interface</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Improving-the-Names"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Improving the Names</span></span></a></li><li><a class="level is-mobile" href="#Improving-the-Comments"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Improving the Comments</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Attempt-1-A-Naive-Solution"><span class="level-left"><span class="level-item">3</span><span class="level-item">Attempt 1: A Naive Solution</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Is-the-Code-Easy-to-Understand"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Is the Code Easy to Understand?</span></span></a></li><li><a class="level is-mobile" href="#An-Easier-to-Read-Version"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">An Easier-to-Read Version</span></span></a></li><li><a class="level is-mobile" href="#Performance-Problems"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Performance Problems</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Attempt-2-Conveyor-Belt-Design"><span class="level-left"><span class="level-item">4</span><span class="level-item">Attempt 2: Conveyor Belt Design</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Implementing-the-Two-Stage-Conveyor-Belt-Design"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">Implementing the Two-Stage Conveyor Belt Design</span></span></a></li><li><a class="level is-mobile" href="#Are-We-Done"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">Are We Done?</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Attempt-3-A-Time-Bucketed-Design"><span class="level-left"><span class="level-item">5</span><span class="level-item">Attempt 3: A Time-Bucketed Design</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Implementing-the-Time-Bucketed-Design"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">Implementing the Time-Bucketed Design</span></span></a></li><li><a class="level is-mobile" href="#Implementing-TrailingBucketCounter"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">Implementing TrailingBucketCounter</span></span></a></li><li><a class="level is-mobile" href="#Implementing-ConveyorQueue"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">Implementing ConveyorQueue</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Comparing-the-Three-Solutions"><span class="level-left"><span class="level-item">6</span><span class="level-item">Comparing the Three Solutions</span></span></a></li><li><a class="level is-mobile" href="#Summary"><span class="level-left"><span class="level-item">7</span><span class="level-item">Summary</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T14:55:03.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Clean-code-Chapter-11-System/">[Clean code] Chapter 11: System</a></p><p class="categories"><a href="/categories/Clean-code/">Clean code</a> / <a href="/categories/Clean-code/Clean-code-Robert-C-Martin/">Clean code - Robert C. Martin</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T14:01:21.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Blog-for-me/">Blog for me</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T13:46:55.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Tips-2-PHP-Snippets-code/">Tips 2: PHP Snippets code</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-23T15:42:35.000Z">2024-08-23</time></p><p class="title"><a href="/2024/08/23/Tips-Laravel-Snippets-code/">Tips 1: Laravel Snippets code</a></p><p class="categories"><a href="/categories/Snippets-code/">Snippets code</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-17T15:41:26.000Z">2024-08-17</time></p><p class="title"><a href="/2024/08/17/Clean-code-Chapter-10-Class/">[Clean code] Chapter 10: Class</a></p><p class="categories"><a href="/categories/Clean-code/">Clean code</a> / <a href="/categories/Clean-code/Clean-code-Robert-C-Martin/">Clean code - Robert C. Martin</a></p></div></article></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://blog.zhangruipeng.me/hexo-theme-icarus/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus blog</span></span><span class="level-right"><span class="level-item tag">blog.zhangruipeng.me</span></span></a></li><li><a class="level is-mobile" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus github</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://octodex.github.com/images/privateinvestocat.jpg" alt="Hello, I am Minh" height="28"></a><p class="is-size-7"><span>&copy; 2024 Ming</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>