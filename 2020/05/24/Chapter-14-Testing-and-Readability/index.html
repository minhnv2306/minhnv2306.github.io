<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Chapter 14: Testing and Readability - Hello, I am Minh</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hello, I am Minh"><meta name="msapplication-TileImage" content="/img/my_favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hello, I am Minh"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Trong chương này, chúng tôi sẽ chỉ cho bạn một số kĩ thuật đơn giản để viết các test sạch sẽ và hiệu quả. Testing định nghĩa khác nhau với những người khác nhau. Trong chương này, chúng tôi sử dụng “t"><meta property="og:type" content="blog"><meta property="og:title" content="Chapter 14: Testing and Readability"><meta property="og:url" content="http://yoursite.com/2020/05/24/Chapter-14-Testing-and-Readability/"><meta property="og:site_name" content="Hello, I am Minh"><meta property="og:description" content="Trong chương này, chúng tôi sẽ chỉ cho bạn một số kĩ thuật đơn giản để viết các test sạch sẽ và hiệu quả. Testing định nghĩa khác nhau với những người khác nhau. Trong chương này, chúng tôi sử dụng “t"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter14/introduction.png?raw=true"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter14/marking_error_msg.png?raw=true"><meta property="og:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter14/large_smasher_test.png?raw=true"><meta property="article:published_time" content="2020-05-24T15:31:44.000Z"><meta property="article:modified_time" content="2024-08-08T03:51:32.235Z"><meta property="article:author" content="Ming"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter14/introduction.png?raw=true"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/05/24/Chapter-14-Testing-and-Readability/"},"headline":"Chapter 14: Testing and Readability","image":[],"datePublished":"2020-05-24T15:31:44.000Z","dateModified":"2024-08-08T03:51:32.235Z","author":{"@type":"Person","name":"Ming"},"description":"Trong chương này, chúng tôi sẽ chỉ cho bạn một số kĩ thuật đơn giản để viết các test sạch sẽ và hiệu quả. Testing định nghĩa khác nhau với những người khác nhau. Trong chương này, chúng tôi sử dụng “t"}</script><link rel="canonical" href="http://yoursite.com/2020/05/24/Chapter-14-Testing-and-Readability/"><link rel="icon" href="/img/my_favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-112002191-2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-112002191-2');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://octodex.github.com/images/privateinvestocat.jpg" alt="Hello, I am Minh" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-05-24T15:31:44.000Z" title="5/24/2020, 10:31:44 PM">2020-05-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-08-08T03:51:32.235Z" title="8/8/2024, 10:51:32 AM">2024-08-08</time></span><span class="level-item"><a class="link-muted" href="/categories/The-Art-of-Readable-Code/">The Art of Readable Code</a><span> / </span><a class="link-muted" href="/categories/Unit-Test/">Unit Test</a></span><span class="level-item">an hour read (About 8118 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">Chapter 14: Testing and Readability</h1><div class="content"><p>Trong chương này, chúng tôi sẽ chỉ cho bạn một số kĩ thuật đơn giản để viết các test sạch sẽ và hiệu quả.</p>
<p>Testing định nghĩa khác nhau với những người khác nhau. Trong chương này, chúng tôi sử dụng “test” có nghĩa là <em>một vài</em> code mà mục đích duy nhất của nó là kiểm tra hành vi của 1 phần (“real”) của code khác. Chúng tôi sẽ tập trung vào việc khía cạnh khả năng đọc của test và không nói sâu bạn nên viết test code trước khi viết code thực sự (“test-driven development”) hoặc khái cạnh về sự phát triển của test.<br><span id="more"></span></p>
<img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter14/introduction.png?raw=true" class="[]">
<blockquote class="colorquote danger"><p>“Real” code vs “test” code :D</p>
</blockquote>
<h1 id="Make-Tests-Easy-to-Read-and-Maintain"><a href="#Make-Tests-Easy-to-Read-and-Maintain" class="headerlink" title="Make Tests Easy to Read and Maintain"></a>Make Tests Easy to Read and Maintain</h1><p>Nó có vai trò quan trọng như viết code thực sự. Các coders khác sẽ thường nhìn các test code như các dạng tài liệu không chính thức của cách real code làm việc và nên được sử dụng. Do đó, các test dễ đọc, người dùng sẽ dễ hiểu hơn hành vi thực sự của code.</p>
<blockquote class="colorquote success"><p><strong>K E Y I D E A</strong><br>Test code should be readable so that other coders are comfortable changing or adding tests.</p>
</blockquote>
<p>Khi test code lớn và đáng sợ, đây là 1 vài thứ sẽ xảy ra:</p>
<ul>
<li><strong>Coders ngại sửa đổi real code</strong>. <em>Oh, chúng tôi không muốn làm bẩn đoạn code này - cập nhất tất cả các test sẽ là 1 cơn ác mộng!</em></li>
<li><strong>Coders không muốn thêm các new tests</strong> khi họ thêm code mới. Và theo thời gian, càng ngày các ít module của bạn được test và bạn không còn tự tin với mọi việc.</li>
</ul>
<p>Thay vì đó, bạn muốn khuyến khích ai đó (trừ bạn) làm việc với code được thoải mái với test code. Chúng nên có thể đọc và chẩn đoán được tại sao có 1 sự thay đổi khác với test đã tồn tại và cảm giác như thêm các tests mới là việc dễ dàng.</p>
<h1 id="What’s-Wrong-with-This-Test"><a href="#What’s-Wrong-with-This-Test" class="headerlink" title="What’s Wrong with This Test?"></a>What’s Wrong with This Test?</h1><p>Trong codebase của chúng tôi, chúng tôi có 1 hàm sắp xếp và lọc danh sách kết quả tìm kiếm đã được ghi lại. Đây là khai báo hàm:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Sort &#x27;docs&#x27; by score (highest first) and remove negative-scored documents.</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SortAndFilterDocs</span><span class="params">(<span class="built_in">vector</span>&lt;ScoredDocument&gt;* docs)</span></span>;</span><br></pre></td></tr></table></figure><br>Đoạn code Test hàm này sẽ như sau:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ScoredDocument&gt; docs;</span><br><span class="line">    docs.resize(<span class="number">5</span>);</span><br><span class="line">    docs[<span class="number">0</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">0</span>].score = <span class="number">-5.0</span>;</span><br><span class="line">    docs[<span class="number">1</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">1</span>].score = <span class="number">1</span>;</span><br><span class="line">    docs[<span class="number">2</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">2</span>].score = <span class="number">4</span>;</span><br><span class="line">    docs[<span class="number">3</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">3</span>].score = <span class="number">-99998.7</span>;</span><br><span class="line">    docs[<span class="number">4</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">4</span>].score = <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line">    SortAndFilterDocs(&amp;docs);</span><br><span class="line"></span><br><span class="line">    assert(docs.size() == <span class="number">3</span>);</span><br><span class="line">    assert(docs[<span class="number">0</span>].score == <span class="number">4</span>);</span><br><span class="line">    assert(docs[<span class="number">1</span>].score == <span class="number">3.0</span>);</span><br><span class="line">    assert(docs[<span class="number">2</span>].score == <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Có ít nhất <em>8</em> vấn đề khác nhau trong đoạn test code này. Trong phần cuối của chương, bạn sẽ có thể tìm và sửa chúng</p>
<h1 id="Making-This-Test-More-Readable"><a href="#Making-This-Test-More-Readable" class="headerlink" title="Making This Test More Readable"></a>Making This Test More Readable</h1><p>Như là 1 nguyên tắc chung thiết kế, bạn nên <strong>ẩn những chi tiết ít quan trọng từ người dùng, để những phần chi tiết quan trọng nổi bật lên</strong>.</p>
<p>Đoạn test code từ phần trước rõ ràng vi phạm nguyên tắc này. Mỗi phần chi tiết của test ở ngay phía trước và trung tâm là các chi tiết vụn vặt không quan trọng setting cho <code>vector&lt;ScoredDocument&gt;</code>. Đa số đoạn code trong ví dụ liên quan đến <code>url</code>, <code>score</code>, và <code>docs[]</code> cái mà chỉ nói chi tiết một object trong C++ được thiết lập như thế nào mà không nói về test này đang làm gì ở mức level cao.</p>
<p>Do đó, bước đầu tiên để loại bỏ điều này, bạn nên tạo 1 helper như sau:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MakeScoredDoc</span><span class="params">(ScoredDocument* sd, <span class="keyword">double</span> score, <span class="built_in">string</span> url)</span> </span>&#123;</span><br><span class="line">    sd-&gt;score = score;</span><br><span class="line">    sd-&gt;url = url;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Sử dụng hàm này, test code của chúng ta trở nên gọn hơn 1 chút:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ScoredDocument&gt; docs;</span><br><span class="line">    docs.resize(<span class="number">5</span>);</span><br><span class="line">    MakeScoredDoc(&amp;docs[<span class="number">0</span>], <span class="number">-5.0</span>, <span class="string">&quot;http://example.com&quot;</span>);</span><br><span class="line">    MakeScoredDoc(&amp;docs[<span class="number">1</span>], <span class="number">1</span>, <span class="string">&quot;http://example.com&quot;</span>);</span><br><span class="line">    MakeScoredDoc(&amp;docs[<span class="number">2</span>], <span class="number">4</span>, <span class="string">&quot;http://example.com&quot;</span>);</span><br><span class="line">    MakeScoredDoc(&amp;docs[<span class="number">3</span>], <span class="number">-99998.7</span>, <span class="string">&quot;http://example.com&quot;</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Nhưng nó vẫn chưa đủ tốt - vẫn còn nhiều chi tiết không quan trọng. Ví dụ, đối số <code>http://example.com</code>. Nó luôn luôn giống nhau và URL chính xác như vậy không quan trọng - nó chỉ nên là các giá trị điền vào <code>ScoredDocument</code>.</p>
<p>Một thứ không quan trọng khác chúng ta buộc phải xem xét là <code>docs.resize(5)</code> và <code>&amp;docs[0], &amp;docs[1],...</code>. Hãy thay đổi hepler để làm nhiều việc hơn, và gọi là <code>AddScoredDoc()</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddScoredDoc</span><span class="params">(<span class="built_in">vector</span>&lt;ScoredDocument&gt;&amp; docs, <span class="keyword">double</span> score)</span> </span>&#123;</span><br><span class="line">    ScoredDocument sd;</span><br><span class="line">    sd.score = score;</span><br><span class="line">    sd.url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs.push_back(sd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Sử dụng hàm này, test code của chúng ta thậm chí gọn hơn:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ScoredDocument&gt; docs;</span><br><span class="line">    AddScoredDoc(docs, <span class="number">-5.0</span>);</span><br><span class="line">    AddScoredDoc(docs, <span class="number">1</span>);</span><br><span class="line">    AddScoredDoc(docs, <span class="number">4</span>);</span><br><span class="line">    AddScoredDoc(docs, <span class="number">-99998.7</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Đoạn code đã tốt hơn nhưng vẫn không đáp ứng yêu cầu vào về khả năng đọc và viết test. Nếu bạn muốn thêm test khác với 1 tập các tài liệu ghi điểm, nó yêu cầu rất nhiều copy và paste. Liệu chúng ta có thể cải thiện vấn đề này?</p>
<h2 id="Creating-the-Minimal-Test-Statement"><a href="#Creating-the-Minimal-Test-Statement" class="headerlink" title="Creating the Minimal Test Statement"></a>Creating the Minimal Test Statement</h2><p>Để cải thiện vấn đề test code này, hãy sử dụng kĩ thuật từ Chapter 12, Turning Thoughts into Code.. Hãy mô tả cái mà test của chúng ta đang cố làm bằng tiếng Anh:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">We have a list of documents whose scores are [-5, 1, 4, -99998.7, 3]. After</span><br><span class="line">SortAndFilterDocs(), the remaining documents should have scores of [4, 3, 1], in that order.</span><br></pre></td></tr></table></figure><br>Như bạn có thể thấy, không 1 chỗ nào trong mô tả này chúng ta nhắc đến <code>vector&lt;ScoredDocument&gt;</code>. Mảng của điểm không quan trọng ở đây. Về ý tưởng, test code của chúng ta sẽ như sau:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;-5, 1, 4, -99998.7, 3&quot;</span>, <span class="string">&quot;4, 3, 1&quot;</span>);</span><br></pre></td></tr></table></figure><br>Chúng tôi có thể làm nổi bật lên vấn đề của test này xuống 1 dòng code!</p>
<p>Điều này không hiếm. Bản chất của hầu hết các test là làm nổi lên <em>đối với input/trường hợp này, mong chờ hành vi/ouput này</em>. Và nhiều lần, mục đích này có thể mô tả chỉ trong 1 dòng. Thêm vào đó copy rất ngắn gọn và dễ đọc, giữ các test của bạn ngắn và thực sự rất dễ dàng để thêm nhiều test cases.</p>
<h2 id="Implementing-Custom-“Minilanguages”"><a href="#Implementing-Custom-“Minilanguages”" class="headerlink" title="Implementing Custom “Minilanguages”"></a>Implementing Custom “Minilanguages”</h2><p>Nhận thấy rằng <code>CheckScoresBeforeAfter()</code> nhận vào 1 đối số chuỗi mô tả mảng các điểm. Trong các phiên bản gần nhất của C++, bạn có thể truyền mảng như sau:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(&#123;-5, 1, 4, -99998.7, 3&#125;, &#123;4, 3, 1&#125;);</span><br></pre></td></tr></table></figure><br>Vì chúng tôi không làm điều đó ở thời điểm hiện tại, chúng tôi đặt điểm số trong 1 chuỗi, phân tách bằng dấu phẩy. Với cách làm này <code>CheckScoresBeforeAfter()</code> cần phải phân tích đối số chuỗi này.</p>
<p>Nói chung, việc xác định một ngôn ngữ tùy chỉnh có thể là một cách mạnh mẽ để thể hiện nhiều thông tin trong một khoảng trống nhỏ. Các ví dụ khác bao gồm <code>printf()</code> và các thư viện biểu thức chính quy.</p>
<p>Trong trường hợp này, viết 1 vài helper để phân tích danh sách số phân tách bằng dấu phẩy không quá khó. Hàm <code>CheckScoresBeforeAfter()</code> sẽ như sau:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CheckScoresBeforeAfter</span><span class="params">(<span class="built_in">string</span> input, <span class="built_in">string</span> expected_output)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ScoredDocument&gt; docs = ScoredDocsFromString(input);</span><br><span class="line">    SortAndFilterDocs(&amp;docs);</span><br><span class="line">    <span class="built_in">string</span> output = ScoredDocsToString(docs);</span><br><span class="line">    assert(output == expected_output);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Và để cho đầy đủ, đây là hepler chuyển đổi giữa string và <code>vector&lt;ScoredDocument&gt;</code><br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">vector</span>&lt;ScoredDocument&gt; <span class="title">ScoredDocsFromString</span><span class="params">(<span class="built_in">string</span> scores)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ScoredDocument&gt; docs;</span><br><span class="line"></span><br><span class="line">    replace(scores.begin(), scores.end(), <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Populate &#x27;docs&#x27; from a string of space-separated scores.</span></span><br><span class="line">    <span class="function"><span class="built_in">istringstream</span> <span class="title">stream</span><span class="params">(scores)</span></span>;</span><br><span class="line">    <span class="keyword">double</span> score;</span><br><span class="line">    <span class="keyword">while</span> (stream &gt;&gt; score) &#123;</span><br><span class="line">        AddScoredDoc(docs, score);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> docs;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">ScoredDocsToString</span><span class="params">(<span class="built_in">vector</span>&lt;ScoredDocument&gt; docs)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">ostringstream</span> stream;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; docs.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span>) stream &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">        stream &lt;&lt; docs[i].score;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> stream.str();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Dường như có nhiều code trong lần nhìn đầu tiên, nhưng những gì nó làm cho bạn và vô cùng mạnh mẽ. Vì bạn có thể viết toàn bộ test chỉ với 1 lời gọi <code>CheckScoresBeforeAfter()</code>, bạn sẽ có xu hướng thêm được nhiều test hơn (như chúng tôi sẽ làm trong phần sau của chương này).</p>
<h1 id="Making-Error-Messages-Readable"><a href="#Making-Error-Messages-Readable" class="headerlink" title="Making Error Messages Readable"></a>Making Error Messages Readable</h1><img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter14/marking_error_msg.png?raw=true" class="[]">
<p>Đoạn code trước đẹp rồi, nhưng vẫn còn vấn đề ở chỗ <code>assert(output == expected_output)</code> lỗi? Nó sẽ đưa ra thông báo lỗi như sau:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Assertion failed: (output == expected_output),</span><br><span class="line">    function CheckScoresBeforeAfter, file test.cc, line <span class="number">37.</span></span><br></pre></td></tr></table></figure><br>Chắc chắn, nếu bạn nhìn thấy lỗi này, bạn sẽ tự hỏi, <em>Giá trị của ouput và expected_output là gì</em>?</p>
<h2 id="Using-Better-Versions-of-assert"><a href="#Using-Better-Versions-of-assert" class="headerlink" title="Using Better Versions of assert()"></a>Using Better Versions of assert()</h2><p>May mắn thay, đa số các ngôn ngữ và thư viện đều có phiên bản “tinh vi” hơn của hàm <code>assert()</code> bạn có thể dùng. Thay vì viết:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(output == expected_output);</span><br></pre></td></tr></table></figure><br>bạn có thể sử dụng thư viện Boost C++:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BOOST_REQUIRE_EQUAL(output, expected_output)</span><br></pre></td></tr></table></figure><br>Bây giờ, nếu test lỗi, bạn sẽ nhận được 1 thông báo chi tiết như sau:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test.cc(<span class="number">37</span>): fatal error in <span class="string">&quot;CheckScoresBeforeAfter&quot;</span>: critical check</span><br><span class="line">    output == expected_output failed [<span class="string">&quot;1, 3, 4&quot;</span> != <span class="string">&quot;4, 3, 1&quot;</span>]</span><br></pre></td></tr></table></figure><br>với nhiều thông tin hữu ích hơn.</p>
<p>Bạn nên sử dụng các phương thức hữu ích này để assert() khi chúng khả dụng. Nó sẽ trả về cho bạn mỗi test khi lỗi.</p>
<blockquote class="colorquote info"><p><strong>BETTER ASSERT() IN OTHER LANGUAGES</strong><br>Trong Python, built-in <code>assert a == b</code> sẽ tạo ra lỗi thông báo như:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File <span class="string">&quot;file.py&quot;</span>, line X, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="keyword">assert</span> a == b</span><br><span class="line">AssertionError</span><br></pre></td></tr></table></figure><br>Thay vào đó bạn có thể sử dụng phương thức <code>assertEqual()</code> trong module <code>unittest</code>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestCase</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">testFunction</span>(<span class="params">self</span>):</span></span><br><span class="line">        a = <span class="number">1</span></span><br><span class="line">        b = <span class="number">2</span></span><br><span class="line">        self.assertEqual(a, b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    unittest.main()</span><br></pre></td></tr></table></figure><br>Sẽ tạo ra thông báo lỗi như:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File <span class="string">&quot;MyTestCase.py&quot;</span>, line <span class="number">7</span>, <span class="keyword">in</span> testFunction</span><br><span class="line">    self.assertEqual(a, b)</span><br><span class="line">AssertionError: <span class="number">1</span> != <span class="number">2</span></span><br></pre></td></tr></table></figure><br>Với mỗi ngôn ngữ bạn đang sử dụng, có thể có các library/framework (ví dụ XUnit) có thể giúp bạn. It pays to know your libraries</p>
</blockquote>
<h2 id="Hand-Crafted-Error-Messages"><a href="#Hand-Crafted-Error-Messages" class="headerlink" title="Hand-Crafted Error Messages"></a>Hand-Crafted Error Messages</h2><p>Sử dụng <code>BOOST_REQUIRE_EQUAL()</code>, bạn có thể nhận được thông báo lỗi đẹp hơn:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">output == expected_output failed [<span class="string">&quot;1, 3, 4&quot;</span> != <span class="string">&quot;4, 3, 1&quot;</span>]</span><br></pre></td></tr></table></figure><br>Tuy nhiên thông báo này vẫn có thể được cải thiện. Ví dụ, sẽ hữu ích hơn khi nhìn thấy input gốc cái mà đang nhận lỗi. Ý tưởng thì thông báo lỗi sẽ là cái gì đó như:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter() failed,</span><br><span class="line">    Input:           <span class="string">&quot;-5, 1, 4, -99998.7, 3&quot;</span></span><br><span class="line">    Expected Output: <span class="string">&quot;4, 3, 1&quot;</span></span><br><span class="line">    Actual Output:   <span class="string">&quot;1, 3, 4&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>Nếu đó là thứ mà bạn muốn, thử viết nó thôi!<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CheckScoresBeforeAfter</span><span class="params">(...)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> (output != expected_output) &#123;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;CheckScoresBeforeAfter() failed,&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Input:				\&quot;&quot;</span> &lt;&lt; input &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Expected Output: 	\&quot;&quot;</span> &lt;&lt; expected_output &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Actual Output: 	\&quot;&quot;</span> &lt;&lt; output &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">abort</span>();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>Về mặt tâm lý, các thông báo lỗi nên hữu ích nhất có thể. Đôi khi, hiển thị các thông báo bằng cách xây dựng lại 1 “custom assert” là cách tốt nhất để làm việc này.</p>
<h1 id="Choosing-Good-Test-Inputs"><a href="#Choosing-Good-Test-Inputs" class="headerlink" title="Choosing Good Test Inputs"></a>Choosing Good Test Inputs</h1><p>Có 1 nghệ thuật chọn giá trị cho các đầu vào tốt đối với các test của bạn. Những cái chúng ta có ngay bây giờ có vẻ hơi khó hiểu:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;-5, 1, 4, -99998.7, 3&quot;</span>, <span class="string">&quot;4, 3, 1&quot;</span>);</span><br></pre></td></tr></table></figure></p>
<p>Làm sao để chúng ta chọn các giá trị đầu vào tốt? Các good inputs nên test triệt để được code. Nhưng chúng cũng nên đơn giản để dễ đọc.</p>
<blockquote class="colorquote success"><p><strong>KEY IDEA</strong><br>In general, you should pick the simplest set of inputs that completely exercise the code.</p>
</blockquote>
<p>Ví dụ, giả định bạn vừa mới viết:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;1, 2, 3&quot;</span>, <span class="string">&quot;3, 2, 1&quot;</span>);</span><br></pre></td></tr></table></figure><br>Mặc dù test này đơn giản, nó không test hành vi “lọc các điểm số âm” của hàm <code>SortAndFilterDocs()</code>. Nếu có 1 bug trong phần này của code, input này không kích hoạt nó.</p>
<p>Ở 1 chiều hướng khác, giả định bạn viết test như:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;123014, -1082342, 823423, 234205, -235235&quot;</span>,</span><br><span class="line">					<span class="string">&quot;823423, 234205, 123014&quot;</span>);</span><br></pre></td></tr></table></figure><br>Các giá trị này phức tạp không cần thiết. (Và chúng thậm chí không kiểm tra kĩ được code)</p>
<h2 id="Simplifying-the-Input-Values"><a href="#Simplifying-the-Input-Values" class="headerlink" title="Simplifying the Input Values"></a>Simplifying the Input Values</h2><p>Vậy chúng ta có thể cải thiện input này với giá trị nào?<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;-5, 1, 4, -99998.7, 3&quot;</span>, <span class="string">&quot;4, 3, 1&quot;</span>);</span><br></pre></td></tr></table></figure><br>Well, thứ đầu tiên bạn có thể nhận thấy là giá trị rất “ồn ào” -99998.7. Giá trị này chỉ có nghĩa “một vài số âm” do đó để đơn giản, nó nên chỉ là -1 (Nếu -99998.7 thì nên có nghĩa là “một số rất âm”, mà kể cả như vậy, một giá trị tốt hơn của nó nên được sắc nét thành <code>-1e100</code>).</p>
<blockquote class="colorquote success"><p><strong>KEY IDEA</strong><br>Prefer clean and simple test values that still get the job done.</p>
</blockquote>
<p>Những giá trị khác trong test của chúng ta cũng không quá tệ, nhưng trong khi chúng ta ở đâu, chúng ta có thể giảm chúng thành các số nguyên đơn giản nhất có thể. Ngoài ra, chỉ cần 1 giá trị âm là cần để test việc giá trị âm bị loại bỏ. Đây là phiên bản mới của test:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(&quot;1, 2, -1, 3&quot;, &quot;3, 2, 1&quot;);</span><br></pre></td></tr></table></figure><br>Chúng ta đã đơn giản hóa các giá trị của test mà không hề giảm hiệu quả đi :D</p>
<blockquote class="colorquote info"><p><strong>LARGE “SMASHER” TESTS</strong><br>(Tôi đang hiểu là không nên test các giá trị khủng, thay vào đó hiệu quả hơn là xây dựng nó theo chương trình)</p>
<p><img src="https://github.com/minhnv2306/the-art-readable-code-img/blob/master/chapter14/large_smasher_test.png?raw=true" class="[]"></p>
<p>Chắc chắn có những giá trị trong các test của bạn chống lại việc đầu vào lớn, điên rỗ. Ví dụ, bạn có thể bị cám dỗ bởi các test như:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;100, 38, 19, -25, 4, 84, [lots of values] ...&quot;</span>,</span><br><span class="line">            <span class="string">&quot;100, 99, 98, 97, 96, 95, 94, 93, ...&quot;</span>);</span><br></pre></td></tr></table></figure><br>Những đầu vào lớn như vậy là 1 phần công việc tốt để tìm ra lỗi như các lỗi tràn số hoặc các lỗi khác bạn không mong đợi.</p>
<p>Nhưng code như vậy là lớn và đáng sợ để nhìn vào và không hoàn toàn hiệu quả trong việc stress-testing code. Thay vào đó, sẽ hiệu của hơn để xây dựng đầu vào 1 đầu vào lớn theo chương trình, khởi tạo 1 giá trị lớn của 100.000 giá trị.</p>
</blockquote>
<h2 id="Multiple-Tests-of-Functionality"><a href="#Multiple-Tests-of-Functionality" class="headerlink" title="Multiple Tests of Functionality"></a>Multiple Tests of Functionality</h2><p>Thay vì chỉ xây dựng 1 đầu vào đơn “hoàn hảo” để xem xét kĩ lưỡng code, nó thường dễ dàng hơn, hiệu quả hơn và dễ đọc hơn để viết nhiều bài kiểm tra nhỏ hơn.</p>
<p>Mỗi test nên đẩy vào code của bạn 1 hướng nhất định và thử tìm lỗi cụ thể. Ví dụ đây là 4 tests cho <code>SortAndFilterDocs()</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;2, 1, 3&quot;</span>, <span class="string">&quot;3, 2, 1&quot;</span>);	<span class="comment">// Basic sorting</span></span><br><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;0, -0.1, -10&quot;</span>, <span class="string">&quot;0&quot;</span>);	<span class="comment">// All values &lt; 0 removed</span></span><br><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;1, -2, 1, -2&quot;</span>, <span class="string">&quot;1, 1&quot;</span>);	<span class="comment">// Duplicates not a problem</span></span><br><span class="line">CheckScoresBeforeAfter(<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>);					<span class="comment">// Empty input OK</span></span><br></pre></td></tr></table></figure></p>
<p>Thậm chí có nhiều test bạn có thể viết nếu bạn muốn kiểm tra chi tiết. Có các test tách biệt cũng làm nó dễ đọc với các người tiếp theo làm việc với code. Nếu ai đó tình cờ gặp 1 lỗi, test lỗi sẽ xác định cính xác test nào lỗi.</p>
<h1 id="Naming-Test-Functions"><a href="#Naming-Test-Functions" class="headerlink" title="Naming Test Functions"></a>Naming Test Functions</h1><p>Test code là thường được tổ chức vào trong hàm - một cho mỗi phương thức và/hoặc tình huống bạn đang test. Ví dụ, đoạn code test <code>SortAndFilterDocs()</code> trong 1 hàm tên là <code>Test1()</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Chọn 1 cái tên tốt cho 1 hàm test có vẻ tẻ nhạt và không liên quan, nhưng đừng vì thế mà chọn những cái tên không có nhiều ý nghĩa như <code>Test1()</code>, <code>Test2()</code> hoặc tương tự.</p>
<p>Thay vì đó bạn nên sử dụng 1 cái tên mô tả chi tiết về test. Cụ thể, nó rất tiện dụng nếu ai đó đọc test code của bạn mà có thể tìm ra:</p>
<ul>
<li>Class đang được test (nếu có).</li>
<li>Hàm đang được test.</li>
<li>Vấn đề hoặc bug đang được test.</li>
</ul>
<p>Một cách tiếp cận đơn giản để khởi tạo 1 tên hàm test tốt là chỉ cần kết hợp các thông tin lại với nhau, có thể sử dụng prefix “Test_”</p>
<p>Ví dụ, thay vì đặt tên nó là Test1(), chúng ta có thể sử dụng format <code>Test_&lt;FunctionName&gt;()</code>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test_SortAndFilterDocs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Tùy thuộc vào mức độ chi tiết của test, bạn nên cân nhắc việc tách các hàm test ra thành mỗi vấn đề để test. Bạn có thể sử dụng <code>Test_&lt;FunctionName&gt;_&lt;Situation&gt;()</code> format:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test_SortAndFilterDocs_BasicSorting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test_SortAndFilterDocs_NegativeValues</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>Đừng lo lắng là có các tên dài và lộn xộn ở đây. Đây không phải là 1 hàm chúng ta sẽ gọi trong codebase, do đó lý do để tránh 1 tên dài không áp dụng ở đây. Các tên hàm test hoạt động như 1 comment. Và như vậy, nếu 1 test lỗi, đa số các frameworks sẽ in tên hàm assert lỗi ra, do đó một tên hàm rõ ràng sẽ rất hữu ích ở đây.</p>
<p>Chú ý rằng nếu bạn đang sử dụng 1 framework testing, có thể có những nguyên tắc và conventions về tên của các phương thức. Ví dụ, <code>unittest</code> Python module mong đợi tên của các phương thức test bắt đầu với “test”.</p>
<p>Khi nói đến việc đặt tên cho các hàm <em>helper</em> trong test code, sẽ hữu ích để làm nổi bật lên hàm này có tự làm một vài assert nào không hay nó chỉ là một helper test-unaware thông thường. Ví dụ, trong chương này, một vào hepler được gọi như <code>assert()</code> với tên Check()…Nhưng hàm <code>AddScoredDoc()</code> được đặt tên chỉ là 1 helper thông thường.</p>
<h1 id="What-Was-Wrong-with-That-Test"><a href="#What-Was-Wrong-with-That-Test" class="headerlink" title="What Was Wrong with That Test?"></a>What Was Wrong with That Test?</h1><p>Ở phần đầu của chương, chúng tôi đã tuyên bố rằng có ít nhất 8 thứ đang sai với test này:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ScoredDocument&gt; docs;</span><br><span class="line">    docs.resize(<span class="number">5</span>);</span><br><span class="line">    docs[<span class="number">0</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">0</span>].score = <span class="number">-5.0</span>;</span><br><span class="line">    docs[<span class="number">1</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">1</span>].score = <span class="number">1</span>;</span><br><span class="line">    docs[<span class="number">2</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">2</span>].score = <span class="number">4</span>;</span><br><span class="line">    docs[<span class="number">3</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">3</span>].score = <span class="number">-99998.7</span>;</span><br><span class="line">    docs[<span class="number">4</span>].url = <span class="string">&quot;http://example.com&quot;</span>;</span><br><span class="line">    docs[<span class="number">4</span>].score = <span class="number">3.0</span>;</span><br><span class="line"></span><br><span class="line">    SortAndFilterDocs(&amp;docs);</span><br><span class="line"></span><br><span class="line">    assert(docs.size() == <span class="number">3</span>);</span><br><span class="line">    assert(docs[<span class="number">0</span>].score == <span class="number">4</span>);</span><br><span class="line">    assert(docs[<span class="number">1</span>].score == <span class="number">3.0</span>);</span><br><span class="line">    assert(docs[<span class="number">2</span>].score == <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>Bây giờ chúng ta sẽ tìm hiểu 1 vài kĩ thuật để viết tests tốt hơn, hãy nhận dạng chúng:</p>
<ol>
<li>Test rất dài và đầy đủ các chi tiết không quan trọng. Bạn có thể mô tả thứ mà test này đang làm trong 1 câu, do đó các lệnh trong test này không nên quá dài.</li>
<li>Thêm 1 test khác không phải dễ. Khi bạn cần copy/paste/modify, cài mà sẽ làm cho code dài hơn và yêu cầu đầy đủ bản sao.</li>
<li>Thông điệp test lỗi không hữu ích. Nếu 1 test lỗi, nó sẽ nói rằng <code>Assertion failed: docs.size() == 3</code>, cái mà không cho bạn đủ thông tin để debug thêm.</li>
<li>Test đang cố gắng test mọi thứ trong 1 lúc. Nó đang cố gắng test cả lọc số âm và chức năng sắp xếp. Nó sẽ dễ đọc hơn nếu phá vỡ vào trong nhiều tests.</li>
<li>Đầu vào test không đơn giản. Cụ thể, điểm ví dụ -9998.7 “ồn ào” và nhận sự chú ý mặc dù nó không phải và 1 vài ý nghĩa của các giá trị đặc biệt. Giá trị của 1 số âm đơn giản hơn sẽ là đủ.</li>
<li>Các input của test không thực hiện kiểm tra kĩ lưỡng được code. Ví dụ, nó không test trường hợp điểm là 0 (Bạn cần phải xem tài liệu để biết rằng nó có filter hay không?).</li>
<li>Nó không test các đầu vào cực đoan khác, như 1 vector trống, 1 vector lớn hoặc 1 điểm lặp lại.</li>
<li>Tên <code>Test1()</code> không có nhiều ý nghĩa - tên nên mô tả chức năng và vấn đề đang test.</li>
</ol>
<h1 id="Test-Friendly-Development"><a href="#Test-Friendly-Development" class="headerlink" title="Test-Friendly Development"></a>Test-Friendly Development</h1><p>Một vài code dễ dàng để test hơn code khác. Code lý tưởng để test là có giao diện được định nghĩa mà mà không có nhiều trạng thái hoặc “setup” khác và không có nhiều dữ liệu ẩn để kiểm tra.</p>
<p>Nếu bạn viết code và bạn biết sẽ viết test cho nó sau đó, một thứ vui vẻ sẽ diễn ra: <strong>bạn bắt đầu thiết kế code để dễ dàng test!</strong>. May mắn thay, coding theo cách này cũng có nghĩa bạn tạo code tốt hơn thông thường. Thiết kế Test-friendly thường 1 cách tự nhiên sẽ dẫn đến code tổ chức tốt hơn, với các phần riêng biệt làm những thứ riêng biệt.</p>
<blockquote class="colorquote info"><p><strong>TEST-DRIVEN DEVELOPMENT</strong><br>Test-driven development (TDD) là cách lập trình khi mà bạn sẽ xây dựng các tests <em>trước khi bạn viết code thực tế</em>. Những người đề xuất TDD tin tưởng rằng quá trình này cải thiện sâu sắc chất lượng các đoạn nontest code hơn nhiều so với nếu bạn viết các tests sau khi viết code.</p>
<p>Đây là 1 chủ đề tranh luận sôi nổi mà chúng tôi không đi sâu vào. Ít nhất, chúng tôi đã tìm thấy rằng, chỉ cần giữ các testing trong khi viết code sẽ giúp code tốt hơn.</p>
<p>Nhưng mà bất kể cho bạn triển khai TDD, kết quả cuối cùng là bạn có code để test các code khác. Mục đích của chương này là giúp bạn tạo các test dễ đọc và dễ viết.</p>
</blockquote>
<p>Trong tất cả các cách để chia 1 chương trình vào trong lớp và phương thức, những cách tách rời nhất thường dễ test nhất. Nói 1 cách khác, hãy nói chương trình của bạn rất kết nối với nhau, với 1 vào phương thức được gọi giữa các lớp và nhiều tham số cho tất cả các phương thức. Chương trình đó không chỉ có code khó hiểu mà test code cũng xấu xí và khó đọc, khó viết.</p>
<p>Có nhiều thành phần “bên ngoài” (các biến global cần được khởi tạo, thư viện hoặc file cấu hình cần được load) cùng làm nó khó chịu hơn để viết tests.</p>
<p>Nói chung, nếu bạn đang thiết kế code của bạn và nhận ra <em>Hmm, thật là 1 cơn ác mộng để test</em>, đây là 1 lý do tốt để dừng và suy nghĩa lại các thiết kế. Bảng 14-1 chỉ ra 1 vài các testing điển hình và các vấn đề về thiết kế.</p>
<p>TABLE 14-1. Characteristics of less testable code, and how this leads to problems with design</p>
<table>
<thead>
<tr>
<th>Characteristic</th>
<th>Testability problem</th>
<th>Design problem</th>
</tr>
</thead>
<tbody>
<tr>
<td>Use of global variables</td>
<td>All the global state needs to reset for every test (otherwise, different tests can interfere with each other).</td>
<td>Hard to understand which functions have what side effects. Can’t think about each function in isolation; need to consider the whole program to understand if everything works.</td>
</tr>
<tr>
<td>Code depends on a lot of external components</td>
<td>It’s harder to write any tests because there’s so much scaffolding to set up first. Tests are less fun to write, so people avoid writing tests.</td>
<td>System is more likely to fail when one of the dependencies fails. It’s harder to understand what impact any given change might make. It’s harder to refactor classes. System has more failure modes and recovery paths to think about.</td>
</tr>
<tr>
<td>Code has nondeterministic behavior</td>
<td>Tests are flaky and unreliable. Tests that occasionally fail end up being ignored.</td>
<td>The program is more likely to have race conditions or other nonreproducible bugs. The program is harder to reason about. Bugs in production are very difficult to track down and fix</td>
</tr>
</tbody>
</table>
<p>Trong 1 chiều hướng khác, nếu bạn có 1 thiết kế code dễ dàng để viết test, đó là 1 dấu hiệu tốt. Bảng 14-2 chỉ ra 1 vài lợi ích của testing và các đặc điểm thiết kế.</p>
<p>TABLE 14-2. Characteristics of more testable code, and how this leads to good design</p>
<table>
<thead>
<tr>
<th>Characteristic</th>
<th>Testability problem</th>
<th>Design problem</th>
</tr>
</thead>
<tbody>
<tr>
<td>Classes have little or no internal state</td>
<td>Tests are easier to write because there is less setup needed to test a method and less hidden state to inspect.</td>
<td>Classes with less state are simpler and easier to understand.</td>
</tr>
<tr>
<td>Classes/functions only do one thing</td>
<td>Fewer test cases are required to fully test it.</td>
<td>Smaller/simpler components are more modular, and the system is generally more decoupled.</td>
</tr>
<tr>
<td>Classes depend on few other classes; high decoupling</td>
<td>Each class can be tested independently (much easier than testing multiple classes at once).</td>
<td>System can be developed in parallel. Classes can be easily modified or removed without disrupting the rest of the system</td>
</tr>
<tr>
<td>Functions have simple, well-defined interfaces</td>
<td>There are well-defined behaviors to test for. Simple interfaces take less work to test.</td>
<td>Interfaces are easier for coders to learn and are more likely to be reused.</td>
</tr>
</tbody>
</table>
<h1 id="Going-Too-Far"><a href="#Going-Too-Far" class="headerlink" title="Going Too Far"></a>Going Too Far</h1><p>Nó cũng có thể tập trung quá nhiều thứ trong test. Đây là 1 vài ví dụ:</p>
<ul>
<li><strong>Hi sinh khả năng đọc real code để cho phép test</strong>. Thiết kế real code để có thể test được sẽ là vấn đề win-win: real code trở nên đơn giản và nhiều phần tách rời và các test của bạn cũng dễ viết. Nhưng nếu bạn phải chèn nhiều các đường ống xấu xí vào real code để bạn có thể test được, thì có gì đó sai sai ở đây.</li>
<li><strong>Bị ám ảnh về 100% phạm vi test</strong>. Testing lần đầu 90% code của bạn thường làm việc ít hơn 10% cuối. 10% cuối có thể liên quan đến giao diện người dùng, hoặc đưa ra các trường hợp lỗi, mà cái giá của bug không thực sự code và các nỗ lực để test nó cũng không đáng.</li>
</ul>
<p>Sự thật là bạn không bao giờ có phạm vi test 100%. Nếu nó không phải là 1 lỗi bị bỏ qua, nó có thể là 1 chức năng bị bỏ qua hoặc bạn không nhận ra được rằng spec đã được thay đổi.</p>
<p>Tùy thuộc vào lỗi của bạn tốn kém như thế nào, sẽ có điểm thú vị về thời gian phát triển đáng kể để dành cho test code. Nếu bạn đang xây dựng nguyên mẫu 1 trang website, nó có thể không đáng để viết 1 vài test code nào cả. Mặt khác, nếu bạn đang viết 1 bộ điều khiển cho tàu vũ trụ hoặc các thiết bị y tế, testing có thể là mục tiêu chính của bạn.</p>
<ul>
<li><strong>Hãy để testing có trong cách phát triển sản phẩm</strong>. Chúng ta đã thấy các tình huống trong đó thử nghiệm, vốn chỉ là một khía cạnh của dự án, chi phối toàn bộ dự án. Thử nghiệm trở thành một loại tinh thần được xoa dịu, và các lập trình viên chỉ trải qua các nghi thức và chuyển động mà không nhận ra rằng thời gian kỹ thuật quý giá của họ có thể được chi tiêu tốt hơn ở nơi khác.</li>
</ul>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>Trong test code, khả năng đọc là rất quan trọng. Nếu test của bạn dễ đọc, chúng sẽ dễ viết, mọi người sẽ thêm được nhiều. Cũng như vậy, nếu bạn thiết kế real code dễ test, code của bạn sẽ có 1 thiết kế tổng thể tốt hơn.</p>
<p>Đây là 1 vài điểm để cải thiện test của bạn:</p>
<ul>
<li>Ở mức cao nhất của mỗi test nên ngắn gọn nhất có thể, lý tưởng nhất, mỗi test input/ouput có thể mô tả trong 1 dòng code.</li>
<li>Nếu test của bạn lỗi, nó nên bắn ra 1 thông điệp lỗi làm cho lỗi dễ dàng tìm ra và sửa</li>
<li>Sử dụng các input test đơn giản nhất kiểm tra code của bạn</li>
<li>Tên các hàm test cần đầy đủ mô tả và rõ ràng cho mỗi test. Thay vì tên <code>Test1()</code>, sử dụng 1 cái tên như <code>Test_&lt;FunctionName&gt;_&lt;Situation&gt;.</code></li>
</ul>
<p>Và trên hết, làm cho việc sửa đổi và thêm 1 test dễ dàng.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Chapter 14: Testing and Readability</p><p><a href="http://yoursite.com/2020/05/24/Chapter-14-Testing-and-Readability/">http://yoursite.com/2020/05/24/Chapter-14-Testing-and-Readability/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Ming</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-05-24</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-08-08</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/mingnv" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/05/24/Chapter-15-Designing-and-Implementing-a-%E2%80%9CMinute-Hour-Counter%E2%80%9D/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Chapter 15: Designing and Implementing a “Minute/Hour Counter”</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/05/24/Part-5-Selected-Topics/"><span class="level-item">Part IV: Selected Topics</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yoursite.com/2020/05/24/Chapter-14-Testing-and-Readability/';
            this.page.identifier = '2020/05/24/Chapter-14-Testing-and-Readability/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'minh' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/spidertocat.png" alt="Minh NV"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Minh NV</p><p class="is-size-6 is-block">_N.V.M_</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hanoi city, Vietnam</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">160</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">36</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">50</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/minhnv2306" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/minhnv2306"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/profile.php?id=100003860456359"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="http://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="http://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AWS-Developer-Associate/"><span class="level-start"><span class="level-item">AWS Developer Associate</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/AWS-Practitioner/"><span class="level-start"><span class="level-item">AWS Practitioner</span></span><span class="level-end"><span class="level-item tag">26</span></span></a></li><li><a class="level is-mobile" href="/categories/AWS-Training/"><span class="level-start"><span class="level-item">AWS Training</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Authentication/"><span class="level-start"><span class="level-item">Authentication</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-code/"><span class="level-start"><span class="level-item">Clean code</span></span><span class="level-end"><span class="level-item tag">16</span></span></a><ul><li><a class="level is-mobile" href="/categories/Clean-code/Clean-code-Robert-C-Martin/"><span class="level-start"><span class="level-item">Clean code - Robert C. Martin</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-code/Refactoring-to-Collections/"><span class="level-start"><span class="level-item">Refactoring to Collections</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/MongoDB/"><span class="level-start"><span class="level-item">MongoDB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/"><span class="level-start"><span class="level-item">Development and Operation</span></span><span class="level-end"><span class="level-item tag">33</span></span></a><ul><li><a class="level is-mobile" href="/categories/Development-and-Operation/CircleCI-2-0/"><span class="level-start"><span class="level-item">CircleCI 2.0</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Google-Cloud-Platform/"><span class="level-start"><span class="level-item">Google Cloud Platform</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Laravel/"><span class="level-start"><span class="level-item">Laravel</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Linux-OS/"><span class="level-start"><span class="level-item">Linux OS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Web-Server/"><span class="level-start"><span class="level-item">Web Server</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/JP/"><span class="level-start"><span class="level-item">JP</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/"><span class="level-start"><span class="level-item">JavaScript</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/JavaScript/Asynchronous/"><span class="level-start"><span class="level-item">Asynchronous</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/Event/"><span class="level-start"><span class="level-item">Event</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaScript/React/"><span class="level-start"><span class="level-item">React</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">15</span></span></a><ul><li><a class="level is-mobile" href="/categories/Others/Cong-cu-lap-trinh/"><span class="level-start"><span class="level-item">Công cụ lập trình</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/PHPCS/"><span class="level-start"><span class="level-item">PHPCS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Suu-tam/"><span class="level-start"><span class="level-item">Sưu tầm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Website-Optimization/"><span class="level-start"><span class="level-item">Website Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Snippets-code/"><span class="level-start"><span class="level-item">Snippets code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Special-day/"><span class="level-start"><span class="level-item">Special day</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/"><span class="level-start"><span class="level-item">The Art of Readable Code</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Chapter-1-Code-Should-Be-Easy-to-Understand/"><span class="level-start"><span class="level-item">Chapter 1 - Code Should Be Easy to Understand</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-I-Surface-Level-Improvements/"><span class="level-start"><span class="level-item">Part I - Surface-Level Improvements</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-II-Simplifying-Loops-and-Logic/"><span class="level-start"><span class="level-item">Part II - Simplifying Loops and Logic</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-III-Reorganizing-Your-Code/"><span class="level-start"><span class="level-item">Part III - Reorganizing Your Code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-IV-Selected-Topics/"><span class="level-start"><span class="level-item">Part IV - Selected Topics</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Unit-Test/"><span class="level-start"><span class="level-item">Unit Test</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/API/"><span class="tag">API</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CI-CD/"><span class="tag">CI/CD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kanji/"><span class="tag">Kanji</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-command-line/"><span class="tag">Linux command line</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache2/"><span class="tag">apache2</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/async-programing/"><span class="tag">async programing</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/authentication/"><span class="tag">authentication</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-exam-preparation/"><span class="tag">aws exam preparation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-labs/"><span class="tag">aws labs</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-certificate/"><span class="tag">aws-certificate</span><span class="tag">44</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-comment/"><span class="tag">clean comment</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-error/"><span class="tag">clean error</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-function/"><span class="tag">clean function</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/collection/"><span class="tag">collection</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/configuration/"><span class="tag">configuration</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-command/"><span class="tag">docker command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-file-format/"><span class="tag">docker compose file format</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-best-practice/"><span class="tag">docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-yml/"><span class="tag">docker-compose.yml</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-instructions-docker-best-practice/"><span class="tag">docker-instructions docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-network/"><span class="tag">docker-network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-volume/"><span class="tag">docker-volume</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event/"><span class="tag">event</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event-notification/"><span class="tag">event notification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/excelfile/"><span class="tag">excelfile</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gcp/"><span class="tag">gcp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jquery-validation/"><span class="tag">jquery-validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubernetes/"><span class="tag">kubernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/laravel/"><span class="tag">laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongoDB/"><span class="tag">mongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mysql/"><span class="tag">mysql</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/naming/"><span class="tag">naming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/note-choi-choi/"><span class="tag">note choi choi</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs/"><span class="tag">phpcs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs-phpcsfixer/"><span class="tag">phpcs phpcsfixer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/process-management/"><span class="tag">process management</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-boilerplate/"><span class="tag">react boilerplate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/requests/"><span class="tag">requests</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/snippets-code/"><span class="tag">snippets-code</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stripe/"><span class="tag">stripe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sudo-command/"><span class="tag">sudo command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tips-laravel/"><span class="tag">tips laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tracking-php-script/"><span class="tag">tracking php script</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unit-test/"><span class="tag">unit test</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/validation/"><span class="tag">validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vba/"><span class="tag">vba</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vim/"><span class="tag">vim</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">July 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">June 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Make-Tests-Easy-to-Read-and-Maintain"><span class="level-left"><span class="level-item">1</span><span class="level-item">Make Tests Easy to Read and Maintain</span></span></a></li><li><a class="level is-mobile" href="#What’s-Wrong-with-This-Test"><span class="level-left"><span class="level-item">2</span><span class="level-item">What’s Wrong with This Test?</span></span></a></li><li><a class="level is-mobile" href="#Making-This-Test-More-Readable"><span class="level-left"><span class="level-item">3</span><span class="level-item">Making This Test More Readable</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Creating-the-Minimal-Test-Statement"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Creating the Minimal Test Statement</span></span></a></li><li><a class="level is-mobile" href="#Implementing-Custom-“Minilanguages”"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Implementing Custom “Minilanguages”</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Making-Error-Messages-Readable"><span class="level-left"><span class="level-item">4</span><span class="level-item">Making Error Messages Readable</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Using-Better-Versions-of-assert"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">Using Better Versions of assert()</span></span></a></li><li><a class="level is-mobile" href="#Hand-Crafted-Error-Messages"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">Hand-Crafted Error Messages</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Choosing-Good-Test-Inputs"><span class="level-left"><span class="level-item">5</span><span class="level-item">Choosing Good Test Inputs</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Simplifying-the-Input-Values"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">Simplifying the Input Values</span></span></a></li><li><a class="level is-mobile" href="#Multiple-Tests-of-Functionality"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">Multiple Tests of Functionality</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Naming-Test-Functions"><span class="level-left"><span class="level-item">6</span><span class="level-item">Naming Test Functions</span></span></a></li><li><a class="level is-mobile" href="#What-Was-Wrong-with-That-Test"><span class="level-left"><span class="level-item">7</span><span class="level-item">What Was Wrong with That Test?</span></span></a></li><li><a class="level is-mobile" href="#Test-Friendly-Development"><span class="level-left"><span class="level-item">8</span><span class="level-item">Test-Friendly Development</span></span></a></li><li><a class="level is-mobile" href="#Going-Too-Far"><span class="level-left"><span class="level-item">9</span><span class="level-item">Going Too Far</span></span></a></li><li><a class="level is-mobile" href="#Summary"><span class="level-left"><span class="level-item">10</span><span class="level-item">Summary</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T14:55:03.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Clean-code-Chapter-11-System/">[Clean code] Chapter 11: System</a></p><p class="categories"><a href="/categories/Clean-code/">Clean code</a> / <a href="/categories/Clean-code/Clean-code-Robert-C-Martin/">Clean code - Robert C. Martin</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T14:01:21.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Blog-for-me/">Blog for me</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-27T13:46:55.000Z">2024-08-27</time></p><p class="title"><a href="/2024/08/27/Tips-2-PHP-Snippets-code/">Tips 2: PHP Snippets code</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-23T15:42:35.000Z">2024-08-23</time></p><p class="title"><a href="/2024/08/23/Tips-Laravel-Snippets-code/">Tips 1: Laravel Snippets code</a></p><p class="categories"><a href="/categories/Snippets-code/">Snippets code</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-17T15:41:26.000Z">2024-08-17</time></p><p class="title"><a href="/2024/08/17/Clean-code-Chapter-10-Class/">[Clean code] Chapter 10: Class</a></p><p class="categories"><a href="/categories/Clean-code/">Clean code</a> / <a href="/categories/Clean-code/Clean-code-Robert-C-Martin/">Clean code - Robert C. Martin</a></p></div></article></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://blog.zhangruipeng.me/hexo-theme-icarus/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus blog</span></span><span class="level-right"><span class="level-item tag">blog.zhangruipeng.me</span></span></a></li><li><a class="level is-mobile" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus github</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://octodex.github.com/images/privateinvestocat.jpg" alt="Hello, I am Minh" height="28"></a><p class="is-size-7"><span>&copy; 2024 Ming</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>