<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[Docker] General guidelines and recommendations - Hello, I am Minh</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hello, I am Minh"><meta name="msapplication-TileImage" content="/img/my_favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hello, I am Minh"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Tài liệu sau mô tả những gợi ý best practices và các các thức để xây dựng các images có hiệu quả. Phần này lấy từ 1 phần của https:&amp;#x2F;&amp;#x2F;docs.docker.com&amp;#x2F;develop&amp;#x2F;develop-images&amp;#x2F;dockerfile_best-practices&amp;#x2F;."><meta property="og:type" content="blog"><meta property="og:title" content="[Docker] General guidelines and recommendations"><meta property="og:url" content="http://yoursite.com/2020/04/19/Docker-General-guidelines-and-recommendations/"><meta property="og:site_name" content="Hello, I am Minh"><meta property="og:description" content="Tài liệu sau mô tả những gợi ý best practices và các các thức để xây dựng các images có hiệu quả. Phần này lấy từ 1 phần của https:&amp;#x2F;&amp;#x2F;docs.docker.com&amp;#x2F;develop&amp;#x2F;develop-images&amp;#x2F;dockerfile_best-practices&amp;#x2F;."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://images.viblo.asia/2726bca3-7c21-48af-a063-aa3580eeb30a.PNG"><meta property="article:published_time" content="2020-04-19T16:13:04.000Z"><meta property="article:modified_time" content="2021-04-10T00:07:10.622Z"><meta property="article:author" content="Ming"><meta property="article:tag" content="docker-best-practice"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://images.viblo.asia/2726bca3-7c21-48af-a063-aa3580eeb30a.PNG"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/04/19/Docker-General-guidelines-and-recommendations/"},"headline":"[Docker] General guidelines and recommendations","image":[],"datePublished":"2020-04-19T16:13:04.000Z","dateModified":"2021-04-10T00:07:10.622Z","author":{"@type":"Person","name":"Ming"},"description":"Tài liệu sau mô tả những gợi ý best practices và các các thức để xây dựng các images có hiệu quả. Phần này lấy từ 1 phần của https:&#x2F;&#x2F;docs.docker.com&#x2F;develop&#x2F;develop-images&#x2F;dockerfile_best-practices&#x2F;."}</script><link rel="canonical" href="http://yoursite.com/2020/04/19/Docker-General-guidelines-and-recommendations/"><link rel="icon" href="/img/my_favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-112002191-2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-112002191-2');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="Hello, I am Minh" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-04-19T16:13:04.000Z" title="4/19/2020, 11:13:04 PM">2020-04-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-04-10T00:07:10.622Z" title="4/10/2021, 7:07:10 AM">2021-04-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Development-and-Operation/">Development and Operation</a><span> / </span><a class="link-muted" href="/categories/Development-and-Operation/Docker/">Docker</a></span><span class="level-item">28 minutes read (About 4145 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">[Docker] General guidelines and recommendations</h1><div class="content"><p>Tài liệu sau mô tả những gợi ý best practices và các các thức để xây dựng các images có hiệu quả.</p>
<p>Phần này lấy từ 1 phần của <a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">https://docs.docker.com/develop/develop-images/dockerfile_best-practices/</a>. Còn 1 phần best practice cho Docker instructions, bạn tham khảo tại bài Docker instructions nhé.<br><span id="more"></span><br>Docker build các image tự động bằng cách đọc các lệnh từ <code>Dockerfile</code> - một file text chứa tất cả các lệnh, theo thứ tự cần thiết để build 1 image. Một Dockerfile tuân thủ cấu trúc riêng và có tập các instructions nhất định.</p>
<p>Một <code>Docker</code> image bao gồm các tầng chỉ đọc (read-only layers), mỗi tầng có 1 nhiệm vụ riêng của 1 Dockerfile instruction. Những tầng này được xếp chồng lên nhau và mỗi tầng có thay đổi với các tầng trước.<br><img src="https://images.viblo.asia/2726bca3-7c21-48af-a063-aa3580eeb30a.PNG" alt="">.</p>
<p>Xem xét Dockerfile:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">18.04</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> make /app</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> python /app/app.py</span></span><br></pre></td></tr></table></figure></p>
<p>Mỗi instruction tạo 1 layer:</p>
<ul>
<li><strong>FROM</strong> tạo 1 layer từ <code>ubuntu:18.04 image</code>.</li>
<li><strong>COPY</strong> thêm files từ thư mục Docker hiện tại.</li>
<li><strong>RUN</strong> build ứng dụng của bạn với <code>make</code>.</li>
<li><strong>CMD</strong> chỉ ra lệnh nào cần chạy trong container này.</li>
</ul>
<p>Khi bạn chạy 1 image và sinh ra container, bạn thêm 1 layer có thể ghi (writable layer (the “container layer”)), trên cùng của các layers bên dưới. Tất cả thay đổi khi chạy container như là ghi files mới, định nghĩa file đã tồn tại và xóa files được ghi lại trong tầng container có thể ghi này.</p>
<h1 id="General-guidelines-and-recommendations"><a href="#General-guidelines-and-recommendations" class="headerlink" title="General guidelines and recommendations"></a>General guidelines and recommendations</h1><h2 id="Create-ephemeral-containers"><a href="#Create-ephemeral-containers" class="headerlink" title="Create ephemeral containers"></a>Create ephemeral containers</h2><p>Image định nghĩa bởi Dockerfile nên sinh ra các container “càng phù du càng tốt”. Phù du ở đây chúng ta hiểu là các contianer có thể<br>được stopped và destroyed và rebuild và replaced với thiết lập và cấu hình tối thiểu tuyệt đối.</p>
<p>=&gt; Chưa hiểu ý lắm :v</p>
<h2 id="Understand-build-context"><a href="#Understand-build-context" class="headerlink" title="Understand build context"></a>Understand build context</h2><p>Vấn đề khi bạn chạy <code>docker build</code> command, đường dẫn làm việc hiện tại của bạn được gọi là <em>build context</em>. Mặc định, Dockerfile sẽ được giả định là từ đây nhưng bạn có thể xác định 1 đường location khác với flag file <code>(-f)</code>. Bất kể khi nào Dockerfile đang hoạt động, tất cả nội dung file, tệp đệ quy trong thư mục hiện tại được gửi vào Docker daemon như là build context</p>
<h2 id="Pipe-Dockerfile-through-stdin"><a href="#Pipe-Dockerfile-through-stdin" class="headerlink" title="Pipe Dockerfile through stdin"></a>Pipe Dockerfile through <code>stdin</code></h2><p>Docker có thể build các images bằng cách đường ống dữ liệu vào Dockerfile qua <code>stdin</code> với 1 local or remote build context. Kĩ thuật đường ống dữ liệu vào Dockerfile qua stdin có thể hữu<br>ích hiệu năng đối với các bản build 1 lần (one-off builds) mà không cần viết Dockerfile vào ổ đĩa hoặc trong các tình huống mà Dockerfile được tạo ra mà không nên tồn tại sau đó<br>(Trường hợp này thực tế không sử dụng nên tạm thời bỏ qua chưa đọc)</p>
<h2 id="Exclude-with-dockerignore"><a href="#Exclude-with-dockerignore" class="headerlink" title="Exclude with .dockerignore"></a>Exclude with .dockerignore</h2><p>Để loại trừ các file không liên quan khi build, sử dụng file <code>.dockerignore</code>. File này hỗ trợ các mẫu loại bỏ tương tự như .gitignore</p>
<h1 id="Use-multi-stage-builds"><a href="#Use-multi-stage-builds" class="headerlink" title="Use multi-stage builds"></a>Use multi-stage builds</h1><p>Multi-stage builds cho phép bạn giảm nhiều kích thước image cuối cùng của bạn mà không đấu tranh để giảm số lượng các tầng và files trung gian.</p>
<p>Bởi vì 1 image được build trong giai đoạn cuối cuối của quá trình build, bạn có thể giảm thiểu image layer bằng leveraging build cache (phần sau).</p>
<p>Ví dụ, nếu build của bạn có 1 vài layer, bạn có thể sắp xếp chúng từ ít thay đổi thường xuyên (để chắc chắn rằng cache khi build có thể hữu ích) đến phần thay đổi thường xuyên</p>
<ul>
<li>Install tools bạn cần để build ứng dụng</li>
<li>Install và cập nhật các thư viện phụ thuộc</li>
<li>Sinh ra ứng dụng của bạn</li>
</ul>
<p>Một Dockerfile từ ứng dụng Go sẽ như sau:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> golang:<span class="number">1.11</span>-alpine AS build</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install tools required for project</span></span><br><span class="line"><span class="comment"># Run `docker build --no-cache .` to update dependencies</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apk add --no-cache git</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> go get github.com/golang/dep/cmd/dep</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># List project dependencies with Gopkg.toml and Gopkg.lock</span></span><br><span class="line"><span class="comment"># These layers are only re-built when Gopkg files are updated</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> Gopkg.lock Gopkg.toml /go/src/project/</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /go/src/project/</span></span><br><span class="line"><span class="comment"># Install library dependencies</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> dep ensure -vendor-only</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy the entire project and build it</span></span><br><span class="line"><span class="comment"># This layer is rebuilt when a file changes in the project directory</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /go/src/project/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> go build -o /bin/project</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This results in a single layer image</span></span><br><span class="line"><span class="keyword">FROM</span> scratch</span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> --from=build /bin/project /bin/project</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;/bin/project&quot;</span>]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;--help&quot;</span>]</span></span><br></pre></td></tr></table></figure></p>
<h1 id="Don’t-install-unnecessary-packages"><a href="#Don’t-install-unnecessary-packages" class="headerlink" title="Don’t install unnecessary packages"></a>Don’t install unnecessary packages</h1><p>Tất nhiên, việc giảm thiểu các package không cần thiết để giảm thiểu độ phức tạo, sự phụ thuộc, kích thước file và thời gian build rồi =)) bởi vì nó có<br>nghĩa là “nice to have”. Ví dụ, bạn không cần cài các text editor trong database image.</p>
<h1 id="Decouple-applications"><a href="#Decouple-applications" class="headerlink" title="Decouple applications"></a>Decouple applications</h1><p>Mỗi container nên chỉ có 1 quan hệ. Phân tách ứng dụng thành nhiều containers làm nó dễ dàng mở rộng theo chiều ngang và dễ dàng sử dụng lại<br>các container. Ví dụ, một ngăn xếp của ứng dụng web có thể chứa 3 container tách biệt, mỗi chúng có 1 image duy nhất để quản lý ứng dụng web, database và<br>im-memory cache.</p>
<p>Cố gắng giữ các container của bạn sạch sẽ và phân hóa tính module nhất có thể. Nếu containers của bạn phụ thuộc các container khác, bạn có thể sử dụng<br>Docker container network để chắc chắn rằng chúng có thể nói chuyện được với nhau =))</p>
<h1 id="Minimize-the-number-of-layers"><a href="#Minimize-the-number-of-layers" class="headerlink" title="Minimize the number of layers"></a>Minimize the number of layers</h1><p>Trong các phiên bản Docker cũ, thực sự quan trọng cho bạn giảm thiểu số lượng layers trong image của bạn để chắc chắn rằng chúng có hiệu năng tốt.<br>Các tính năng sau đây đã được thêm vào để giảm thiểu các giới hạn này:</p>
<ul>
<li>Chỉ các instructions RUN, COPY, ADD tạo ra layers. Các instruction khác tạo ra các image trung gian tạm thời, và không làm tăng kích thước của quá trình build.</li>
<li>Bất cứ khi nào có thể, sử dụng multi-stage builds, và chỉ copy các thứ bạn cần vào image cuối cùng. Điều này cho phép bạn có thể có các tools và thông tin debug trong các stage tạm thời<br>của bạn nhưng không làm tăng kích thước trong image cuối cùng</li>
</ul>
<p>Ý kiến cá nhân: Bạn có thể xem quá trình build ra images đó sinh ra các layers và các image trung gian nào thông qua <code>docker history</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:latest</span><br><span class="line"></span><br><span class="line">COPY Hello.txt &#x2F;tmp</span><br><span class="line"></span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install vim -y</span><br><span class="line"></span><br><span class="line">CMD [ &quot;sh&quot;, &quot;-c&quot;, &quot;echo $HOME&quot; ]</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Nguyen Van Minh\Desktop\Docker&gt;docker history d978393ef1c7</span><br><span class="line">IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT</span><br><span class="line">d978393ef1c7        33 seconds ago      &#x2F;bin&#x2F;sh -c #(nop)  CMD [&quot;sh&quot; &quot;-c&quot; &quot;echo $HOM…   0B</span><br><span class="line">de55aff93a8d        23 minutes ago      &#x2F;bin&#x2F;sh -c apt-get update &amp;&amp; apt-get install…   88.3MB</span><br><span class="line">c5a143208697        36 minutes ago      &#x2F;bin&#x2F;sh -c #(nop) COPY file:6ffa4dcbbe5403e6…   16B</span><br><span class="line">4e5021d210f6        4 weeks ago         &#x2F;bin&#x2F;sh -c #(nop)  CMD [&quot;&#x2F;bin&#x2F;bash&quot;]            0B</span><br><span class="line">&lt;missing&gt;           4 weeks ago         &#x2F;bin&#x2F;sh -c mkdir -p &#x2F;run&#x2F;systemd &amp;&amp; echo &#39;do…   7B</span><br><span class="line">&lt;missing&gt;           4 weeks ago         &#x2F;bin&#x2F;sh -c set -xe   &amp;&amp; echo &#39;#!&#x2F;bin&#x2F;sh&#39; &gt; &#x2F;…   745B</span><br><span class="line">&lt;missing&gt;           4 weeks ago         &#x2F;bin&#x2F;sh -c [ -z &quot;$(apt-get indextargets)&quot; ]     987kB</span><br><span class="line">&lt;missing&gt;           4 weeks ago         &#x2F;bin&#x2F;sh -c #(nop) ADD file:594fa35cf803361e6…   63.2MB</span><br></pre></td></tr></table></figure></p>
<p>Bạn có thể thấy rất rõ, mỗi instruction đều tạo 1 layer (để đơn giản hóa, hãy xem các image trung gian tạm thời OB kia cũng là các layer) và tổng kích thước image chính là đống layer này cộng vào :D.</p>
<p>Hiểu nôm na các image trung gian (0B) chỉ là copy lại image cũ, chưa làm gì nên chưa tăng kích thước, nếu dùng <code>RUN, COPY, ADD</code> trên các image trung gian đó thì sinh 1 layer mới làm tăng kích thước images.</p>
<h1 id="Sort-multi-line-arguments"><a href="#Sort-multi-line-arguments" class="headerlink" title="Sort multi-line arguments"></a>Sort multi-line arguments</h1><p>Bất cứ khi nào có thể, dễ dàng thay đổi về sau bằng cách sắp xếp các đối số nhiều dòng. Điều này tránh bị trùng lặp các package và làm danh sách sẽ dễ dàng cập nhật hơn. Điều này cũng làm PRs dễ dàng đọc và review. Thêm space và mỗi backslash<code>(\)</code> để làm việc này :D.</p>
<p>Đây là một ví dụ:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update &amp;&amp; apt-get install -y \</span></span><br><span class="line"><span class="bash">  bzr \</span></span><br><span class="line"><span class="bash">  cvs \</span></span><br><span class="line"><span class="bash">  git \</span></span><br><span class="line"><span class="bash">  mercurial \</span></span><br><span class="line"><span class="bash">  subversion</span></span><br></pre></td></tr></table></figure></p>
<h1 id="Leverage-build-cache"><a href="#Leverage-build-cache" class="headerlink" title="Leverage build cache"></a>Leverage build cache</h1><p>Hiểu 1 chút về các khái niệm trong Docker và cache:</p>
<ul>
<li>Dockerfile bắt đầu với 1 parent image (từ FROM).</li>
<li>Sau đó trong quá trình build sẽ sinh ra nhất nhiều image trung gian, ta gọi là childrent image.</li>
<li>Base image thường nói đến các image từ các parent image (các image trống trơn, chưa cài đặt gì), và thêm các cài đặt phục vụ bạn (như cài thêm npm để build js, cài thêm composer<br>để build thêm PHP) được đẩy lên repo Docker hoặc trên local của bạn</li>
</ul>
<p>Ví dụ xem xét Dockerfile sau:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:latest</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> Hello.txt /tmp</span></span><br></pre></td></tr></table></figure><br>Dockerfile lấy từ parent image ubuntu:latest, sau lệnh COPY này, nó sẽ sinh ra 1 childrent image. Khi bạn build, bạn sẽ nhận được danh sách images sau:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Nguyen Van Minh\Desktop\Docker&gt;docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">&lt;none&gt;              &lt;none&gt;              c5a143208697        11 seconds ago      64.2MB</span><br><span class="line">ubuntu              latest              4e5021d210f6        4 weeks ago         64.2MB</span><br></pre></td></tr></table></figure></p>
<p>Như ví dụ trên tôi hiểu</p>
<ul>
<li><strong>ubuntu::lastest</strong>: parent image =&gt; image ubuntu không có cái vẹo gì</li>
<li><strong>c5a143208697</strong>: là image con của ubuntu:lastest</li>
<li><strong>c5a143208697</strong> cũng được gọi là base image của bạn. Tuy nhiên nó chưa cài thêm cái gì, base image này có vẻ hơi tù và gọi là base image có vẻ chưa ngon lắm.</li>
<li>Base image ví dụ laravel-workspace gọi base image thì sẽ chuẩn hơn, nó cung cấp không gian làm việc với ứng dụng.</li>
</ul>
<p>Ref: <a target="_blank" rel="noopener" href="https://github.com/FramgiaDockerTeam">https://github.com/FramgiaDockerTeam</a></p>
<blockquote>
<p>Khái niệm base image và parent image dễ gây nhầm lẫn, mà thôi đừng quan tâm sâu quá về nó. Hãy liên hệ khi bạn code, bạn có thể sử dụng Controller có sẵn trong Laravel là các parent image, bạn thêm các hàm (whereLike chẳng hạn) thì xây dựng lên BaseController, từ BaseController này sinh ra các image con HomeController, ProductController (mà gọi là con của Controller cũng không sai nhỉ =_=)</p>
</blockquote>
<p>Rồi, tản mạn về Base image, Parent Image và Childrent Image vậy thôi, bây giờ tôi sẽ đề cập đến cache.</p>
<p>Khi build Docker, chỗ nào sử dụng cache được báo lại rất rõ. Ví dụ với Dockerfile trên, build lại lần nữa, cache sẽ được sử dụng từ lệnh COPY, bạn có thể thấy rõ từ thông báo:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Nguyen Van Minh\Desktop\Docker&gt;docker build .</span><br><span class="line">Sending build context to Docker daemon  3.072kB</span><br><span class="line">Step 1&#x2F;2 : FROM ubuntu:latest</span><br><span class="line"> ---&gt; 4e5021d210f6</span><br><span class="line">Step 2&#x2F;2 : COPY Hello.txt &#x2F;tmp</span><br><span class="line"> ---&gt; Using cache</span><br><span class="line"> ---&gt; c5a143208697</span><br><span class="line">Successfully built c5a143208697</span><br></pre></td></tr></table></figure><br>Khi build 1 image, các bước Dokcker qua các instructions trong Dockerfile, thực thi từng instruction một được chỉ định. Mỗi instruction được kiểm tra, Docker tìm 1 image đã tồn tại trong cache của nó để sử dụng lại, thay vì tạo 1 (nhiều) image.</p>
<p>Nếu bạn không muốn sử dụng cache trong tất cả trường hợp, bạn có thể sử dụng tùy chọn <code>--no-cache=true</code> khi chạy <code>docker build</code>. Tuy nhiên, nếu bạn để Docker sử dụng cache, thực sự quan trọng để hiểu khi nào nó có thể dùng, và khi nào không thể, tìm kiếm image trùng. Các nguyên tắc cơ bản sau Docker sẽ tuân theo:</p>
<ul>
<li>Bắt đầu với parent image, cái đã có trong cache, các instruction tiếp thep sẽ được so sánh với <strong>tất cả</strong> các image con có nguồn gốc từ base image để xem nếu 1 trong số chúng đã được build sử dụng instruction giống nhau. Nếu không, cache sẽ bị vô hiệu.</li>
<li>Trong đa số các trường hợp, sự so sánh đơn giản instruction trong Dockerfile với 1 trong những child images là vừa đủ. Tuy nhiên, 1 số instructions sẽ yêu cầu nhiều sự xem xét và giải thích hơn.</li>
<li>Đối với lệnh <strong>ADD</strong> và <strong>COPY</strong>, nội dung của file(s) trong image được xem xét và checksum sẽ được tính toán cho mỗi file. Mỗi last-modified and last-accessed time của file(s) không được xem xét trong checksum này. Trong khi cache tìm kiếm, checksum sẽ so sánh với các checksum của image đã tồn tại. Nếu có 1 vài sự thay đổi trong file(s), như là nội dung và metadata, cache sẽ bị vô hiệu hóa.</li>
<li>Aside from the ADD and COPY commands, cache checking does not look at the files in the container to determine a cache match. For example, when processing a RUN apt-get -y update command the files updated in the container are not examined to determine if a cache hit exists. In that case just the command string itself is used to find a match.</li>
</ul>
<p>Một khi cache bị vô hiệu hóa, tất cả các lệnh Dockerfile tiếp theo sẽ sinh ra 1 image mới và cache sẽ không được sử dụng.</p>
<h1 id="Tong-ket"><a href="#Tong-ket" class="headerlink" title="Tổng kết"></a>Tổng kết</h1><p>Khi xây dựng Dockerfile, hi vọng 1 số tips sau giúp bạn xây dựng tốt hơn:</p>
<ul>
<li>Build context có thể lấy cứ local hoặc remote, khi build 1 lần, hãy xem xét sử dụng stdin để không cần lưu Dockerfile trên máy của bạn luôn.</li>
<li>Exclude with <code>.dockerignore</code>.</li>
<li>Use <strong>multi-stage builds:</strong> giảm kích thước image qua việc Dockerfile chỉ sử dụng image cuối cùng.</li>
<li>Don’t install unnecessary packages.</li>
<li>Decouple applications.</li>
<li>Minimize the number of layers:<ul>
<li>Mỗi instruction tạo ra 1 layer (tính cả layer 0B gọi là các image trung gian tạm thời đi)</li>
<li><code>ADD</code>, <code>COPY</code>, <code>RUN</code> là các instruction làm tăng kích thước images. Ngoài ra, khi copy cả thư mục, hãy xem xét các file thường xuyên thay đổi thì nên tách ra. Chi tiết xem thêm tại Docker instructions.</li>
<li>Xem kích thước các instruction với <code>docker history</code>.</li>
</ul>
</li>
<li>Sort multi-line arguments: sử dụng<code>backslash (\)</code> để PRs của bạn dễ review hơn và tránh lặp các package.</li>
<li>Tận dụng cache khi build.</li>
<li>Parent image (Controller), base image =&gt; base image: image bạn tự custom lại, nên tích hợp thêm cái gì đó hữu ích (BaseController with whereLike) và childrent image: ProductController, HomeController.</li>
</ul>
<h1 id="Tai-lieu-tham-khao"><a href="#Tai-lieu-tham-khao" class="headerlink" title="Tài liệu tham khảo:"></a>Tài liệu tham khảo:</h1><ul>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#general-guidelines-and-recommendations">Dockerfile best practive</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/FramgiaDockerTeam">FramgiaDockerTeam</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>[Docker] General guidelines and recommendations</p><p><a href="http://yoursite.com/2020/04/19/Docker-General-guidelines-and-recommendations/">http://yoursite.com/2020/04/19/Docker-General-guidelines-and-recommendations/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Ming</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-04-19</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-04-10</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/docker-best-practice/">docker-best-practice</a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/mingnv" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/04/21/Docker-Networking-in-Compose/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[Docker] Networking in Compose</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/04/19/Docker-Use-multi-stage-builds/"><span class="level-item">[Docker] Use multi-stage builds</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yoursite.com/2020/04/19/Docker-General-guidelines-and-recommendations/';
            this.page.identifier = '2020/04/19/Docker-General-guidelines-and-recommendations/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'minh' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/spidertocat.png" alt="Minh NV"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Minh NV</p><p class="is-size-6 is-block">_N.V.M_</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hanoi city, Vietnam</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">130</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">34</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">47</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/minhnv2306" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/minhnv2306"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/profile.php?id=100003860456359"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="http://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="http://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AWS-Practitioner/"><span class="level-start"><span class="level-item">AWS Practitioner</span></span><span class="level-end"><span class="level-item tag">26</span></span></a></li><li><a class="level is-mobile" href="/categories/AWS-Training/"><span class="level-start"><span class="level-item">AWS Training</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Authentication/"><span class="level-start"><span class="level-item">Authentication</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-our-code/"><span class="level-start"><span class="level-item">Clean our code</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/Clean-our-code/Clean-code-Robert-C-Martin/"><span class="level-start"><span class="level-item">Clean code - Robert C. Martin</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-our-code/Refactoring-to-Collections/"><span class="level-start"><span class="level-item">Refactoring to Collections</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/MongoDB/"><span class="level-start"><span class="level-item">MongoDB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/"><span class="level-start"><span class="level-item">Development and Operation</span></span><span class="level-end"><span class="level-item tag">33</span></span></a><ul><li><a class="level is-mobile" href="/categories/Development-and-Operation/CircleCI-2-0/"><span class="level-start"><span class="level-item">CircleCI 2.0</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Google-Cloud-Platform/"><span class="level-start"><span class="level-item">Google Cloud Platform</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Laravel/"><span class="level-start"><span class="level-item">Laravel</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Linux-OS/"><span class="level-start"><span class="level-item">Linux OS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Web-Server/"><span class="level-start"><span class="level-item">Web Server</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/JAVaScript/"><span class="level-start"><span class="level-item">JAVaScript</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/JAVaScript/Asynchronous/"><span class="level-start"><span class="level-item">Asynchronous</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/JAVaScript/Event/"><span class="level-start"><span class="level-item">Event</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/JAVaScript/React/"><span class="level-start"><span class="level-item">React</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/JP/"><span class="level-start"><span class="level-item">JP</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/Others/Cong-cu-lap-trinh/"><span class="level-start"><span class="level-item">Công cụ lập trình</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/PHPCS/"><span class="level-start"><span class="level-item">PHPCS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Suu-tam/"><span class="level-start"><span class="level-item">Sưu tầm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Website-Optimization/"><span class="level-start"><span class="level-item">Website Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/"><span class="level-start"><span class="level-item">The Art of Readable Code</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Chapter-1-Code-Should-Be-Easy-to-Understand/"><span class="level-start"><span class="level-item">Chapter 1 - Code Should Be Easy to Understand</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-I-Surface-Level-Improvements/"><span class="level-start"><span class="level-item">Part I - Surface-Level Improvements</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-II-Simplifying-Loops-and-Logic/"><span class="level-start"><span class="level-item">Part II - Simplifying Loops and Logic</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-III-Reorganizing-Your-Code/"><span class="level-start"><span class="level-item">Part III - Reorganizing Your Code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-IV-Selected-Topics/"><span class="level-start"><span class="level-item">Part IV - Selected Topics</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Unit-Test/"><span class="level-start"><span class="level-item">Unit Test</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/special-day/"><span class="level-start"><span class="level-item">special day</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/API/"><span class="tag">API</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CI-CD/"><span class="tag">CI/CD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kanji/"><span class="tag">Kanji</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-command-line/"><span class="tag">Linux command line</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache2/"><span class="tag">apache2</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/async-programing/"><span class="tag">async programing</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/authentication/"><span class="tag">authentication</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-exam-preparation/"><span class="tag">aws exam preparation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-labs/"><span class="tag">aws labs</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aws-certificate/"><span class="tag">aws-certificate</span><span class="tag">25</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-comment/"><span class="tag">clean comment</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-error/"><span class="tag">clean error</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-function/"><span class="tag">clean function</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/collection/"><span class="tag">collection</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/configuration/"><span class="tag">configuration</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-command/"><span class="tag">docker command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-file-format/"><span class="tag">docker compose file format</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-best-practice/"><span class="tag">docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-yml/"><span class="tag">docker-compose.yml</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-instructions-docker-best-practice/"><span class="tag">docker-instructions docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-network/"><span class="tag">docker-network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-volume/"><span class="tag">docker-volume</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event/"><span class="tag">event</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event-notification/"><span class="tag">event notification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/excelfile/"><span class="tag">excelfile</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gcp/"><span class="tag">gcp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/groupby-mysql/"><span class="tag">groupby, mysql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jquery-validation/"><span class="tag">jquery-validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubernetes/"><span class="tag">kubernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongoDB/"><span class="tag">mongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/naming/"><span class="tag">naming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs/"><span class="tag">phpcs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs-phpcsfixer/"><span class="tag">phpcs phpcsfixer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/process-management/"><span class="tag">process management</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-boilerplate/"><span class="tag">react boilerplate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/requests/"><span class="tag">requests</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stripe/"><span class="tag">stripe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sudo-command/"><span class="tag">sudo command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tips-laravel/"><span class="tag">tips laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tracking-php-script/"><span class="tag">tracking php script</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unit-test/"><span class="tag">unit test</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/validation/"><span class="tag">validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vba/"><span class="tag">vba</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vim/"><span class="tag">vim</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#General-guidelines-and-recommendations"><span class="level-left"><span class="level-item">1</span><span class="level-item">General guidelines and recommendations</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Create-ephemeral-containers"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Create ephemeral containers</span></span></a></li><li><a class="level is-mobile" href="#Understand-build-context"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Understand build context</span></span></a></li><li><a class="level is-mobile" href="#Pipe-Dockerfile-through-stdin"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">Pipe Dockerfile through stdin</span></span></a></li><li><a class="level is-mobile" href="#Exclude-with-dockerignore"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Exclude with .dockerignore</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Use-multi-stage-builds"><span class="level-left"><span class="level-item">2</span><span class="level-item">Use multi-stage builds</span></span></a></li><li><a class="level is-mobile" href="#Don’t-install-unnecessary-packages"><span class="level-left"><span class="level-item">3</span><span class="level-item">Don’t install unnecessary packages</span></span></a></li><li><a class="level is-mobile" href="#Decouple-applications"><span class="level-left"><span class="level-item">4</span><span class="level-item">Decouple applications</span></span></a></li><li><a class="level is-mobile" href="#Minimize-the-number-of-layers"><span class="level-left"><span class="level-item">5</span><span class="level-item">Minimize the number of layers</span></span></a></li><li><a class="level is-mobile" href="#Sort-multi-line-arguments"><span class="level-left"><span class="level-item">6</span><span class="level-item">Sort multi-line arguments</span></span></a></li><li><a class="level is-mobile" href="#Leverage-build-cache"><span class="level-left"><span class="level-item">7</span><span class="level-item">Leverage build cache</span></span></a></li><li><a class="level is-mobile" href="#Tong-ket"><span class="level-left"><span class="level-item">8</span><span class="level-item">Tổng kết</span></span></a></li><li><a class="level is-mobile" href="#Tai-lieu-tham-khao"><span class="level-left"><span class="level-item">9</span><span class="level-item">Tài liệu tham khảo:</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-12-05T09:46:19.000Z">2021-12-05</time></p><p class="title"><a href="/2021/12/05/Linux-Some-note-commands/">[Linux]: Some note commands (updating...)</a></p><p class="categories"><a href="/categories/Development-and-Operation/">Development and Operation</a> / <a href="/categories/Development-and-Operation/Linux-OS/">Linux OS</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-12-05T09:32:08.000Z">2021-12-05</time></p><p class="title"><a href="/2021/12/05/Frontend-Notee/">Frontend: Notee</a></p><p class="categories"><a href="/categories/Others/">Others</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-16T14:12:14.000Z">2021-08-16</time></p><p class="title"><a href="/2021/08/16/Section-22-Exam-Preparation-Section/">Section 22: Exam Preparation Section</a></p><p class="categories"><a href="/categories/AWS-Practitioner/">AWS Practitioner</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-16T13:45:59.000Z">2021-08-16</time></p><p class="title"><a href="/2021/08/16/Section-21-AWS-Architecting-Ecosystem/">Section 21: AWS Architecting &amp; Ecosystem</a></p><p class="categories"><a href="/categories/AWS-Practitioner/">AWS Practitioner</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-16T13:45:45.000Z">2021-08-16</time></p><p class="title"><a href="/2021/08/16/Section-20-Other-Services/">Section 20: Other Services</a></p><p class="categories"><a href="/categories/AWS-Practitioner/">AWS Practitioner</a></p></div></article></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://blog.zhangruipeng.me/hexo-theme-icarus/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus blog</span></span><span class="level-right"><span class="level-item tag">blog.zhangruipeng.me</span></span></a></li><li><a class="level is-mobile" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus github</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="Hello, I am Minh" height="28"></a><p class="is-size-7"><span>&copy; 2021 Ming</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>