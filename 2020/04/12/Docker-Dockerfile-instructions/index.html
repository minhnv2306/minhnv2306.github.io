<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[Docker] Dockerfile instructions - Hello, I am Minh</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hello, I am Minh"><meta name="msapplication-TileImage" content="/img/my_favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hello, I am Minh"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Cùng tìm hiểu một vài instructions được sử dụng nhiều trong Dockerfile. Phần này tôi tổng hợp chủ yếu từ Dockerfile best pratice luôn, chỉ có 1 ít đá ké sang Dockerfile reference. Do đó nếu muốn xem c"><meta property="og:type" content="blog"><meta property="og:title" content="[Docker] Dockerfile instructions"><meta property="og:url" content="http://yoursite.com/2020/04/12/Docker-Dockerfile-instructions/"><meta property="og:site_name" content="Hello, I am Minh"><meta property="og:description" content="Cùng tìm hiểu một vài instructions được sử dụng nhiều trong Dockerfile. Phần này tôi tổng hợp chủ yếu từ Dockerfile best pratice luôn, chỉ có 1 ít đá ké sang Dockerfile reference. Do đó nếu muốn xem c"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://images.viblo.asia/137c608b-74a4-43e4-9b38-ffe5793246e6.png"><meta property="article:published_time" content="2020-04-12T12:54:06.000Z"><meta property="article:modified_time" content="2021-04-10T00:07:10.622Z"><meta property="article:author" content="Ming"><meta property="article:tag" content="docker-instructions docker-best-practice"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://images.viblo.asia/137c608b-74a4-43e4-9b38-ffe5793246e6.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://yoursite.com/2020/04/12/Docker-Dockerfile-instructions/"},"headline":"[Docker] Dockerfile instructions","image":["https://images.viblo.asia/137c608b-74a4-43e4-9b38-ffe5793246e6.png"],"datePublished":"2020-04-12T12:54:06.000Z","dateModified":"2021-04-10T00:07:10.622Z","author":{"@type":"Person","name":"Ming"},"description":"Cùng tìm hiểu một vài instructions được sử dụng nhiều trong Dockerfile. Phần này tôi tổng hợp chủ yếu từ Dockerfile best pratice luôn, chỉ có 1 ít đá ké sang Dockerfile reference. Do đó nếu muốn xem c"}</script><link rel="canonical" href="http://yoursite.com/2020/04/12/Docker-Dockerfile-instructions/"><link rel="icon" href="/img/my_favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-112002191-2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-112002191-2');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="Hello, I am Minh" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="http://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-04-12T12:54:06.000Z" title="4/12/2020, 7:54:06 PM">2020-04-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-04-10T00:07:10.622Z" title="4/10/2021, 7:07:10 AM">2021-04-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Development-and-Operation/">Development and Operation</a><span> / </span><a class="link-muted" href="/categories/Development-and-Operation/Docker/">Docker</a></span><span class="level-item">an hour read (About 7170 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">[Docker] Dockerfile instructions</h1><div class="content"><p>Cùng tìm hiểu một vài instructions được sử dụng nhiều trong Dockerfile. Phần này tôi tổng hợp chủ yếu từ Dockerfile best pratice luôn, chỉ có 1 ít đá ké sang Dockerfile reference. Do đó nếu muốn xem chi tiết instruction đó cú pháp và hoạt động chi tiết, hãy vào Dockerfile reference để đọc.<br><a id="more"></a></p>
<h1 id="FROM"><a href="#FROM" class="headerlink" title="FROM"></a>FROM</h1><p>Image được sử dụng làm basic. Bạn có thể sử dụng nó kết hợp với ARG. Tuy nhiên, các ARG được khai báo trước FROM thì sẽ không được sử dụng trong các bước build tiếp theo, do đó bạn cần khai báo lại:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ARG</span> VERSION=latest</span><br><span class="line"><span class="keyword">FROM</span> busybox:$VERSION</span><br><span class="line"><span class="keyword">ARG</span> VERSION</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$VERSION</span> &gt; image_version</span></span><br></pre></td></tr></table></figure><br>Chúng tôi khuyên bạn nên sử dụng các <a target="_blank" rel="noopener" href="https://hub.docker.com/_/alpine/"><strong>Alpine image</strong></a> vì nó được kiểm soát chặt chẽ hơn, kích thước nhỏ (dưới <strong>5MB</strong>) so với các bản Linux đầy đủ.</p>
<h1 id="LABEL"><a href="#LABEL" class="headerlink" title="LABEL"></a>LABEL</h1><p>Phần này có thể sử dụng để bổ sung lưu trữ các thông tin, thông tin sở hữu hoặc bất cứ thông tin gì bạn muốn mô tả thêm về docker. Khi sử dụng string, nó cần đặt trong dấu <strong>“”</strong> và cần escape nếu kí tự đặc biệt:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set one or more individual labels</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> com.example.version=<span class="string">&quot;0.0.1-beta&quot;</span></span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> vendor1=<span class="string">&quot;ACME Incorporated&quot;</span></span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> vendor2=ZENITH\ Incorporated</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> com.example.release-date=<span class="string">&quot;2015-02-12&quot;</span></span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> com.example.version.is-production=<span class="string">&quot;&quot;</span></span></span><br></pre></td></tr></table></figure></p>
<h1 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h1><p><strong>RUN</strong> thường sử dụng để cài phần mềm hoặc package như bạn cần cài trên ubuntu ấy</p>
<p><strong>RUN</strong> sẽ thực thi 1 vài lệnh trên 1 tầng mới ở đầu image hiện tại và commit kết quả. Kết quả được ghi lại và sử dụng ở các bước tiếp theo trong Dockerfile</p>
<p>RUN sẽ có 2 cấu trúc:</p>
<ul>
<li><code>RUN &lt;command&gt;</code> (<strong><em>shell</em></strong> form, the command is run in a shell, which by default is /bin/sh -c on Linux or cmd /S /C on Windows)</li>
<li><code>RUN [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</code> (<strong><em>exec</em></strong> form)</li>
<li><strong>(Mặc định thì nó sẽ là shell form)</strong></li>
</ul>
<p><strong><em>exec</em></strong> form cũng được sử dụng nhiều, nó cũng có thể sử dụng để chạy <strong><em>shell</em></strong> form:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN [&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo hello&quot;]</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Note: Không giống như <strong><em>shell</em></strong> form, <strong><em>exec</em></strong> form không gọi 1 command shell. Điều đó có nghĩa các xử lý shell thông thường sẽ không diễn ra. Ví dụ RUN [ “echo”, “$HOME” ] sẽ không thay thế biến $HOME. Nếu bạn muốn thực thi shell thì sử dụng shell form hoặc thực thi shell 1 cách trực tiếp, ví dụ RUN [ “sh”, “-c”, “echo $HOME” ]. Khi sử dụng exec for và thực thi shell trực tiếp như shell form, nó là shell làm việc với mở rộng với biến môi trường chứ không phải docker.</p>
</blockquote>
<blockquote>
<p>Note (Bản gốc): Unlike the <strong><em>shell</em></strong> form, the <strong><em>exec</em></strong> form does not invoke a command shell. This means that normal shell processing does not happen. For example, RUN [ “echo”, “$HOME” ] will not do variable substitution on $HOME. If you want shell processing then either use the shell form or execute a shell directly, for example: RUN [ “sh”, “-c”, “echo $HOME” ]. When using the exec form and executing a shell directly, as in the case for the shell form, it is the shell that is doing the environment variable expansion, not docker.</p>
</blockquote>
<blockquote class="colorquote warning"><p>Cache của RUN không bị tự động vô hiệu trong quá trình build tiếp theo (tức là được sử dụng lại). Cache của lệnh <code>RUN apt-get dist-upgrade -y</code> sẽ được sử dụng lại trong lần build tiếp theo. Cache sẽ vô hiệu hóa khi bạn build lại với tùy chọn <code>--no-cache</code> như <code>docker build --no-cache</code></p>
</blockquote>
<h2 id="APT-GET"><a href="#APT-GET" class="headerlink" title="APT-GET"></a>APT-GET</h2><p>Đa số trường hợp sử dụng RUN là để chạy ứng dụng của <code>apt-get</code>. Bởi vì nó để cài đặt các package chạy lệnh <code>RUN apt-get</code>, tuy nhiên cũng có 1 vài chú ý với lệnh này:</p>
<ul>
<li><p>Tránh <code>RUN apt-get upgrade</code> và <code>dist-upgrade</code> vì nhiều package trong số các package thiết yếu của image cha không thể nâng cấp bên trong 1 container không có đặc quyền. Nếu 1 package được chứa trong parent image đã out-of-date, liên hệ đội ngũ maintain nó</p>
</li>
<li><p>Hãy sử dụng kết hợp <code>RUN apt-get update</code> kết hợp với <code>apt-get install</code> như ví dụ sau:</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update &amp;&amp; apt-get install -y \</span></span><br><span class="line"><span class="bash">    aufs-tools \</span></span><br><span class="line"><span class="bash">    automake \</span></span><br><span class="line"><span class="bash">    build-essential \</span></span><br><span class="line"><span class="bash">    curl \</span></span><br><span class="line"><span class="bash">    dpkg-sig \</span></span><br><span class="line"><span class="bash">    libcap-dev \</span></span><br><span class="line"><span class="bash">    libsqlite3-dev \</span></span><br><span class="line"><span class="bash">    mercurial \</span></span><br><span class="line"><span class="bash">    reprepro \</span></span><br><span class="line"><span class="bash">    ruby1.9.1 \</span></span><br><span class="line"><span class="bash">    ruby1.9.1-dev \</span></span><br><span class="line"><span class="bash">    s3cmd=1.1.* \</span></span><br><span class="line"><span class="bash"> &amp;&amp; rm -rf /var/lib/apt/lists/*</span></span><br></pre></td></tr></table></figure>
<p>Chạy các lệnh như thực thi trong container. Sử dụng dấu phân cách để tách biệt nhiều lệnh trên nhiều dòng cho dễ đọc và maintain:</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="bash"> /bin/bash -c <span class="string">&#x27;source $HOME/.bashrc; \</span></span></span><br><span class="line"><span class="bash">	<span class="built_in">echo</span> <span class="variable">$HOME</span><span class="string">&#x27;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="USING-PIPES"><a href="#USING-PIPES" class="headerlink" title="USING PIPES"></a>USING PIPES</h2></li>
</ul>
<p>Một vài lệnh RUN phụ thuộc vào kết quả output của 1 vài lệnh khác, lúc đó, hãy sử dụng pipe <strong>(|)</strong><br><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN wget -O - https:<span class="comment">//some.site | wc -l &gt; /number</span></span><br></pre></td></tr></table></figure><br><strong>If you want the command to fail due to an error at any stage in the pipe, prepend set -o pipefail &amp;&amp; to ensure that an unexpected error prevents the build from inadvertently succeeding. For example:</strong><br><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN set -o pipefail &amp;&amp; wget -O - https:<span class="comment">//some.site | wc -l &gt; /number</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Note: Không hỗ trợ tùy chọn -o pipefail</p>
</blockquote>
<h1 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h1><p>The CMD instruction has three forms:</p>
<ul>
<li><code>CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]</code> (exec form, this is the preferred form)</li>
<li><code>CMD [&quot;param1&quot;,&quot;param2&quot;]</code> (as default parameters to ENTRYPOINT)</li>
<li><code>CMD command param1 param2</code> (shell form)</li>
</ul>
<p>Hai cách đầu thường được sử dụng nhiều, đặc biệt là các số 2. Nó thường kết hợp với <strong>ENTRYPOINT</strong> và bạn nên đọc ở phần sau.</p>
<p>Lệnh CMD nên được sử dụng để chạy phần mềm được chứa trong image của bạn cùng với 1 vài tham số (ví dự như chạy <code>nodejs: node tenfile</code>, hay <code>php artisan serve</code> trong Laravel ấy =)).</p>
<p><strong>CMD</strong> đa số nên được sử dụng dưới dạng :<br><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CMD [<span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>…]</span><br></pre></td></tr></table></figure><br>Ví dụ như apache<br><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CMD [<span class="string">&quot;apache2&quot;</span>,<span class="string">&quot;-DFOREGROUND&quot;</span>]</span><br></pre></td></tr></table></figure><br>Trong đa số các trường hợp khác, CMD được sử dụng như 1 sự tích hợp <code>shell</code>, như <code>bash</code>, <code>python</code> và <code>perl</code>. Ví dụ <code>CMD [&quot;perl&quot;, &quot;-de0&quot;], CMD [&quot;python&quot;], or CMD [&quot;php&quot;, &quot;-a&quot;]</code>. Sử dụng các lệnh như trên tương đương với việc bạn thực thi docker như <code>docker run -it python</code>. CMD sẽ rất hiếm khi được sử dụng theo cách <code>CMD [&quot;param&quot;, &quot;param&quot;]</code> kết hợp với ENTRYPOINT, trừ khi bạn và người dùng đã quá khen thuộc với cách sử dụng <strong>ENTRYPOINT</strong> hoạt động như thế nào</p>
<h1 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE"></a>EXPOSE</h1><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPOSE</span> &lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]</span><br></pre></td></tr></table></figure>
<p>Bình thường các Docker container hoạt động độc lập, không chia sẽ cho nhau cái gì, ai biết nhà nấy (MySQL biết MySQL, Nginx biết Nginx, không mở lắng nghe kết nối từ đâu đến). Nhưng như vậy không ổn, chúng cần lắng nghe và kết nối với nhau để tạo được 1 ứng dụng. EXPOSE giúp chúng ta làm việc này.</p>
<p>Lệnh EXPOSE chỉ ra cổng nào mà 1 container lắng nghe kết nối. Do đó bạn nên sử dụng các cổng truyền thống và chung nhất cho ứng dụng của mình. Ví dụ như Apache sẽ EXPOSE cổng 80 trong khi image của MongoDB sẽ sử dụng EXPOSE 27017</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EXPOSE 80&#x2F;tcp</span><br><span class="line">EXPOSE 80&#x2F;udp</span><br></pre></td></tr></table></figure>
<p>Để truy cập bên ngoài (như local machine chẳng hạn), bạn có thể sử dụng docker run với với ánh xạ cổng được chỉ định đến cổng mà bạn lựa chọn, với tùy chọn -p.</p>
<p>Đối với các conatianer liên kết với nhau, Docker cung cấp các biến môi trường đối với đường dẫn từ container nhận được trở về container nguồn (ví dụ như biến MYSQL_PORT_3306_TCP).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 80:80&#x2F;tcp -p 80:80&#x2F;udp ...</span><br></pre></td></tr></table></figure>
<p>It functions as a type of documentation between the person who builds the image and the person who runs the container, about which ports are intended to be published.</p>
<p>Giải thích: EXPOSE có thể có hoặc không, container của bạn vẫn chạy và có thể vẫn được expose bình thường với docker-compose. Tuy nhiên hãy thêm nó, vì cũng chẳng tốn công gì, và coi nó như 1 dạng của tài liệu truyền đạt thông tin giữa người xây dựng container và người chạy container, về những cổng nào mà sẽ được publish</p>
<h1 id="ENV"><a href="#ENV" class="headerlink" title="ENV"></a>ENV</h1><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> &lt;key&gt; &lt;value&gt;</span><br><span class="line"><span class="keyword">ENV</span> &lt;key&gt;=&lt;value&gt; ...</span><br></pre></td></tr></table></figure>
<p>Cho phép phần mềm của bạn dễ dàng chạy, bạn có thể sử dụng ENV cập nhật PATH trong biến môi trường cho những phần mềm được cài trong container. Ví dụ <code>ENV PATH /usr/local/nginx/bin:$PATH</code> để chắc chắn rằng <code>CMD [&quot;nginx&quot;]</code> hoạt động.</p>
<p>Lệnh ENV cũng hữu ích khi cung cấp các biến môi trường cho bạn, như các const trong khi lập trình, hoặc các phiên bản để bạn dễ dàng bảo trì hơn:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> PG_MAJOR <span class="number">9.3</span></span><br><span class="line"><span class="keyword">ENV</span> PG_VERSION <span class="number">9.3</span>.<span class="number">4</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> curl -SL http://example.com/postgres-<span class="variable">$PG_VERSION</span>.tar.xz | tar -xJC /usr/src/postgress &amp;&amp; …</span></span><br><span class="line"><span class="keyword">ENV</span> PATH /usr/local/postgres-$PG_MAJOR/bin:$PATH</span><br></pre></td></tr></table></figure><br>Mỗi dòng ENV tạo 1 ra 1 tầng trung gian mới, tương tự như RUN. Điều đó có nghĩa, thậm chí bạn đã unset biến môi trường ở 1 tầng nào đó trong tương lai, nó vẫn tồn tại ở layer này và giá trị của nó không bị hủy bỏ. Bạn có thể build Dockerfile sau và kiểm tra nó<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> alpine</span><br><span class="line"><span class="keyword">ENV</span> ADMIN_USER=<span class="string">&quot;mark&quot;</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$ADMIN_USER</span> &gt; ./mark</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">unset</span> ADMIN_USER</span></span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker run --rm test sh -c &#39;echo $ADMIN_USER&#39;</span><br><span class="line"></span><br><span class="line">mark</span><br></pre></td></tr></table></figure><br>Để ngăn chặn việc này, hãy xử nó ở chính layer đơn đó bằng <strong>;</strong> hoặc <strong>&amp;&amp;</strong><br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> alpine</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">export</span> ADMIN_USER=<span class="string">&quot;mark&quot;</span> \</span></span><br><span class="line"><span class="bash">    &amp;&amp; <span class="built_in">echo</span> <span class="variable">$ADMIN_USER</span> &gt; ./mark \</span></span><br><span class="line"><span class="bash">    &amp;&amp; <span class="built_in">unset</span> ADMIN_USER</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> sh</span></span><br></pre></td></tr></table></figure><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run --rm <span class="built_in">test</span> sh -c <span class="string">&#x27;echo $ADMIN_USER&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="ADD-or-COPY"><a href="#ADD-or-COPY" class="headerlink" title="ADD or COPY"></a>ADD or COPY</h1><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="bash"> [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> [--chown=&lt;user&gt;:&lt;group&gt;] [<span class="string">&quot;&lt;src&gt;&quot;</span>,... <span class="string">&quot;&lt;dest&gt;&quot;</span>] (this form is required <span class="keyword">for</span> paths containing whitespace)</span></span><br></pre></td></tr></table></figure>
<p>Cả 2 lệnh này đều thực hiện copy new files, thư mục từ <code>&lt;src&gt;</code> và thêm nó vào thư mục filesystem <code>&lt;dest&gt;</code> trong image.<br><blockquote class="colorquote info"><ul>
<li>The <strong><code>ADD</code></strong> instruction copies new files, directories or remote file URLs from <code>&lt;src&gt;</code> and adds them to the filesystem of the image at the path <code>&lt;dest&gt;</code>.</li>
<li>The <strong><code>COPY</code></strong> instruction copies new files or directories from <code>&lt;src&gt;</code> and adds them to the filesystem of the container at the path <code>&lt;dest&gt;</code>.</li>
</ul>
</blockquote><br>Mặc dù nhìn thì ADD và COPY tương tự về chức năng, nhưng nói chung <strong>COPY</strong> vẫn được ưa chuộng hơn. Đó là bởi vì nó minh bạch nhiều hơn <strong>ADD</strong>. <strong>COPY</strong> chỉ hỗ trợ các phép sao chép cơ bản các file local vào trong container trong khi <strong>ADD</strong> có 1 vài chức năng (như giải nén file tar, remote URL support) cái mà không được minh bạch ngay lập tức. Do đó, cách sử dụng tốt nhất cho <strong>ADD</strong> là tự động trích xuât tệp <strong>tar</strong> local vào image như <code>ADD rootfs.tar.xz /</code></p>
<p>Nếu bạn có nhiều bước trong <code>Dockerfile</code> sử dụng các file khác nhau trong context của bạn, <strong>COPY từng file một hơn là copy tất cả trong 1 lần</strong>. Điều này để chắc chắn rằng mỗi bước build, cache sẽ bị vô hiệu hóa (buộc các bước này phải chạy lại) nếu các tệp được yêu cầu cụ thể thay đổi (thay vì chạy lại hết mà 1 file có thể không liên quan thay đổi).</p>
<p>Ví dụ:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="bash"> requirements.txt /tmp/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install --requirement /tmp/requirements.txt</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /tmp/</span></span><br></pre></td></tr></table></figure><br>Kết quả  việc vô hiệu hóa cache của <strong>RUN</strong> sẽ ít hơn bến bạn đặt <code>COPY . /tmp/</code> trước nó (vì khi thay đổi <code>requirements.txt</code> mới bị vô hiệu hóa cache. Bạn đặt <code>COPY . /tmp/</code> trước thì thay đổi bất kì file nào đều vô hiệu hóa cache)</p>
<p>Do vấn đề kích thước (size) của image, việc sử dụng <strong>ADD</strong> để nạp các package từ remote URLs <strong>KHÔNG</strong> được khuyến khích. Thay vào đó, bạn nên sử dụng <code>curl</code> hoặc <code>wget</code>. Và bằng cách này, bạn có thể xóa file đi sau khi bạn giải nén và sử dụng để không ảnh hưởng đến các layer khác trong image. Ví dụ thay vì như vậy:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="bash"> http://example.com/big.tar.xz /usr/src/things/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> tar -xJf /usr/src/things/big.tar.xz -C /usr/src/things</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> make -C /usr/src/things all</span></span><br></pre></td></tr></table></figure><br>Thì bạn nên:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="bash"> mkdir -p /usr/src/things \</span></span><br><span class="line"><span class="bash">    &amp;&amp; curl -SL http://example.com/big.tar.xz \</span></span><br><span class="line"><span class="bash">    | tar -xJC /usr/src/things \</span></span><br><span class="line"><span class="bash">    &amp;&amp; make -C /usr/src/things all</span></span><br></pre></td></tr></table></figure></p>
<h1 id="ENTRYPOINT"><a href="#ENTRYPOINT" class="headerlink" title="ENTRYPOINT"></a>ENTRYPOINT</h1><p><strong>ENTRYPOINT</strong> có 2 kiểu:</p>
<ul>
<li><code>ENTRYPOINT [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</code> (exec form, preferred)</li>
<li><code>ENTRYPOINT command param1 param2</code> (shell form)</li>
</ul>
<p>Một <strong>ENTRYPOINT</strong> cho phép bạn cấu hình để thực thi container</p>
<p>Ví dụ start nginx với cổng 80:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> -i -t --rm -p 80:80 nginx</span></span><br></pre></td></tr></table></figure><br><code>docker run &lt;image&gt;</code> sẽ được thêm vào sau tất cả các thành phần với <em>exec</em> form <strong>ENTRYPOINT</strong> và sẽ ghi đè tất cả các thành phần được chỉ định sử dụng <strong>CMD</strong></p>
<p><strong>shell</strong> form chặn 1 vài CMD hoặc lệnh run với 1 vài tham số nhưng nhược điểm của kiểu <strong>ENTRYPOINT</strong> này sẽ bắt đầu như là 1 subcommand của <code>/bin/sh -c</code>, cái mà sẽ không có tín hiệu. Điều đó có nghĩa thực thi này sẽ không phải là PID của container 1 và sẽ không nhận được các tín hiệu từ Unix - do đó sự thực thi container này sẽ không nhận một SIGTERM từ <code>docker stop &lt;container&gt;</code></p>
<p>Chỉ lệnh <strong>ENTRYPOINT</strong> cuối cùng trong <code>Dockerfile</code> là có hiệu lực.</p>
<h2 id="Exec-form-ENTRYPOINT-example"><a href="#Exec-form-ENTRYPOINT-example" class="headerlink" title="Exec form ENTRYPOINT example"></a>Exec form ENTRYPOINT example</h2><p>Bạn có thể sử dụng exec form của ENTRYPOINT để thiết lập lệnh mặc định và các đối số và sau đó sử dụng CMD để thiết lập thêm các tham số có nhiều khả năng thay đổi</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;top&quot;</span>, <span class="string">&quot;-b&quot;</span>]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;-c&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<p>Và khi bạn chạy container, bạn sẽ nhìn thấy <code>top</code> chỉ là 1 tiến trình:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it --rm --name <span class="built_in">test</span>  top -H</span><br><span class="line">top - 08:25:00 up  7:27,  0 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">Threads:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu(s):  0.1 us,  0.1 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">KiB Mem:   2056668 total,  1616832 used,   439836 free,    99352 buffers</span><br><span class="line">KiB Swap:  1441840 total,        0 used,  1441840 free.  1324440 cached Mem</span><br><span class="line"></span><br><span class="line">PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND</span><br><span class="line">1 root      20   0   19744   2336   2080 R  0.0  0.1   0:00.04 top</span><br></pre></td></tr></table></figure><br>Để xem kết quả nhiều hơn nữa, bạn có thể sử dụng <code>docker exec</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ docker <span class="built_in">exec</span> -it <span class="built_in">test</span> ps aux</span><br><span class="line">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root         1  2.6  0.1  19752  2352 ?        Ss+  08:24   0:00 top -b -H</span><br><span class="line">root         7  0.0  0.1  15572  2164 ?        R+   08:25   0:00 ps aux</span><br></pre></td></tr></table></figure><br>Và bạn có thể gửi 1 request <code>top</code> để tắt docker đang sử dụng đi <code>docker stop test</code>.</p>
<p>Một ví dụ khác sử dụng <strong>ENTRYPOINT</strong> để chạy Apache:</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> debian:stable</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update &amp;&amp; apt-get install -y --force-yes apache2</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span> <span class="number">443</span></span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> [<span class="string">&quot;/var/www&quot;</span>, <span class="string">&quot;/var/log/apache2&quot;</span>, <span class="string">&quot;/etc/apache2&quot;</span>]</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;/usr/sbin/apache2ctl&quot;</span>, <span class="string">&quot;-D&quot;</span>, <span class="string">&quot;FOREGROUND&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<p>Nếu bạn cần viết 1 script khởi động của 1 sự thực thi đơn, bạn có thể chắc chắn rằng lệnh cuối cùng nhận được tín hiệu Unix bằng cách sử dụng <code>exec</code> và <code>gosu</code> commands<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$1</span>&quot;</span> = <span class="string">&#x27;postgres&#x27;</span> ]; <span class="keyword">then</span></span><br><span class="line">    chown -R postgres <span class="string">&quot;<span class="variable">$PGDATA</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="subst">$(ls -A <span class="string">&quot;<span class="variable">$PGDATA</span>&quot;</span>)</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        gosu postgres initdb</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">exec</span> gosu postgres <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br></pre></td></tr></table></figure><br>Cuối cùng, nếu bạn cần thêm 1 số sự dọn dẹp (hoặc kết nối với container khác) khi shutdown hoặc đang có nhiều hơn 1 sự thực thi, bạn có thể cần chắc chắn rằng script <strong>ENTRYPOINT</strong> nhận Unix signals, vượt qua chúng và sau đó thực hiện 1 số công việc khác:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># Note: I&#x27;ve written this using sh so it works in the busybox container too</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># USE the trap if you need to also do manual cleanup after the service is stopped,</span></span><br><span class="line"><span class="comment">#     or need to start multiple services in the one container</span></span><br><span class="line"><span class="built_in">trap</span> <span class="string">&quot;echo TRAPed signal&quot;</span> HUP INT QUIT TERM</span><br><span class="line"></span><br><span class="line"><span class="comment"># start service in background here</span></span><br><span class="line">/usr/sbin/apachectl start</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[hit enter key to exit] or run &#x27;docker stop &lt;container&gt;&#x27;&quot;</span></span><br><span class="line"><span class="built_in">read</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># stop service and clean up here</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;stopping apache&quot;</span></span><br><span class="line">/usr/sbin/apachectl stop</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;exited <span class="variable">$0</span>&quot;</span></span><br></pre></td></tr></table></figure><br>If you run this image with <code>docker run -it --rm -p 80:80 --name test apache</code>, you can then examine the container’s processes with docker exec, or docker top, and then ask the script to stop Apache:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ docker <span class="built_in">exec</span> -it <span class="built_in">test</span> ps aux</span><br><span class="line">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root         1  0.1  0.0   4448   692 ?        Ss+  00:42   0:00 /bin/sh /run.sh 123 cmd cmd2</span><br><span class="line">root        19  0.0  0.2  71304  4440 ?        Ss   00:42   0:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data    20  0.2  0.2 360468  6004 ?        Sl   00:42   0:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data    21  0.2  0.2 360468  6000 ?        Sl   00:42   0:00 /usr/sbin/apache2 -k start</span><br><span class="line">root        81  0.0  0.1  15572  2140 ?        R+   00:44   0:00 ps aux</span><br><span class="line">$ docker top <span class="built_in">test</span></span><br><span class="line">PID                 USER                COMMAND</span><br><span class="line">10035               root                &#123;run.sh&#125; /bin/sh /run.sh 123 cmd cmd2</span><br><span class="line">10054               root                /usr/sbin/apache2 -k start</span><br><span class="line">10055               33                  /usr/sbin/apache2 -k start</span><br><span class="line">10056               33                  /usr/sbin/apache2 -k start</span><br><span class="line">$ /usr/bin/time docker stop <span class="built_in">test</span></span><br><span class="line"><span class="built_in">test</span></span><br><span class="line">real	0m 0.27s</span><br><span class="line">user	0m 0.03s</span><br><span class="line">sys	0m 0.03s</span><br></pre></td></tr></table></figure><br>Một vài chú ý tương tự <strong>RUN</strong></p>
<blockquote>
<p>Note: The exec form is parsed as a JSON array, which means that you must use double-quotes (“) around words not single-quotes (‘).</p>
<p>Note: Unlike the shell form, the exec form does not invoke a command shell. This means that normal shell processing does not happen. For example, ENTRYPOINT [ “echo”, “$HOME” ] will not do variable substitution on $HOME. If you want shell processing then either use the shell form or execute a shell directly, for example: ENTRYPOINT [ “sh”, “-c”, “echo $HOME” ]. When using the exec form and executing a shell directly, as in the case for the shell form, it is the shell that is doing the environment variable expansion, not docker.</p>
</blockquote>
<h2 id="Shell-form-ENTRYPOINT-example"><a href="#Shell-form-ENTRYPOINT-example" class="headerlink" title="Shell form ENTRYPOINT example"></a>Shell form ENTRYPOINT example</h2><p>Thực thi các lệnh shell</p>
<h2 id="Understand-how-CMD-and-ENTRYPOINT-interact"><a href="#Understand-how-CMD-and-ENTRYPOINT-interact" class="headerlink" title="Understand how CMD and ENTRYPOINT interact"></a>Understand how CMD and ENTRYPOINT interact</h2><p>Cả CMD và ENTRYPOINT đều được sử dụng để định nghĩa ra các lệnh sẽ được thực thi để chạy container. Tuy nhiên có 1 vài rules kết hợp 2 lệnh này bạn cần biết:</p>
<ul>
<li>Dockerfile nên chỉ có 1 lệnh <strong>CMD</strong> hoặc <strong>ENTRYPOINT</strong></li>
<li><strong>ENTRYPOINT</strong> nên được xác định khi sử dụng container như là một thực thi.</li>
<li><strong>CMD</strong> nên được sử dụng như 1 cách định nghĩa các đối số mặc định của 1 <strong>ENTRYPOINT</strong> hoặc là để thực thi 1 ad-hoc comamnd trong 1 container</li>
<li>CMD sẽ bị ghi đè khi chạy container với các đối số thay thế</li>
</ul>
<p>Bảng sau sẽ chỉ ra lệnh được thực thi thực sự cho mỗi sự kết hợp ENTRYPOINT / CMD<br><img src="https://images.viblo.asia/137c608b-74a4-43e4-9b38-ffe5793246e6.png" alt=""></p>
<blockquote>
<p>Chú ý: Nếu CMD được xác định từ 1 base image, setting ENTRYPOINT sẽ reset CMD về 1 giá trị trống. Trong trường hợp này, CMD cần phải được xác định trong current image để có giá trị</p>
</blockquote>
<h1 id="VOLUME"><a href="#VOLUME" class="headerlink" title="VOLUME"></a>VOLUME</h1><blockquote class="colorquote info"><p>The VOLUME instruction creates a mount point with the specified name and marks it as holding externally mounted volumes from native host or other containers</p>
</blockquote>
<blockquote class="colorquote info"><p>Lệnh này để tạo 1 điểm liên kết (mount point) với tên rõ ràng và đánh dấu nó như là nơi lưu trữ volumes được mount ra ngoài từ host lưu trữ hoặc containers khác.</p>
</blockquote>
<p>Giá trị của nó có thể là mảng JSON <code>VOLUME [&quot;/var/log/&quot;]</code> hoặc plain string với nhiều đối số như <code>VOLUME /var/log</code> or <code>VOLUME /var/log /var/db</code></p>
<p>Lệnh <code>docker run</code> khởi tạo 1 volume được tạo mới với 1 vài dữ liệu đã tồn tại trong location được chỉ định từ base image. Ví dụ:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mkdir /myvol</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> &gt; /myvol/greeting</span></span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> /myvol</span></span><br></pre></td></tr></table></figure><br>Kết quả Dockerfile trong 1 image khi chạy docker run tạo ra 1 điểm liên kết tại thư mục /myvol và copy greeting file vào trong volumn được tạo mới đó.</p>
<p>Notes about specifying volumes</p>
<ul>
<li><strong>Volumes on Windows-based containers</strong>: Khi sử  dụng Windows-based containers, đích của 1 volumn trong 1 container phải là 1 trong:<ul>
<li>a non-existing or empty directory</li>
<li>a drive other than C:</li>
</ul>
</li>
<li><strong>Changing the volume from within the Dockerfile</strong>: Nếu 1 vài bước build thay đổi dữ liệu bên trong volumne sau khi nó được khai báo, các thay đổi này sẽ bị loại bỏ<br>(Hiểu là đã VOLUMNE rồi mà lệnh sau trong Dockerfile thay đổi file trong thư mục đó nữa thì không được cập nhật đâu :D =&gt; chưa thử)</li>
<li><strong>JSON formatting</strong>: Khi sử dụng JSON array bạn phải sử dụng dấu nháy kép “ thay vì nháy đơn ‘</li>
<li><strong>The host directory is declared at container run-timer</strong>: Thư mục host (mountpoint) về bản chất, phụ thuộc vào host (host-dependent). Điều này để bảo vệ tính di động của image, vì một thư mục của host không thể đảm bảo rằng nó đã có trên tất cả các hosts. Vì lí do này, bạn không thể mount 1 thư mục host từ trong Dockerfile. Lệnh VOLUME không hỗ trợ việc chỉ định một tham số <code>host-dir</code>. Bạn phải chỉ định mountpoint được bạn tạo ra hoặc khi chạy container (tôi đang hiểu phần này là các thư mục có sẵn của host thì không mount được, ví dụ như không mount thư mục /var từ container ubuntu sang được vì nó thuộc về host, chỉ mount những file, thư mục mình tạo ra thôi :D)</li>
</ul>
<h1 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USER &lt;user&gt;[:&lt;group&gt;] or</span><br><span class="line">USER &lt;UID&gt;[:&lt;GID&gt;]</span><br></pre></td></tr></table></figure>
<p>Lệnh này tạo tập người dùng (hoặc UID) và nhóm người dùng (GID) để sử dụng khi chạy image cho các lệnh RUN, CMD và ENTRYPOINT trong Dockerfile</p>
<blockquote>
<p>Warning: When the user doesn’t have a primary group then the image (or the next instructions) will be run with the root group.</p>
</blockquote>
<p>On Windows, the user must be created first if it’s not a built-in account. This can be done with the net user command called as part of a Dockerfile.</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> microsoft/windowsservercore</span><br><span class="line"><span class="comment"># Create Windows user in the container</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> net user /add patrick</span></span><br><span class="line"><span class="comment"># Set it for subsequent commands</span></span><br><span class="line"><span class="keyword">USER</span> patrick</span><br></pre></td></tr></table></figure>
<h1 id="WORKDIR"><a href="#WORKDIR" class="headerlink" title="WORKDIR"></a>WORKDIR</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WORKDIR &#x2F;path&#x2F;to&#x2F;workdir</span><br></pre></td></tr></table></figure>
<p>Lệnh này chỉ ra tập các thư mục để làm việc với các lệnh RUN, CMD, ENTRYPOINT, COPY và ADD trong Dockerfile. Nếu WORKDIR không tồn tại, nó sẽ được tạo thậm chí nếu nó không được sử dụng trong 1 các bước của Dockerfile.</p>
<p>Lệnh WORKDIR có thể sử dụng nhiều lần trong 1 Dockerfile. Nếu là một đường dẫn tuyệt đối, nó sẽ có liên quan đến đường dẫn của lệnh WORKDIR trước đó</p>
<p>Ví dụ:<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /a</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> b</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> c</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">pwd</span></span></span><br></pre></td></tr></table></figure><br>Thì lệnh <code>pwd</code> sẽ được thực thi trong thư mục <code>/a/b/c</code></p>
<p>Lệnh <code>WORKDIR</code> có thể phân giải được các biến môi trường sử dụng bởi <code>ENV</code><br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> DIRPATH /path</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> <span class="variable">$DIRPATH</span>/<span class="variable">$DIRNAME</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">pwd</span></span></span><br></pre></td></tr></table></figure></p>
<h1 id="ARG"><a href="#ARG" class="headerlink" title="ARG"></a>ARG</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARG &lt;name&gt;[&#x3D;&lt;default value&gt;]</span><br></pre></td></tr></table></figure>
<p>Sử dụng để định nghĩa các biến mà người dùng có thể truyền động khi build với lệnh docker build sử dụng flag –build-arg <varname>=<value>. Hoặc có thể sử dụng trong Dockerfile<br><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> busybox</span><br><span class="line"><span class="keyword">ARG</span> user1</span><br><span class="line"><span class="keyword">ARG</span> buildno</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h1 id="Tong-ket"><a href="#Tong-ket" class="headerlink" title="Tổng kết"></a>Tổng kết</h1><ul>
<li><strong>FROM</strong> chỉ ra chúng ta base image chúng ta sử dụng, <strong>LABEL</strong> bổ sung các thông tin liên quan đến bản quyền, bổ sung thông tin</li>
<li><strong>RUN</strong> được sử dụng kết hợp <strong>apt-get</strong>, thường được sử dụng cài đặt package. Ngoài ra nó cũng được sử dụng chạy các <code>bash</code> hoặc các <code>php</code>, <code>go</code>, <code>python</code> script</li>
<li><strong>ENV</strong> sử dụng để gán các biến <code>CONST</code> như lập trình, như vậy code của bạn sẽ dễ dàng theo dõi hơn.</li>
<li><strong>CMD</strong> và ENTRYPOINT được sử dụng để chạy các lệnh bật container của bạn (như bật Apache2, nginx, nodejs …)</li>
<li>Một container được tạo ra sẽ độc lập với các container khác. Do đó cần có 1 số tham số để giao tiếp với nhau<ul>
<li><strong>EXPOSE</strong>: mở 1 cổng lắng nghe kết nối ra bên ngoài</li>
<li><strong>VOLUME</strong>: chia sẻ file, thư mục ra ngoài host hoặc các container khác</li>
<li><strong>ADD</strong>, <strong>COPY</strong>: copy thư mục từ host vào container</li>
</ul>
</li>
<li><strong>RUN</strong>, <strong>ENTRYPOINT</strong>, <strong>CMD</strong> có 2 dạng và <em>exec</em> form và <em>shell</em> form. (<strong>CMD</strong> có thêm 1 dạng nữa chỉ nhận tham số từ <strong>ENTRYPOINT</strong>).  Chúng ta thử xem 2 form này có gì khác biệt nhé:</li>
</ul>
<p><strong>Exec form rộng hơn shell form, trỏ được thư mục nào để thực thi lệnh</strong>. </p>
<p>Shell form lệnh sẽ chạy trong 1 shell, cái mà được định nghĩa là <code>/bin/sh -c</code> trên Linux hoặc <code>cmd /S /C</code> trên Windows<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Shell form</span></span><br><span class="line">RUN /bin/bash -c <span class="string">&#x27;source $HOME/.bashrc; \</span></span><br><span class="line"><span class="string">echo $HOME&#x27;</span></span><br></pre></td></tr></table></figure><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Exec form</span></span><br><span class="line">FROM debian:stable</span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install -y --force-yes apache2</span><br><span class="line">EXPOSE 80 443</span><br><span class="line">VOLUME [<span class="string">&quot;/var/www&quot;</span>, <span class="string">&quot;/var/log/apache2&quot;</span>, <span class="string">&quot;/etc/apache2&quot;</span>]</span><br><span class="line">ENTRYPOINT [<span class="string">&quot;/usr/sbin/apache2ctl&quot;</span>, <span class="string">&quot;-D&quot;</span>, <span class="string">&quot;FOREGROUND&quot;</span></span><br></pre></td></tr></table></figure><br><strong>Shell cũng có thể sử dụng từ exec form</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN [<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo hello&quot;</span>]</span><br></pre></td></tr></table></figure><br><strong>Và một note nữa là dùng exec form <code>RUN [ &quot;echo&quot;, &quot;$HOME&quot; ]</code></strong></p>
<blockquote>
<p>Note: Unlike the shell form, the exec form does not invoke a command shell. This means that normal shell processing does not happen. For example, ENTRYPOINT [ “echo”, “$HOME” ] will not do variable substitution on $HOME. If you want shell processing then either use the shell form or execute a shell directly, for example: ENTRYPOINT [ “sh”, “-c”, “echo $HOME” ]. When using the exec form and executing a shell directly, as in the case for the shell form, it is the shell that is doing the environment variable expansion, not docker.</p>
</blockquote>
<blockquote>
<p>Note: Unlike the shell form, the exec form does not invoke a command shell. This means that normal shell processing does not happen. For example, CMD [ “echo”, “$HOME” ] will not do variable substitution on $HOME. If you want shell processing then either use the shell form or execute a shell directly, for example: CMD [ “sh”, “-c”, “echo $HOME” ]. When using the exec form and executing a shell directly, as in the case for the shell form, it is the shell that is doing the environment variable expansion, not docker.</p>
</blockquote>
<blockquote>
<p>Note: Unlike the shell form, the exec form does not invoke a command shell. This means that normal shell processing does not happen. For example, RUN [ “echo”, “$HOME” ] will not do variable substitution on $HOME. If you want shell processing then either use the shell form or execute a shell directly, for example: RUN [ “sh”, “-c”, “echo $HOME” ]. When using the exec form and executing a shell directly, as in the case for the shell form, it is the shell that is doing the environment variable expansion, not docker.</p>
</blockquote>
<ul>
<li>Có 1 sự kết hợp <strong>CMD</strong> và <strong>ENTRYPOINT</strong> rất hay nhé (Xem lại ảnh :D). Và trong 1 <code>Dockerfile</code>, chỉ nên có 1 <strong>CMD</strong> và <strong>ENTRYPOINT</strong> nhé (note tại <strong>Understand how CMD and ENTRYPOINT interact</strong>)</li>
<li>Một ví dụ Dockerfile cho <strong>Apache2</strong><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">16.04</span></span><br><span class="line"><span class="comment"># <span class="doctag">Note:</span> MAINTAINER đã không còn được sử dụng nữa nhé</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> James Turnbull &lt;james@example.com&gt;</span><br><span class="line"><span class="keyword">ENV</span> REFRESHED_AT <span class="number">2016</span>-<span class="number">06</span>-<span class="number">01</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get -yqq update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get -yqq install apache2</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> [ <span class="string">&quot;/var/www/html&quot;</span> ]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /var/www/html</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">ENV</span> APACHE_RUN_USER www-data</span><br><span class="line"><span class="keyword">ENV</span> APACHE_RUN_GROUP www-data</span><br><span class="line"><span class="keyword">ENV</span> APACHE_LOG_DIR /var/log/apache2</span><br><span class="line"><span class="keyword">ENV</span> APACHE_PID_FILE /var/<span class="keyword">run</span><span class="bash">/apache2.pid</span></span><br><span class="line"><span class="keyword">ENV</span> APACHE_RUN_DIR /var/<span class="keyword">run</span><span class="bash">/apache2</span></span><br><span class="line"><span class="keyword">ENV</span> APACHE_LOCK_DIR /var/lock/apache2</span><br><span class="line">    </span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mkdir -p <span class="variable">$APACHE_RUN_DIR</span> <span class="variable">$APACHE_LOCK_DIR</span> <span class="variable">$APACHE_LOG_DIR</span></span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [ <span class="string">&quot;/usr/sbin/apache2&quot;</span> ]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;-D&quot;</span>, <span class="string">&quot;FOREGROUND&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<h1 id="Tai-lieu-tham-khao"><a href="#Tai-lieu-tham-khao" class="headerlink" title="Tài liệu tham khảo:"></a>Tài liệu tham khảo:</h1></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Dockerfile best paractices</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/">Dockerfile reference</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>[Docker] Dockerfile instructions</p><p><a href="http://yoursite.com/2020/04/12/Docker-Dockerfile-instructions/">http://yoursite.com/2020/04/12/Docker-Dockerfile-instructions/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Ming</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2020-04-12</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-04-10</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/docker-instructions-docker-best-practice/">docker-instructions docker-best-practice</a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/mingnv" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/04/12/Docker-Docker-volume/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[Docker] Docker volume</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/04/06/PHPCS-and-PHPC-Fixer/"><span class="level-item">PHPCS and PHP-CS-Fixer</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://yoursite.com/2020/04/12/Docker-Dockerfile-instructions/';
            this.page.identifier = '2020/04/12/Docker-Dockerfile-instructions/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'minh' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/spidertocat.png" alt="Minh NV"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Minh NV</p><p class="is-size-6 is-block">_N.V.M_</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Hanoi city, Vietnam</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">115</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">44</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/minhnv2306" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/minhnv2306"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/profile.php?id=100003860456359"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="http://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="http://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-01T11:33:54.000Z">2021-08-01</time></p><p class="title"><a href="/2021/08/01/Tan-man-ve-index-trong-MySQL/">Tản mạn về index trong MySQL</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-14T14:54:50.000Z">2021-07-14</time></p><p class="title"><a href="/2021/07/14/Section-18-Account-Management-Billing-Support/">Section 18- Account Management, Billing &amp; Support</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-06-11T11:28:44.000Z">2021-06-11</time></p><p class="title"><a href="/2021/06/11/Note-choi-choi-1106/">Note chơi chơi 1106</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-05-22T15:59:30.000Z">2021-05-22</time></p><p class="title"><a href="/2021/05/22/Section-16-Security-Compliance/">Section 16- Security &amp; Compliance</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-05-22T03:31:32.000Z">2021-05-22</time></p><p class="title"><a href="/2021/05/22/Section-14-Cloud-Monitoring/">Section 14- Cloud Monitoring</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AWS-Training/"><span class="level-start"><span class="level-item">AWS Training</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Authentication/"><span class="level-start"><span class="level-item">Authentication</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-our-code/"><span class="level-start"><span class="level-item">Clean our code</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/Clean-our-code/Clean-code-Robert-C-Martin/"><span class="level-start"><span class="level-item">Clean code - Robert C. Martin</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Clean-our-code/Refactoring-to-Collections/"><span class="level-start"><span class="level-item">Refactoring to Collections</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/MongoDB/"><span class="level-start"><span class="level-item">MongoDB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/"><span class="level-start"><span class="level-item">Development and Operation</span></span><span class="level-end"><span class="level-item tag">32</span></span></a><ul><li><a class="level is-mobile" href="/categories/Development-and-Operation/CircleCI-2-0/"><span class="level-start"><span class="level-item">CircleCI 2.0</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Google-Cloud-Platform/"><span class="level-start"><span class="level-item">Google Cloud Platform</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Laravel/"><span class="level-start"><span class="level-item">Laravel</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Linux-OS/"><span class="level-start"><span class="level-item">Linux OS</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Development-and-Operation/Web-Server/"><span class="level-start"><span class="level-item">Web Server</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/JAVaScript/"><span class="level-start"><span class="level-item">JAVaScript</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/JAVaScript/Asynchronous/"><span class="level-start"><span class="level-item">Asynchronous</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/JAVaScript/Event/"><span class="level-start"><span class="level-item">Event</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/JAVaScript/React/"><span class="level-start"><span class="level-item">React</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/JP/"><span class="level-start"><span class="level-item">JP</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/Others/Cong-cu-lap-trinh/"><span class="level-start"><span class="level-item">Công cụ lập trình</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/PHPCS/"><span class="level-start"><span class="level-item">PHPCS</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Suu-tam/"><span class="level-start"><span class="level-item">Sưu tầm</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/Website-Optimization/"><span class="level-start"><span class="level-item">Website Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/"><span class="level-start"><span class="level-item">The Art of Readable Code</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Chapter-1-Code-Should-Be-Easy-to-Understand/"><span class="level-start"><span class="level-item">Chapter 1 - Code Should Be Easy to Understand</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-I-Surface-Level-Improvements/"><span class="level-start"><span class="level-item">Part I - Surface-Level Improvements</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-II-Simplifying-Loops-and-Logic/"><span class="level-start"><span class="level-item">Part II - Simplifying Loops and Logic</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-III-Reorganizing-Your-Code/"><span class="level-start"><span class="level-item">Part III - Reorganizing Your Code</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/The-Art-of-Readable-Code/Part-IV-Selected-Topics/"><span class="level-start"><span class="level-item">Part IV - Selected Topics</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Unit-Test/"><span class="level-start"><span class="level-item">Unit Test</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/special-day/"><span class="level-start"><span class="level-item">special day</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/API/"><span class="tag">API</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CI-CD/"><span class="tag">CI/CD</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kanji/"><span class="tag">Kanji</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-command-line/"><span class="tag">Linux command line</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache2/"><span class="tag">apache2</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/async-programing/"><span class="tag">async programing</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/authentication/"><span class="tag">authentication</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-comment/"><span class="tag">clean comment</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-error/"><span class="tag">clean error</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/clean-function/"><span class="tag">clean function</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/collection/"><span class="tag">collection</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/configuration/"><span class="tag">configuration</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-command/"><span class="tag">docker command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-file-format/"><span class="tag">docker compose file format</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-best-practice/"><span class="tag">docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-compose-yml/"><span class="tag">docker-compose.yml</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-instructions-docker-best-practice/"><span class="tag">docker-instructions docker-best-practice</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-network/"><span class="tag">docker-network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker-volume/"><span class="tag">docker-volume</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event/"><span class="tag">event</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/event-notification/"><span class="tag">event notification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/excelfile/"><span class="tag">excelfile</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gcp/"><span class="tag">gcp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/groupby-mysql/"><span class="tag">groupby, mysql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jquery-validation/"><span class="tag">jquery-validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubernetes/"><span class="tag">kubernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongoDB/"><span class="tag">mongoDB</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/naming/"><span class="tag">naming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs/"><span class="tag">phpcs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/phpcs-phpcsfixer/"><span class="tag">phpcs phpcsfixer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/process-management/"><span class="tag">process management</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-boilerplate/"><span class="tag">react boilerplate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/requests/"><span class="tag">requests</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stripe/"><span class="tag">stripe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sudo-command/"><span class="tag">sudo command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tips-laravel/"><span class="tag">tips laravel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tracking-php-script/"><span class="tag">tracking php script</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unit-test/"><span class="tag">unit test</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/validation/"><span class="tag">validation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vba/"><span class="tag">vba</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vim/"><span class="tag">vim</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#FROM"><span class="level-left"><span class="level-item">1</span><span class="level-item">FROM</span></span></a></li><li><a class="level is-mobile" href="#LABEL"><span class="level-left"><span class="level-item">2</span><span class="level-item">LABEL</span></span></a></li><li><a class="level is-mobile" href="#RUN"><span class="level-left"><span class="level-item">3</span><span class="level-item">RUN</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#APT-GET"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">APT-GET</span></span></a></li><li><a class="level is-mobile" href="#USING-PIPES"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">USING PIPES</span></span></a></li></ul></li><li><a class="level is-mobile" href="#CMD"><span class="level-left"><span class="level-item">4</span><span class="level-item">CMD</span></span></a></li><li><a class="level is-mobile" href="#EXPOSE"><span class="level-left"><span class="level-item">5</span><span class="level-item">EXPOSE</span></span></a></li><li><a class="level is-mobile" href="#ENV"><span class="level-left"><span class="level-item">6</span><span class="level-item">ENV</span></span></a></li><li><a class="level is-mobile" href="#ADD-or-COPY"><span class="level-left"><span class="level-item">7</span><span class="level-item">ADD or COPY</span></span></a></li><li><a class="level is-mobile" href="#ENTRYPOINT"><span class="level-left"><span class="level-item">8</span><span class="level-item">ENTRYPOINT</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Exec-form-ENTRYPOINT-example"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">Exec form ENTRYPOINT example</span></span></a></li><li><a class="level is-mobile" href="#Shell-form-ENTRYPOINT-example"><span class="level-left"><span class="level-item">8.2</span><span class="level-item">Shell form ENTRYPOINT example</span></span></a></li><li><a class="level is-mobile" href="#Understand-how-CMD-and-ENTRYPOINT-interact"><span class="level-left"><span class="level-item">8.3</span><span class="level-item">Understand how CMD and ENTRYPOINT interact</span></span></a></li></ul></li><li><a class="level is-mobile" href="#VOLUME"><span class="level-left"><span class="level-item">9</span><span class="level-item">VOLUME</span></span></a></li><li><a class="level is-mobile" href="#USER"><span class="level-left"><span class="level-item">10</span><span class="level-item">USER</span></span></a></li><li><a class="level is-mobile" href="#WORKDIR"><span class="level-left"><span class="level-item">11</span><span class="level-item">WORKDIR</span></span></a></li><li><a class="level is-mobile" href="#ARG"><span class="level-left"><span class="level-item">12</span><span class="level-item">ARG</span></span></a></li><li><a class="level is-mobile" href="#Tong-ket"><span class="level-left"><span class="level-item">13</span><span class="level-item">Tổng kết</span></span></a></li><li><a class="level is-mobile" href="#Tai-lieu-tham-khao"><span class="level-left"><span class="level-item">14</span><span class="level-item">Tài liệu tham khảo:</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://blog.zhangruipeng.me/hexo-theme-icarus/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus blog</span></span><span class="level-right"><span class="level-item tag">blog.zhangruipeng.me</span></span></a></li><li><a class="level is-mobile" href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Icarus github</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="Hello, I am Minh" height="28"></a><p class="is-size-7"><span>&copy; 2021 Ming</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>